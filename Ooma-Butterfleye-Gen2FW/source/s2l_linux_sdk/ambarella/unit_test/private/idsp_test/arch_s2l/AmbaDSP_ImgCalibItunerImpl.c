/*
 *
 * idsp_test
 *
 * History:
 *	2013/09/05 - [Dylan] Created this file
 *
 * Description :
 *	Load the tuned file which generated by Img tuning tool.
 *
 * Copyright (C) 2015 Ambarella, Inc.
 *
 * This file and its contents ("Software") are protected by intellectual
 * property rights including, without limitation, U.S. and/or foreign
 * copyrights. This Software is also the confidential and proprietary
 * information of Ambarella, Inc. and its licensors. You may not use, reproduce,
 * disclose, distribute, modify, or otherwise prepare derivative works of this
 * Software or any portion thereof except pursuant to a signed license agreement
 * or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
 * In the absence of such an agreement, you agree to promptly notify and return
 * this Software to Ambarella, Inc.
 *
 * THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
 * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
 * MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 */

//#include "AmbaPrintk.h"
//#include "AmbaFS.h"
//#include "AmbaKAL.h"

//#include "AmbaDSP_ImgHighLevelApi.h"
#include <string.h>
#include <stdio.h>
#include "AmbaDataType.h"
#include "AmbaDSP_ImgUtility.h"

#include "AmbaImgCalibItuner.h"
//#include "AmbaDSP_ImgHighIsoFilter.h"


//#pragma location=".NonCacheDDR"
//#pragma data_alignment = 32
UINT8 FPNMap[4000*3000];

//#pragma location=".NonCacheDDR"
//#pragma data_alignment = 32
UINT8 VignetteTable[ITUNER_VIGNETTE_GAIN_MAP_SIZE * 4];

//#pragma location=".NonCacheDDR"
//#pragma data_alignment = 32
UINT8 WarpGrid[4*96*64];

//#pragma location=".NonCacheDDR"
//#pragma data_alignment = 32
UINT8 ca_grid[4*96*64];

//#pragma location=".NonCacheDDR"
//#pragma data_alignment = 32
UINT8 CcReg[AMBA_DSP_IMG_CC_REG_SIZE];

//#pragma location=".NonCacheDDR"
//#pragma data_alignment = 32
UINT8 Cc3d[AMBA_DSP_IMG_CC_3D_SIZE];

//#pragma location=".NonCacheDDR"
//#pragma data_alignment = 32
UINT8 SecCc[AMBA_DSP_IMG_SEC_CC_SIZE];

#define AmbaPrint(format, arg...)	printf(format"\n", ##arg)

#if 1
#define ITUNER_DEBF(fmt, arg...) AmbaPrint("[ITUNER][DEBUG]"fmt, ##arg)
#define ITUNER_WARF(fmt, arg...) AmbaPrint("[ITUNER][WARNING]"fmt, ##arg)
#define ITUNER_ERRF(fmt, arg...) AmbaPrint("[ITUNER][ERROR]"fmt, ##arg)
#else
#define ITUNER_DEBF(fmt, arg...)
#define ITUNER_WARF(fmt, arg...)
#define ITUNER_ERRF(fmt, arg...)

#endif

#define WB_DGAIN_UNIT           4096

#define WARP_VIDEO_MAXHORGRID    (32)
#define WARP_VIDEO_MAXVERGRID    (48)

#define WARP_STILL_MAXVERGRID    (48)

#define CAWARP_VIDEO_MAXHORGRID    (32)
#define CAWARP_VIDEO_MAXVERGRID    (48)
#define CAWARP_STILL_MAXHORGRID    (64)
#define CAWARP_STILL_MAXVERGRID    (48)

#define SFT 16
#define TO_STR(x) #x
// Note: Use to check return value
#define CHECK_RET(RET, FUNC) if (RET != FUNC) {\
                                    ITUNER_WARF("%s() Line:%d, call "#FUNC" Fail", __func__, __LINE__); \
                                    Ret |= -1;\
                                    /*break;*/\
                                 }




/*
typedef struct ituner_night_portrait_s {
    UINT8 flash_on_2nd_pic;
    UINT8 radius;
    UINT8 luma_path_1[256];
    UINT8 chroma_path_1[256];
    UINT8 luma_path_2[256];
    UINT8 chroma_path_2[256];
    UINT16 table[256];
} ituner_night_portrait_t;

#define MAX_HDR_IMG_COUNT (10)
typedef struct hdr_raw_info_s {
    UINT8  raw_path[256];
} hdr_raw_info_t;

typedef struct hdr_control_info_s {
    int normal_frame_idx;
    int mctf_strength;
} hdr_control_info_t;
*/

//=====AAA algorithm==============//
#define IMG_EXP_VIDEO                   (0x00)
#define IMG_EXP_VIDEO_DIRECT_SET        (0x01)


//=============================//
#define SPECIAL_USE_NONE 0
#define SPECIAL_USE_SKIP 1

typedef struct _ITUNER_DATA_s_ {
    AAA_FUNC_s                          AaaFunction; //
    IMG_EXP_s                           AeInfo; //
    amba_img_dsp_ae_stat_info_t         AeStatisticsInfo; //
    amba_img_dsp_awb_stat_info_t        AwbStatisticsInfo;//
    amba_img_dsp_af_stat_info_t         AfStatisticsInfo; //
    amba_dsp_img_af_stat_ex_info_t      AfStatisticsEx;

    ITUNER_FPN_s                        StaticBadPixelCorrection;//
    ITUNER_FPN_BYPASS_s                 StaticBadPixelCorrectionByPass;//
    ITUNER_VIGNETTE_s                   VignetteCompensation;//
    ITUNER_VIGNETTE_BYPASS_s            VignetteCompensationByPass;//
    ITUNER_WARP_s                       WarpCompensation;//
    ITUNER_DZOOM_s                      Dzoom;//
    ITUNER_WARP_DZOOM_BYPASS_s          WarpCompensationDzoomByPass;//
    ITUNER_SENSOR_INPUT_s               SensorInputInfo;//
    ITUNER_CHROMA_ABERRATION_s          ChromaAberrationInfo;//
    ITUNER_CHROMA_ABERRATION_BYPASS_s   ChromaAberrationInfoByPass;//
    ///////

    amba_img_dsp_sbp_correction_t       SbpCorr;
    AMBA_DSP_IMG_BYPASS_SBP_INFO_s      SbpCorrByPass;

    amba_img_dsp_vignette_calc_info_t   VignetteCalcInfo;
    AMBA_DSP_IMG_BYPASS_VIGNETTE_INFO_s VignetteByPass;

    amba_img_dsp_sensor_info_t          SensorInfo;
    amba_img_dsp_warp_calc_info_t       WarpCalcInfo;
    AMBA_DSP_IMG_BYPASS_WARP_DZOOM_INFO_s WarpByPass;

    AMBA_DSP_IMG_CAWARP_CALC_INFO_s     CACalcInfo;
    AMBA_DSP_IMG_BYPASS_CAWARP_INFO_s   CAByPass;

    amba_img_dsp_black_correction_t     StaticBlackLevel;//
    amba_img_dsp_def_blc_t              DeferredBlackLevel;
    amba_img_dsp_dbp_correction_t       DynamicBadPixelCorrection;//
    amba_img_dsp_cfa_leakage_filter_t   CfaLeakageFilter;//
    amba_img_dsp_cfa_noise_filter_t     CfaNoiseFilter;//
    amba_img_dsp_anti_aliasing_t        AntiAliasing;//
    UINT32                              GlobalDgain;//
    amba_img_dsp_wb_gain_t              WbGain;//
    amba_img_dsp_dgain_saturation_t     DgainSaturationLevel;//
    amba_img_dsp_local_exposure_t       LocalExposure;//
    amba_img_dsp_color_correction_reg_t CcReg;
    amba_img_dsp_color_correction_t     CcThreeD;
    ITUNER_COLOR_CORRECTION_s           ColorCorrection;//
    amba_img_dsp_tone_curve_t           ToneCurve;//
    amba_img_dsp_rgb_to_yuv_t           RgbToYuvMatrix;//
    amba_img_dsp_chroma_scale_t         ChromaScale;//
    amba_img_dsp_chroma_median_filter_t ChromaMedianFilter;//

    amba_img_dsp_demosaic_t             DemosaicFilter;//
    //li_sharpen_noise_filter
    amba_img_dsp_sharpen_both_t  SharpenBoth;//
    amba_img_dsp_sharpen_noise_t SharpenNoise;//
    amba_img_dsp_fir_t          Fir;//
    amba_img_dsp_coring_t       Coring;//
    amba_img_dsp_level_t        MinCoringResult;//8//minimum_sharpeness_level
    amba_img_dsp_level_t        CoringIndexScale;//10//overall_sharpeness_level
    amba_img_dsp_level_t        ScaleCoring;//7
    //final_sharp_noise_filter
    amba_img_dsp_sharpen_both_t  FinalSharpenBoth;//
    amba_img_dsp_sharpen_noise_t FinalSharpenNoise;
    amba_img_dsp_fir_t          FinalFir;
    amba_img_dsp_coring_t       FinalCoring;
    amba_img_dsp_level_t        FinalMinCoringResult;//8//minimum_sharpeness_level
    amba_img_dsp_level_t        FinalCoringIndexScale;//10//overall_sharpeness_level
    amba_img_dsp_level_t        FinalScaleCoring;//7

    amba_img_dsp_video_mctf_info_t      VideoMctf;//
    amba_img_dsp_video_mctf_temporal_adjust_t  VideoMctfTemporalAdjust;//
    amba_img_dsp_cdnr_info_t            CDNR;//
    amba_img_dsp_liso_process_select_t      LisoProcessSelect;
//    UINT8                               ShpAOrSpatialFilterSelect;//
    UINT16                              SharpBLinearizationStrength;//
    //idsp_cc_desat_t             cc_desatutation;//TBD
    amba_img_dsp_asf_info_t             AsfInfo;

    amba_img_dsp_chroma_filter_t        ChromaFilter;//
    amba_img_dsp_gbgr_mismatch_t        GbGrMismatch;//

    //li_wide_chroma
    amba_img_dsp_chroma_filter_t        WideChromaFilter;//
    AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s  WideChromaFilterCombine;//

    //High iso
    amba_img_dsp_anti_aliasing_t          HisoAntiAliasing;
    amba_img_dsp_cfa_leakage_filter_t     HisoCfaLeakageFilter;
    amba_img_dsp_dbp_correction_t         HisoDynamicBadPixelCorrection;
    amba_img_dsp_cfa_noise_filter_t       HisoCfaNoiseFilter;//
    amba_img_dsp_gbgr_mismatch_t          HisoGbGrMismatch;
    amba_img_dsp_demosaic_t               HisoDemosaicFilter;//
    amba_img_dsp_chroma_median_filter_t   HisoChromaMedianFilter;//
    amba_img_dsp_cdnr_info_t              HisoCDNR;
    AMBA_DSP_IMG_DEFER_COLOR_CORRECTION_s HisoDeferColorCorrection;//

    amba_img_dsp_asf_info_t    HisoAsf;
    amba_img_dsp_asf_info_t    HisoHighAsf;
    amba_img_dsp_asf_info_t    HisoLowAsf;
    amba_img_dsp_asf_info_t    HisoMedAsf;
    amba_img_dsp_asf_info_t    HisoLi2ndAsf;
    AMBA_DSP_IMG_CHROMA_ASF_INFO_s    HisoChromaAsf;

    //HisoHighSharpen
    amba_img_dsp_sharpen_both_t  HisoHighSharpenBoth;
    amba_img_dsp_sharpen_noise_t HisoHighSharpenNoise;
    amba_img_dsp_fir_t           HisoHighFir;
    amba_img_dsp_coring_t        HisoHighCoring;
    amba_img_dsp_level_t         HisoHighMinCoringResult;//8//minimum_sharpeness_level
    amba_img_dsp_level_t         HisoHighCoringIndexScale;//10//overall_sharpeness_level
    amba_img_dsp_level_t         HisoHighScaleCoring;//7
    //HisoMedSharpen
    amba_img_dsp_sharpen_both_t  HisoMedSharpenBoth;
    amba_img_dsp_sharpen_noise_t HisoMedSharpenNoise;
    amba_img_dsp_fir_t           HisoMedFir;
    amba_img_dsp_coring_t        HisoMedCoring;
    amba_img_dsp_level_t         HisoMedMinCoringResult;//8//minimum_sharpeness_level
    amba_img_dsp_level_t         HisoMedCoringIndexScale;//10//overall_sharpeness_level
    amba_img_dsp_level_t         HisoMedScaleCoring;//7
    //HisoLiso1Sharpen
    amba_img_dsp_sharpen_both_t  HisoLiso1SharpenBoth;
    amba_img_dsp_sharpen_noise_t HisoLiso1SharpenNoise;
    amba_img_dsp_fir_t           HisoLiso1Fir;
    amba_img_dsp_coring_t        HisoLiso1Coring;
    amba_img_dsp_level_t         HisoLiso1MinCoringResult;//8//minimum_sharpeness_level
    amba_img_dsp_level_t         HisoLiso1CoringIndexScale;//10//overall_sharpeness_level
    amba_img_dsp_level_t         HisoLiso1ScaleCoring;//7
    //HisoMedSharpen
    amba_img_dsp_sharpen_both_t  HisoLiso2SharpenBoth;//
    amba_img_dsp_sharpen_noise_t HisoLiso2SharpenNoise;
    amba_img_dsp_fir_t           HisoLiso2Fir;
    amba_img_dsp_coring_t        HisoLiso2Coring;
    amba_img_dsp_level_t         HisoLiso2MinCoringResult;//8//minimum_sharpeness_level
    amba_img_dsp_level_t         HisoLiso2CoringIndexScale;//10//overall_sharpeness_level
    amba_img_dsp_level_t         HisoLiso2ScaleCoring;//7
    //Chroma
    amba_img_dsp_chroma_filter_t        HisoChromaFilterHigh;
    AMBA_DSP_IMG_HISO_CHROMA_LOW_VERY_LOW_FILTER_s        HisoChromaFilterLowVeryLow;//
    AMBA_DSP_IMG_HISO_CHROMA_FILTER_s   HisoChromaFilterPre;//
    AMBA_DSP_IMG_HISO_CHROMA_FILTER_s   HisoChromaFilterMed;
    AMBA_DSP_IMG_HISO_CHROMA_FILTER_s   HisoChromaFilterLow;
    AMBA_DSP_IMG_HISO_CHROMA_FILTER_s   HisoChromaFilterVeryLow;
    //Combine
    AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s HisoChromaFilterMedCombine;
    AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s HisoChromaFilterLowCombine;
    AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s HisoChromaFilterVeryLowCombine;
    AMBA_DSP_IMG_HISO_LUMA_FILTER_COMBINE_s HisoLumaNoiseCombine;
    AMBA_DSP_IMG_HISO_LUMA_FILTER_COMBINE_s HisoLowASFCombine;
    AMBA_DSP_IMG_HISO_COMBINE_s               HighIsoCombine;
    AMBA_DSP_IMG_HISO_FREQ_RECOVER_s          HisoFreqRecover;
    AMBA_DSP_IMG_HISO_LUMA_BLEND_s            HisoLow2LumaBlend;
    AMBA_DSP_IMG_HISO_BLEND_s                 HisoLow2BlendLumaLevel;

	//MO PASS-3 filter
	amba_img_dsp_dbp_correction_t       MoDynamicBadPixelCorrection;
    amba_img_dsp_cfa_leakage_filter_t   MoCfaLeakageFilter;
    amba_img_dsp_cfa_noise_filter_t     MoCfaNoiseFilter;
    amba_img_dsp_anti_aliasing_t        MoAntiAliasing;
    amba_img_dsp_chroma_median_filter_t MoChromaMedianFilter;
    amba_img_dsp_demosaic_t             MoDemosaicFilter;
    amba_img_dsp_sharpen_both_t         MoSharpenBoth;
    amba_img_dsp_sharpen_noise_t        MoSharpenNoise;
    amba_img_dsp_fir_t                  MoFir;
    amba_img_dsp_coring_t               MoCoring;
    amba_img_dsp_level_t                MoMinCoringResult;
    amba_img_dsp_level_t                MoCoringIndexScale;
    amba_img_dsp_level_t                MoScaleCoring;
    amba_img_dsp_mo_process_select_t    MoProcessSelect;
	amba_img_dsp_asf_info_t             MoAsfInfo;
	amba_img_dsp_chroma_filter_t        MoChromaFilter;
    amba_img_dsp_gbgr_mismatch_t        MoGbGrMismatch;
} ITUNER_DATA_s;
#if 0
typedef struct {
      UINT8 SharpenBothThreeDTable[8192];
      UINT8 FinalSharpenBothThreeDTable[8192];
      UINT8 AsfInfoThreeDTable[8192];
      UINT8 HisoAsfThreeDTable[8192];
      UINT8 HisoHighAsfThreeDTable[8192];
      UINT8 HisoLowAsfThreeDTable[8192];
      UINT8 HisoMedAsfThreeDTable[8192];
      UINT8 HisoLi2ndAsfThreeDTable[8192];
      UINT8 HisoChromaAsfThreeDTable[8192];
      UINT8 HisoHighSharpenBothThreeDTable[8192];
      UINT8 HisoMedSharpenBothThreeDTable[8192];
      UINT8 HisoLiso1SharpenBothThreeDTable[8192];
      UINT8 HisoLiso2SharpenBothThreeDTable[8192];
      UINT8 HisoChromaFilterMedCombineThreeDTable[8192];
      UINT8 HisoChromaFilterLowCombineThreeDTable[8192];
      UINT8 HisoChromaFilterVeryLowCombineThreeDTable[8192];
      UINT8 HisoLumaNoiseCombineThreeDTable[8192];
      UINT8 HisoLowASFCombineThreeDTable[8192];
      UINT8 HighIsoCombineThreeDTable[8192];
} ITUNER_TABLE_s;
static ITUNER_TABLE_s GTable;
#endif
static AMBA_ITUNER_VALID_FILTER_t _Ituner_Valid_Filter;
ITUNER_DATA_s GData;
static AmbaItuner_Hook_Func_t Ituner_Hook_Func;
static ITUNER_SYSTEM_s _System;
static Ituner_Internal_s _Internal;
static int _AmbaItuner_Check_Reg(ITUNER_VALID_s FILTER_ID, int Special_Use);
static inline void _AmbaItuner_Set_Filter_Valid(ITUNER_VALID_s Filter_Id) {
    _Ituner_Valid_Filter[Filter_Id] = 1;
}
//HENRY TBD
extern int amba_img_dsp_get_1st_sharpen_noise_sharpen_coring(amba_img_dsp_mode_cfg_t             *pMode, amba_img_dsp_coring_t               *pCoring);
extern int AmbaDSP_ImgGetHighisoLi2ndAdvanceSpatialFilter(amba_img_dsp_mode_cfg_t *pMode, amba_img_dsp_asf_info_t *pAsf);
static const char *const _G_Filter_Name[] = {
    TO_STR(ITUNER_SYSTEM_INFO),
    TO_STR(ITUNER_INTERNAL_INFO),
    TO_STR(ITUNER_AAA_FUNCTION),
    TO_STR(ITUNER_AE_INFO),
    TO_STR(ITUNER_AE_STATISTICS_INFO),
    TO_STR(ITUNER_AWB_STATISTICS_INFO),
    TO_STR(ITUNER_AF_STATISTICS_INFO),
    TO_STR(ITUNER_STATIC_BAD_PIXEL_CORRECTION),
    TO_STR(ITUNER_STATIC_BAD_PIXEL_CORRECTION_BY_PASS),
    TO_STR(ITUNER_VIGNETTE_COMPENSATION),
    TO_STR(ITUNER_VIGNETTE_COMPENSATION_BY_PASS),
    TO_STR(ITUNER_WARP_COMPENSATION),
    TO_STR(ITUNER_DZOOM),
    TO_STR(ITUNER_WARP_COMPENSATION_DZOOM_BY_PASS),
    TO_STR(ITUNER_SENSOR_INPUT_INFO),
    TO_STR(ITUNER_STATIC_BLACK_LEVEL),
    TO_STR(ITUNER_DEFERRED_BLACK_LEVEL),
    TO_STR(ITUNER_DYNAMIC_BAD_PIXEL_CORRECTION),
    TO_STR(ITUNER_HISO_DYNAMIC_BAD_PIXEL_CORRECTION),
    TO_STR(ITUNER_CFA_LEAKAGE_FILTER),
    TO_STR(ITUNER_HISO_CFA_LEAKAGE_FILTER),
    TO_STR(ITUNER_CFA_NOISE_FILTER),
    TO_STR(ITUNER_HISO_CFA_NOISE_FILTER),
    TO_STR(ITUNER_ANTI_ALIASING_STRENGTH),
    TO_STR(ITUNER_HISO_ANTI_ALIASING_STRENGTH),
    TO_STR(ITUNER_GLOBAL_DGAIN),
    TO_STR(ITUNER_WB_GAIN),
    TO_STR(ITUNER_DGAIN_SATURATION_LEVEL),
    TO_STR(ITUNER_LOCAL_EXPOSURE),
    TO_STR(ITUNER_COLOR_CORRECTION),
    TO_STR(ITUNER_TONE_CURVE),
    TO_STR(ITUNER_RGB_TO_YUV_MATRIX),
    TO_STR(ITUNER_CHROMA_SCALE),
    TO_STR(ITUNER_CHROMA_MEDIAN_FILTER),
    TO_STR(ITUNER_HISO_CHROMA_MEDIAN_FILTER),
    TO_STR(ITUNER_DEMOSAIC_FILTER),
    TO_STR(ITUNER_SHARPEN_BOTH),
    TO_STR(ITUNER_SHARPEN_NOISE),
    TO_STR(ITUNER_FIR),
    TO_STR(ITUNER_CORING),
    TO_STR(ITUNER_CORING_INDEX_SCALE),
    TO_STR(ITUNER_MIN_CORING_RESULT),
    TO_STR(ITUNER_SCALE_CORING),
    TO_STR(ITUNER_FINAL_SHARPEN_BOTH),
    TO_STR(ITUNER_FINAL_SHARPEN_NOISE),
    TO_STR(ITUNER_FINAL_FIR),
    TO_STR(ITUNER_FINAL_CORING),
    TO_STR(ITUNER_FINAL_CORING_INDEX_SCALE),
    TO_STR(ITUNER_FINAL_MIN_CORING_RESULT),
    TO_STR(ITUNER_FINAL_SCALE_CORING),
    TO_STR(ITUNER_HISO_DEMOSAIC_FILTER),
    TO_STR(ITUNER_HISO_HIGH_SHARPEN_BOTH),
    TO_STR(ITUNER_HISO_MED_SHARPEN_BOTH),
    TO_STR(ITUNER_HISO_HIGH_SHARPEN_NOISE),
    TO_STR(ITUNER_HISO_MED_SHARPEN_NOISE),
    TO_STR(ITUNER_HISO_HIGH_FIR),
    TO_STR(ITUNER_HISO_MED_FIR),
    TO_STR(ITUNER_HISO_HIGH_CORING),
    TO_STR(ITUNER_HISO_MED_CORING),
    TO_STR(ITUNER_HISO_HIGH_CORING_INDEX_SCALE),
    TO_STR(ITUNER_HISO_HIGH_MIN_CORING_RESULT),
    TO_STR(ITUNER_HISO_HIGH_SCALE_CORING),
    TO_STR(ITUNER_HISO_MED_CORING_INDEX_SCALE),
    TO_STR(ITUNER_HISO_MED_MIN_CORING_RESULT),
    TO_STR(ITUNER_HISO_MED_SCALE_CORING),
    TO_STR(ITUNER_VIDEO_MCTF),
    TO_STR(ITUNER_VIDEO_MCTF_TEMPORAL_ADJUST),
    TO_STR(ITUNER_CDNR),
    TO_STR(ITUNER_HISO_DEFER_COLOR_CORRECTION),
    TO_STR(ITUNER_SHP_A_OR_SPATIAL_FILTE_SELECT),
    TO_STR(ITUNER_ASF_INFO),
    TO_STR(ITUNER_HISO_ASF),
    TO_STR(ITUNER_HISO_HIGH_ASF),
    TO_STR(ITUNER_HISO_LOW_ASF),
    TO_STR(ITUNER_HISO_MED_ASF),
    TO_STR(ITUNER_HISO_CHROMA_ASF),
    TO_STR(ITUNER_CHROMA_FILTER),
    TO_STR(ITUNER_WIDE_CHROMA_FILTER),
    TO_STR(ITUNER_WIDE_CHROMA_FILTER_COMBINE),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_HIGH),
    TO_STR(ITUNER_GB_GR_MISMATCH),
    TO_STR(ITUNER_HISO_GB_GR_MISMATCH),
    TO_STR(ITUNER_CHROMA_ABERRATION_INFO),
    TO_STR(ITUNER_CHROMA_ABERRATION_INFO_BY_PASS),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_LOW_VERY_LOW),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_PRE),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_MED),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_LOW),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_VERY_LOW),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_VERY_LOW_COMBINE),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_MED_COMBINE),
    TO_STR(ITUNER_HISO_CHROMA_FILTER_LOW_COMBINE),
    TO_STR(ITUNER_HISO_LUMA_NOISE_COMBINE),
    TO_STR(ITUNER_HISO_LOW_ASF_COMBINE),
    TO_STR(ITUNER_HISO_FREQ_RECOVER),
    TO_STR(ITUNER_SENSOR_INFO),
    TO_STR(ITUNER_MO_DYNAMIC_BAD_PIXEL_CORRECTION),
    TO_STR(ITUNER_MO_CFA_LEAKAGE_FILTER),
    TO_STR(ITUNER_MO_CFA_NOISE_FILTER),
    TO_STR(ITUNER_MO_ANTI_ALIASING_STRENGTH),
    TO_STR(ITUNER_MO_DEMOSAIC_FILTER),
    TO_STR(ITUNER_MO_GB_GR_MISMATCH),
    TO_STR(ITUNER_MO_SHP_A_OR_SPATIAL_FILTE_SELECT),
    TO_STR(ITUNER_MO_ASF_INFO),
    TO_STR(ITUNER_MO_CHROMA_FILTER),
    TO_STR(ITUNER_MO_CHROMA_MEDIAN_FILTER),
    TO_STR(ITUNER_MO_SHARPEN_BOTH),
    TO_STR(ITUNER_MO_SHARPEN_NOISE),
    TO_STR(ITUNER_MO_FIR),
    TO_STR(ITUNER_MO_CORING),
    TO_STR(ITUNER_MO_CORING_INDEX_SCALE),
    TO_STR(ITUNER_MO_MIN_CORING_RESULT),
    TO_STR(ITUNER_MO_SCALE_CORING),
};
static int _AmbaItuner_Is_Video_Preview_Tuning(void)
{
    return (0 == strcmp(_System.TuningMode, TUING_MODE_TO_STR(IMG_MODE_PREVIEW))) ? 1 : 0;
}
static int _AmbaItuner_Check_Filter(amba_img_dsp_mode_cfg_t Mode)
{
    const UINT8 Liso_Still_Filter[] = {
        ITUNER_COLOR_CORRECTION,
        ITUNER_STATIC_BLACK_LEVEL,
        ITUNER_DEFERRED_BLACK_LEVEL,
        ITUNER_DYNAMIC_BAD_PIXEL_CORRECTION,
        ITUNER_CFA_LEAKAGE_FILTER,
        ITUNER_CFA_NOISE_FILTER,
        ITUNER_ANTI_ALIASING_STRENGTH,
        ITUNER_WB_GAIN,
        ITUNER_DGAIN_SATURATION_LEVEL,
        ITUNER_LOCAL_EXPOSURE,
        ITUNER_TONE_CURVE,
        ITUNER_RGB_TO_YUV_MATRIX,
        ITUNER_CHROMA_SCALE,
        ITUNER_CHROMA_MEDIAN_FILTER,
        ITUNER_DEMOSAIC_FILTER,
        ITUNER_GB_GR_MISMATCH,
        ITUNER_SHP_A_OR_SPATIAL_FILTE_SELECT,
//        ITUNER_CDNR,
        ITUNER_CHROMA_FILTER,
        ITUNER_DZOOM,
    };
    const UINT8 Hiso_Still_Filter[] = {
        ITUNER_COLOR_CORRECTION,
        ITUNER_STATIC_BLACK_LEVEL,
        ITUNER_DEFERRED_BLACK_LEVEL,
        ITUNER_DYNAMIC_BAD_PIXEL_CORRECTION,
        ITUNER_CFA_LEAKAGE_FILTER,
        ITUNER_CFA_NOISE_FILTER,
        ITUNER_ANTI_ALIASING_STRENGTH,
        ITUNER_WB_GAIN,
        ITUNER_DGAIN_SATURATION_LEVEL,
        ITUNER_LOCAL_EXPOSURE,
        ITUNER_TONE_CURVE,
        ITUNER_RGB_TO_YUV_MATRIX,
        ITUNER_CHROMA_SCALE,
        //ITUNER_CHROMA_MEDIAN_FILTER,
        ITUNER_DEMOSAIC_FILTER,
        ITUNER_GB_GR_MISMATCH,
        //ITUNER_SHP_A_OR_SPATIAL_FILTE_SELECT,
        //ITUNER_CDNR,
        //ITUNER_CHROMA_FILTER,
        ITUNER_HISO_ANTI_ALIASING_STRENGTH,
        ITUNER_HISO_CFA_LEAKAGE_FILTER,
        ITUNER_HISO_DYNAMIC_BAD_PIXEL_CORRECTION,
        ITUNER_HISO_CFA_NOISE_FILTER,
        ITUNER_HISO_GB_GR_MISMATCH,
        ITUNER_HISO_DEMOSAIC_FILTER,
        ITUNER_HISO_CHROMA_MEDIAN_FILTER,
        ITUNER_HISO_DEFER_COLOR_CORRECTION,
        ITUNER_HISO_ASF,
        ITUNER_HISO_HIGH_ASF,
        ITUNER_HISO_LOW_ASF,
        ITUNER_HISO_MED_ASF,
        ITUNER_HISO_CHROMA_ASF,
        ITUNER_HISO_HIGH_SHARPEN_BOTH,
        ITUNER_HISO_HIGH_SHARPEN_NOISE,
        ITUNER_HISO_HIGH_FIR,
        ITUNER_HISO_HIGH_CORING,
        ITUNER_HISO_HIGH_CORING_INDEX_SCALE,
        ITUNER_HISO_HIGH_MIN_CORING_RESULT,
        ITUNER_HISO_HIGH_SCALE_CORING,
        ITUNER_HISO_MED_SHARPEN_BOTH,
        ITUNER_HISO_MED_SHARPEN_NOISE,
        ITUNER_HISO_MED_FIR,
        ITUNER_HISO_MED_CORING,
        ITUNER_HISO_MED_CORING_INDEX_SCALE,
        ITUNER_HISO_MED_MIN_CORING_RESULT,
        ITUNER_HISO_MED_SCALE_CORING,
        ITUNER_HISO_CHROMA_FILTER_HIGH,
        ITUNER_HISO_CHROMA_FILTER_LOW_VERY_LOW,
        ITUNER_HISO_CHROMA_FILTER_PRE,
        ITUNER_HISO_CHROMA_FILTER_MED,
        ITUNER_HISO_CHROMA_FILTER_LOW,
        ITUNER_HISO_CHROMA_FILTER_VERY_LOW,
        ITUNER_HISO_CHROMA_FILTER_MED_COMBINE,
        ITUNER_HISO_CHROMA_FILTER_LOW_COMBINE,
        ITUNER_HISO_CHROMA_FILTER_VERY_LOW_COMBINE,
        ITUNER_HISO_LUMA_NOISE_COMBINE,
        ITUNER_HISO_LOW_ASF_COMBINE,
        ITUNER_HISO_FREQ_RECOVER,
        ITUNER_STATIC_BAD_PIXEL_CORRECTION,
        ITUNER_DZOOM,
    };
    const UINT8 Video_Filter[] = {
        ITUNER_COLOR_CORRECTION,
        ITUNER_STATIC_BLACK_LEVEL,
        ITUNER_DEFERRED_BLACK_LEVEL,
        ITUNER_DYNAMIC_BAD_PIXEL_CORRECTION,
        ITUNER_CFA_LEAKAGE_FILTER,
        ITUNER_CFA_NOISE_FILTER,
        ITUNER_ANTI_ALIASING_STRENGTH,
        ITUNER_WB_GAIN,
        ITUNER_DGAIN_SATURATION_LEVEL,
        ITUNER_LOCAL_EXPOSURE,
        ITUNER_TONE_CURVE,
        ITUNER_RGB_TO_YUV_MATRIX,
        ITUNER_CHROMA_SCALE,
        ITUNER_CHROMA_MEDIAN_FILTER,
        ITUNER_DEMOSAIC_FILTER,
        ITUNER_GB_GR_MISMATCH,
        ITUNER_SHP_A_OR_SPATIAL_FILTE_SELECT,
//        ITUNER_CDNR,
        ITUNER_CHROMA_FILTER,
//        ITUNER_VIDEO_MCTF,
        ITUNER_DZOOM,
    };
    // High Iso
    const UINT8 Hiso_Video_Filter[] = {
        ITUNER_COLOR_CORRECTION,
        ITUNER_STATIC_BLACK_LEVEL,
        ITUNER_DEFERRED_BLACK_LEVEL,
        ITUNER_DYNAMIC_BAD_PIXEL_CORRECTION,
        ITUNER_CFA_LEAKAGE_FILTER,
        ITUNER_CFA_NOISE_FILTER,
        ITUNER_ANTI_ALIASING_STRENGTH,
        ITUNER_WB_GAIN,
        ITUNER_DGAIN_SATURATION_LEVEL,
        ITUNER_LOCAL_EXPOSURE,
        ITUNER_TONE_CURVE,
        ITUNER_RGB_TO_YUV_MATRIX,
        ITUNER_CHROMA_SCALE,
        //ITUNER_CHROMA_MEDIAN_FILTER,
        ITUNER_DEMOSAIC_FILTER,
        ITUNER_GB_GR_MISMATCH,
        //ITUNER_SHP_A_OR_SPATIAL_FILTE_SELECT,
        //ITUNER_CDNR,
        //ITUNER_CHROMA_FILTER,
        ITUNER_VIDEO_MCTF,
        ITUNER_DZOOM,
    };

    const UINT8 *Necessary_Filter = NULL;
    UINT8 Size = 0;
    if (Mode.Pipe == AMBA_DSP_IMG_PIPE_VIDEO) {
        if (Mode.AlgoMode == AMBA_DSP_IMG_ALGO_MODE_HISO) {
            Necessary_Filter = Hiso_Video_Filter;
            Size = sizeof(Hiso_Video_Filter) / sizeof(Hiso_Video_Filter[0]);
        } else {
            Necessary_Filter = Video_Filter;
            Size = sizeof(Video_Filter) / sizeof(Video_Filter[0]);
        }
        // HENRY TBD
        // TODO: Add Preview Tuning
    } else {
        // Note: Still Mode
        if (Mode.AlgoMode == AMBA_DSP_IMG_ALGO_MODE_HISO) {
            Necessary_Filter = Hiso_Still_Filter;
            Size = sizeof(Hiso_Still_Filter) / sizeof(Hiso_Still_Filter[0]);
        } else {
            Necessary_Filter = Liso_Still_Filter;
            Size = sizeof(Liso_Still_Filter) / sizeof(Liso_Still_Filter[0]);
        }
    }
    int Ret = 0;
    int i;
    for (i = 0; i < Size; i++) {
        if (_Ituner_Valid_Filter[(UINT8)Necessary_Filter[i]] == 0) {
            ITUNER_WARF("%s() %d, Pipe: %d, AlogMode: %d Lose Filter ID : %s", __func__, __LINE__, Mode.Pipe, Mode.AlgoMode, _G_Filter_Name[(UINT8)Necessary_Filter[i]]);
            Ret = -1;
        }
    }
    return Ret;
}

static inline void _AmbaItuner_GData_Init(void)
{
    memset(_Ituner_Valid_Filter, 0x0, sizeof(_Ituner_Valid_Filter));
    memset(&GData, 0x0, sizeof(ITUNER_DATA_s));
    // HENRY TBD
    // TODO: Clear GTable
#if 0
    //Liso Sharp and Asf
    GData.SharpenBoth.ThreeD.pTable = GTable.SharpenBothThreeDTable;
    GData.FinalSharpenBoth.ThreeD.pTable = GTable.FinalSharpenBothThreeDTable;
    GData.AsfInfo.Adapt.ThreeD.pTable = GTable.AsfInfoThreeDTable;
    //Hiso Asf
    GData.HisoAsf.Adapt.ThreeD.pTable       = GTable.HisoAsfThreeDTable;
    GData.HisoHighAsf.Adapt.ThreeD.pTable   = GTable.HisoHighAsfThreeDTable;
    GData.HisoLowAsf.Adapt.ThreeD.pTable    = GTable.HisoLowAsfThreeDTable;
    GData.HisoMedAsf.Adapt.ThreeD.pTable   = GTable.HisoMedAsfThreeDTable;
    GData.HisoLi2ndAsf.Adapt.ThreeD.pTable  = GTable.HisoLi2ndAsfThreeDTable;
    GData.HisoChromaAsf.ThreeD.pTable = GTable.HisoChromaAsfThreeDTable;
    //HisoHighSharpen
    GData.HisoHighSharpenBoth.ThreeD.pTable = GTable.HisoHighSharpenBothThreeDTable;
    //HisoMedSharpen
    GData.HisoMedSharpenBoth.ThreeD.pTable = GTable.HisoMedSharpenBothThreeDTable;
    //HisoLiso1Sharpen
    GData.HisoLiso1SharpenBoth.ThreeD.pTable = GTable.HisoLiso1SharpenBothThreeDTable;
    //HisoMedSharpen
    GData.HisoLiso2SharpenBoth.ThreeD.pTable = GTable.HisoLiso2SharpenBothThreeDTable;
#endif
}

static inline void _AmbaItuner_System_Init(void)
{
    //HENRY TBD
    /*
    typedef enum {
        ITUNER_SAVE,
        ITUNER_LOAD,
        ITUNER_RAW_ENC,
        ITUNER_RAW_CAP,
    } ITUNER_MODE_e;
    ITUNER_MODE_e Ituner_Mode = ITUNER_SAVE;
    */
    memset(&_System, 0x0, sizeof(_System));
    strncpy(_System.ChipRev, "A9\0", sizeof(_System.ChipRev));
    // TODO:
    strncpy(_System.TuningMode, TUING_MODE_TO_STR(IMG_MODE_VIDEO), sizeof(_System.TuningMode));
    strncpy(_System.TuningModeExt, TUING_MODE_EXT_TO_STR(SINGLE_SHOT), sizeof(_System.TuningModeExt));
    /*
    switch(Ituner_Mode)
    {
        case ITUNER_SAVE:
            strncpy(_System.TuningMode, TUING_MODE_TO_STR(IMG_MODE_VIDEO), sizeof(_System.TuningMode));
            strncpy(_System.TuningModeExt, TUING_MODE_EXT_TO_STR(SINGLE_SHOT), sizeof(_System.TuningModeExt));
            break;
    }
    */
}

static inline void _AmbaItuner_Internal_Init(void)
{
    memset(&_Internal, 0x0, sizeof(_Internal));
    _Internal.FpnHighlight = -1;
    _Internal.Internal_u16_1 = 0;
    _Internal.Internal_s32_0 = -1;
    _Internal.Internal_s32_1 = -1;
    _Internal.Internal_s32_2 = -1;
    _Internal.Internal_s32_3 = -1;
    _Internal.Internal_s32_4 = -1;
    _Internal.Internal_sha_0 = -1;
    _Internal.Internal_sha_1 = -1;
    _Internal.Internal_sha_2 = -1;
    _Internal.Internal_sha_3 = -1;
    _Internal.Internal_sha_4 = -1;
    _Internal.Internal_sha_5 = -1;
    _Internal.Internal_shb_0 = -1;
    _Internal.Internal_shb_1 = -1;
    _Internal.Internal_shb_2 = -1;
    _Internal.Internal_shb_3 = -1;
    _Internal.Internal_shb_4 = -1;
    _Internal.Internal_shb_5 = -1;
    _Internal.Internal_wm_0 = -1;
    _Internal.Internal_wm_1 = -1;
    _Internal.Internal_wm_2 = -1;
    _Internal.Internal_wm_3 = -1;
    _Internal.NOT_CUSTOMER_VISIBLE_FULL_RAW_W = -1;
    _Internal.NOT_CUSTOMER_VISIBLE_FULL_MAIN_W = -1;
    _Internal.Internal_hdr_0 = -1;
    _Internal.Internal_hdr_1 = -1;
    _Internal.DiagMode = 0;
}
/*
void _set_internal_params_default(void) {
    _Internal.FpnHighlight = -1;
    _Internal.Internal_u16_1 = 0;
    _Internal.Internal_s32_0 = -1;
    _Internal.Internal_s32_1 = -1;
    _Internal.Internal_s32_2 = -1;
    _Internal.Internal_s32_3 = -1;
    _Internal.Internal_s32_4 = -1;
    _Internal.Internal_sha_0 = -1;
    _Internal.Internal_sha_1 = -1;
    _Internal.Internal_sha_2 = -1;
    _Internal.Internal_sha_3 = -1;
    _Internal.Internal_sha_4 = -1;
    _Internal.Internal_sha_5 = -1;
    _Internal.Internal_shb_0 = -1;
    _Internal.Internal_shb_1 = -1;
    _Internal.Internal_shb_2 = -1;
    _Internal.Internal_shb_3 = -1;
    _Internal.Internal_shb_4 = -1;
    _Internal.Internal_shb_5 = -1;
    _Internal.Internal_wm_0 = -1;
    _Internal.Internal_wm_1 = -1;
    _Internal.Internal_wm_2 = -1;
    _Internal.Internal_wm_3 = -1;
    _Internal.NOT_CUSTOMER_VISIBLE_FULL_RAW_W = -1;
    _Internal.NOT_CUSTOMER_VISIBLE_FULL_MAIN_W = -1;
    _Internal.Internal_hdr_0 = -1;
    _Internal.Internal_hdr_1 = -1;
    _Internal.DiagMode = 0;
}
*/
void AmbaItuner_Set_InternalInfo(Ituner_Internal_s *Internal) {
    memcpy(&_Internal, Internal, sizeof(_Internal));
    _AmbaItuner_Set_Filter_Valid(ITUNER_INTERNAL_INFO);
}

void AmbaItuner_Get_InternalInfo(Ituner_Internal_s *Internal) {
    memcpy(Internal, &_Internal, sizeof(Ituner_Internal_s));
}

void AmbaItuner_Set_SystemInfo(ITUNER_SYSTEM_s *System) {
    memcpy(&_System, System, sizeof(_System));
    _AmbaItuner_Set_Filter_Valid(ITUNER_SYSTEM_INFO);
}

void AmbaItuner_Get_SystemInfo(ITUNER_SYSTEM_s *System) {
    memcpy(System, &_System, sizeof(ITUNER_SYSTEM_s));
}

void AmbaItuner_Set_AAAFunction(AAA_FUNC_s *AaaFunction) {
    memcpy(&GData.AaaFunction, AaaFunction, sizeof(GData.AaaFunction));
    _AmbaItuner_Set_Filter_Valid(ITUNER_AAA_FUNCTION);
}

void AmbaItuner_Get_AAAFunction(AAA_FUNC_s *AaaFunction) {
    memcpy(AaaFunction, &GData.AaaFunction, sizeof(AAA_FUNC_s));
}

void AmbaItuner_Set_AeInfo(IMG_EXP_s *AeInfo) {
    memcpy(&GData.AeInfo, AeInfo, sizeof(GData.AeInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_AE_INFO);
}

void AmbaItuner_Get_AeInfo(IMG_EXP_s *AeInfo) {
    memcpy(AeInfo, &GData.AeInfo, sizeof(IMG_EXP_s));
}

void AmbaItuner_Set_AeStatisticsInfo(amba_img_dsp_ae_stat_info_t *AeStatisticsInfo) {
    memcpy(&GData.AeStatisticsInfo, AeStatisticsInfo, sizeof(GData.AeStatisticsInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_AE_STATISTICS_INFO);
}

void AmbaItuner_Get_AeStatisticsInfo(amba_img_dsp_ae_stat_info_t *AeStatisticsInfo) {
    memcpy(AeStatisticsInfo, &GData.AeStatisticsInfo, sizeof(amba_img_dsp_ae_stat_info_t));
}

void AmbaItuner_Set_AwbStatisticsInfo(amba_img_dsp_awb_stat_info_t *AwbStatisticsInfo) {
    memcpy(&GData.AwbStatisticsInfo, AwbStatisticsInfo, sizeof(GData.AwbStatisticsInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_AWB_STATISTICS_INFO);
}

void AmbaItuner_Get_AwbStatisticsInfo(amba_img_dsp_awb_stat_info_t *AwbStatisticsInfo) {
    memcpy(AwbStatisticsInfo, &GData.AwbStatisticsInfo, sizeof(amba_img_dsp_awb_stat_info_t));
}

void AmbaItuner_Set_AfStatisticsInfo(amba_img_dsp_af_stat_info_t *AfStatisticsInfo) {
    memcpy(&GData.AfStatisticsInfo, AfStatisticsInfo, sizeof(GData.AfStatisticsInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_AF_STATISTICS_INFO);
}

void AmbaItuner_Get_AfStatisticsInfo(amba_img_dsp_af_stat_info_t *AfStatisticsInfo) {
    memcpy(AfStatisticsInfo, &GData.AfStatisticsInfo, sizeof(amba_img_dsp_af_stat_info_t));
}

void AmbaItuner_Set_StaticBadPixelCorrection(ITUNER_FPN_s *StaticBadPixelCorrection) {
    memcpy(&GData.StaticBadPixelCorrection, StaticBadPixelCorrection, sizeof(GData.StaticBadPixelCorrection));
    _AmbaItuner_Set_Filter_Valid(ITUNER_STATIC_BAD_PIXEL_CORRECTION);
}

void AmbaItuner_Get_StaticBadPixelCorrection(ITUNER_FPN_s *StaticBadPixelCorrection) {
    memcpy(StaticBadPixelCorrection, &GData.StaticBadPixelCorrection, sizeof(ITUNER_FPN_s));
}

void AmbaItuner_Get_SbpCorr(amba_img_dsp_sbp_correction_t *SbpCorr) {
    // Note: Only Get, without Set Api
    memcpy(SbpCorr, &GData.SbpCorr, sizeof(amba_img_dsp_sbp_correction_t));
}

void AmbaItuner_Set_StaticBadPixelCorrectionByPass(ITUNER_FPN_BYPASS_s *StaticBadPixelCorrectionByPass) {
    memcpy(&GData.StaticBadPixelCorrectionByPass, StaticBadPixelCorrectionByPass, sizeof(GData.StaticBadPixelCorrectionByPass));
    _AmbaItuner_Set_Filter_Valid(ITUNER_STATIC_BAD_PIXEL_CORRECTION_BY_PASS);
}

void AmbaItuner_Get_StaticBadPixelCorrectionByPass(ITUNER_FPN_BYPASS_s *StaticBadPixelCorrectionByPass) {
    memcpy(StaticBadPixelCorrectionByPass, &GData.StaticBadPixelCorrectionByPass, sizeof(ITUNER_FPN_BYPASS_s));
}

void AmbaItuner_Set_VignetteCompensation(ITUNER_VIGNETTE_s *VignetteCompensation) {
    memcpy(&GData.VignetteCompensation, VignetteCompensation, sizeof(GData.VignetteCompensation));
    _AmbaItuner_Set_Filter_Valid(ITUNER_VIGNETTE_COMPENSATION);
}

void AmbaItuner_Get_VignetteCompensation(ITUNER_VIGNETTE_s *VignetteCompensation) {
    memcpy(VignetteCompensation, &GData.VignetteCompensation, sizeof(ITUNER_VIGNETTE_s));
}

void AmbaItuner_Get_VignetteCalcInfo(amba_img_dsp_vignette_calc_info_t *VignetteCalcInfo) {
    // Note: Only Get, without Set Api
    memcpy(VignetteCalcInfo, &GData.VignetteCalcInfo, sizeof(amba_img_dsp_vignette_calc_info_t));
}

void AmbaItuner_Set_VignetteCompensationByPass(ITUNER_VIGNETTE_BYPASS_s *VignetteCompensationByPass) {
    memcpy(&GData.VignetteCompensationByPass, VignetteCompensationByPass, sizeof(GData.VignetteCompensationByPass));
    _AmbaItuner_Set_Filter_Valid(ITUNER_VIGNETTE_COMPENSATION_BY_PASS);
}

void AmbaItuner_Get_VignetteCompensationByPass(ITUNER_VIGNETTE_BYPASS_s *VignetteCompensationByPass) {
    memcpy(VignetteCompensationByPass, &GData.VignetteCompensationByPass, sizeof(ITUNER_VIGNETTE_BYPASS_s));
}

void AmbaItuner_Set_WarpCompensation(ITUNER_WARP_s *WarpCompensation) {
    memcpy(&GData.WarpCompensation, WarpCompensation, sizeof(GData.WarpCompensation));
    _AmbaItuner_Set_Filter_Valid(ITUNER_WARP_COMPENSATION);
}

void AmbaItuner_Get_WarpCompensation(ITUNER_WARP_s *WarpCompensation) {
    memcpy(WarpCompensation, &GData.WarpCompensation, sizeof(ITUNER_WARP_s));
}

void AmbaItuner_Get_WarpCalcInfo(amba_img_dsp_warp_calc_info_t *WarpCalcInfo) {
    memcpy(WarpCalcInfo, &GData.WarpCalcInfo, sizeof(amba_img_dsp_warp_calc_info_t));
}

void AmbaItuner_Set_Dzoom(ITUNER_DZOOM_s *Dzoom) {
    memcpy(&GData.Dzoom, Dzoom, sizeof(GData.Dzoom));
    _AmbaItuner_Set_Filter_Valid(ITUNER_DZOOM);
}

void AmbaItuner_Get_Dzoom(ITUNER_DZOOM_s *Dzoom) {
    memcpy(Dzoom, &GData.Dzoom, sizeof(ITUNER_DZOOM_s));
}

void AmbaItuner_Set_WarpCompensationDzoomByPass(ITUNER_WARP_DZOOM_BYPASS_s *WarpCompensationDzoomByPass) {
    memcpy(&GData.WarpCompensationDzoomByPass, WarpCompensationDzoomByPass, sizeof(GData.WarpCompensationDzoomByPass));
    _AmbaItuner_Set_Filter_Valid(ITUNER_WARP_COMPENSATION_DZOOM_BY_PASS);
}

void AmbaItuner_Get_WarpCompensationDzoomByPass(ITUNER_WARP_DZOOM_BYPASS_s *WarpCompensationDzoomByPass) {
    memcpy(WarpCompensationDzoomByPass, &GData.WarpCompensationDzoomByPass, sizeof(ITUNER_WARP_DZOOM_BYPASS_s));
}

void AmbaItuner_Set_SensorInputInfo(ITUNER_SENSOR_INPUT_s *SensorInputInfo) {
    memcpy(&GData.SensorInputInfo, SensorInputInfo, sizeof(GData.SensorInputInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_SENSOR_INPUT_INFO);
}

void AmbaItuner_Get_SensorInputInfo(ITUNER_SENSOR_INPUT_s *SensorInputInfo) {
    memcpy(SensorInputInfo, &GData.SensorInputInfo, sizeof(ITUNER_SENSOR_INPUT_s));
}

void AmbaItuner_Set_StaticBlackLevel(amba_img_dsp_black_correction_t *StaticBlackLevel) {
    memcpy(&GData.StaticBlackLevel, StaticBlackLevel, sizeof(GData.StaticBlackLevel));
    _AmbaItuner_Set_Filter_Valid(ITUNER_STATIC_BLACK_LEVEL);
}

void AmbaItuner_Get_StaticBlackLevel(amba_img_dsp_black_correction_t *StaticBlackLevel) {
    memcpy(StaticBlackLevel, &GData.StaticBlackLevel, sizeof(amba_img_dsp_black_correction_t));
}

void AmbaItuner_Set_DeferredBlackLevel(amba_img_dsp_def_blc_t *DeferredBlackLevel) {
    memcpy(&GData.DeferredBlackLevel, DeferredBlackLevel, sizeof(GData.DeferredBlackLevel));
    _AmbaItuner_Set_Filter_Valid(ITUNER_DEFERRED_BLACK_LEVEL);
}

void AmbaItuner_Get_DeferredBlackLevel(amba_img_dsp_def_blc_t *DeferredBlackLevel) {
    memcpy(DeferredBlackLevel, &GData.DeferredBlackLevel, sizeof(amba_img_dsp_def_blc_t));
}

void AmbaItuner_Set_DynamicBadPixelCorrection(amba_img_dsp_dbp_correction_t *DynamicBadPixelCorrection) {
    memcpy(&GData.DynamicBadPixelCorrection, DynamicBadPixelCorrection, sizeof(GData.DynamicBadPixelCorrection));
    _AmbaItuner_Set_Filter_Valid(ITUNER_DYNAMIC_BAD_PIXEL_CORRECTION);
}

void AmbaItuner_Get_DynamicBadPixelCorrection(amba_img_dsp_dbp_correction_t *DynamicBadPixelCorrection) {
    memcpy(DynamicBadPixelCorrection, &GData.DynamicBadPixelCorrection, sizeof(amba_img_dsp_dbp_correction_t));
}

void AmbaItuner_Set_HisoDynamicBadPixelCorrection(amba_img_dsp_dbp_correction_t *HisoDynamicBadPixelCorrection) {
    memcpy(&GData.HisoDynamicBadPixelCorrection, HisoDynamicBadPixelCorrection, sizeof(GData.HisoDynamicBadPixelCorrection));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_DYNAMIC_BAD_PIXEL_CORRECTION);
}

void AmbaItuner_Get_HisoDynamicBadPixelCorrection(amba_img_dsp_dbp_correction_t *HisoDynamicBadPixelCorrection) {
    memcpy(HisoDynamicBadPixelCorrection, &GData.HisoDynamicBadPixelCorrection, sizeof(amba_img_dsp_dbp_correction_t));
}

void AmbaItuner_Set_CfaLeakageFilter(amba_img_dsp_cfa_leakage_filter_t *CfaLeakageFilter) {
    memcpy(&GData.CfaLeakageFilter, CfaLeakageFilter, sizeof(GData.CfaLeakageFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CFA_LEAKAGE_FILTER);
}

void AmbaItuner_Get_CfaLeakageFilter(amba_img_dsp_cfa_leakage_filter_t *CfaLeakageFilter) {
    memcpy(CfaLeakageFilter, &GData.CfaLeakageFilter, sizeof(amba_img_dsp_cfa_leakage_filter_t));
}

void AmbaItuner_Set_HisoCfaLeakageFilter(amba_img_dsp_cfa_leakage_filter_t *HisoCfaLeakageFilter) {
    memcpy(&GData.HisoCfaLeakageFilter, HisoCfaLeakageFilter, sizeof(GData.HisoCfaLeakageFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CFA_LEAKAGE_FILTER);
}

void AmbaItuner_Get_HisoCfaLeakageFilter(amba_img_dsp_cfa_leakage_filter_t *HisoCfaLeakageFilter) {
    memcpy(HisoCfaLeakageFilter, &GData.HisoCfaLeakageFilter, sizeof(amba_img_dsp_cfa_leakage_filter_t));
}

void AmbaItuner_Set_CfaNoiseFilter(amba_img_dsp_cfa_noise_filter_t *CfaNoiseFilter) {
    memcpy(&GData.CfaNoiseFilter, CfaNoiseFilter, sizeof(GData.CfaNoiseFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CFA_NOISE_FILTER);
}

void AmbaItuner_Get_CfaNoiseFilter(amba_img_dsp_cfa_noise_filter_t *CfaNoiseFilter) {
    memcpy(CfaNoiseFilter, &GData.CfaNoiseFilter, sizeof(amba_img_dsp_cfa_noise_filter_t));
}

void AmbaItuner_Set_HisoCfaNoiseFilter(amba_img_dsp_cfa_noise_filter_t *HisoCfaNoiseFilter) {
    memcpy(&GData.HisoCfaNoiseFilter, HisoCfaNoiseFilter, sizeof(GData.HisoCfaNoiseFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CFA_NOISE_FILTER);
}

void AmbaItuner_Get_HisoCfaNoiseFilter(amba_img_dsp_cfa_noise_filter_t *HisoCfaNoiseFilter) {
    memcpy(HisoCfaNoiseFilter, &GData.HisoCfaNoiseFilter, sizeof(amba_img_dsp_cfa_noise_filter_t));
}

void AmbaItuner_Set_AntiAliasingStrength(amba_img_dsp_anti_aliasing_t *AntiAliasing) {
    memcpy(&GData.AntiAliasing, AntiAliasing, sizeof(amba_img_dsp_anti_aliasing_t));
    _AmbaItuner_Set_Filter_Valid(ITUNER_ANTI_ALIASING_STRENGTH);
}

void AmbaItuner_Get_AntiAliasingStrength(amba_img_dsp_anti_aliasing_t *AntiAliasing) {
    *AntiAliasing = GData.AntiAliasing;
}

void AmbaItuner_Set_HisoAntiAliasingStrength(amba_img_dsp_anti_aliasing_t *HisoAntiAliasing) {
    memcpy(&GData.HisoAntiAliasing, HisoAntiAliasing, sizeof(amba_img_dsp_anti_aliasing_t));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_ANTI_ALIASING_STRENGTH);
}

void AmbaItuner_Get_HisoAntiAliasingStrength(amba_img_dsp_anti_aliasing_t *HisoAntiAliasing) {
    *HisoAntiAliasing = GData.HisoAntiAliasing;
}


void AmbaItuner_Set_GlobalDgain(UINT32 GlobalDgain) {
    GData.GlobalDgain = GlobalDgain;
    _AmbaItuner_Set_Filter_Valid(ITUNER_GLOBAL_DGAIN);
}

void AmbaItuner_Get_GlobalDgain(UINT32 *GlobalDgain) {
    *GlobalDgain = GData.GlobalDgain;
}

void AmbaItuner_Set_WbGain(amba_img_dsp_wb_gain_t *WbGain) {
    memcpy(&GData.WbGain, WbGain, sizeof(GData.WbGain));
    _AmbaItuner_Set_Filter_Valid(ITUNER_WB_GAIN);
}

void AmbaItuner_Get_WbGain(amba_img_dsp_wb_gain_t *WbGain) {
    memcpy(WbGain, &GData.WbGain, sizeof(amba_img_dsp_wb_gain_t));
}

void AmbaItuner_Set_DgainSaturationLevel(amba_img_dsp_dgain_saturation_t *DgainSaturationLevel) {
    memcpy(&GData.DgainSaturationLevel, DgainSaturationLevel, sizeof(GData.DgainSaturationLevel));
    _AmbaItuner_Set_Filter_Valid(ITUNER_DGAIN_SATURATION_LEVEL);
}

void AmbaItuner_Get_DgainSaturationLevel(amba_img_dsp_dgain_saturation_t *DgainSaturationLevel) {
    memcpy(DgainSaturationLevel, &GData.DgainSaturationLevel, sizeof(amba_img_dsp_dgain_saturation_t));
}

void AmbaItuner_Set_LocalExposure(amba_img_dsp_local_exposure_t *LocalExposure) {
    memcpy(&GData.LocalExposure, LocalExposure, sizeof(GData.LocalExposure));
    _AmbaItuner_Set_Filter_Valid(ITUNER_LOCAL_EXPOSURE);
}

void AmbaItuner_Get_LocalExposure(amba_img_dsp_local_exposure_t *LocalExposure) {
    memcpy(LocalExposure, &GData.LocalExposure, sizeof(amba_img_dsp_local_exposure_t));
}

void AmbaItuner_Get_FilterStatus(AMBA_ITUNER_VALID_FILTER_t *FilterStatus)
{
    // Note: Only Get, without Set Api
    memcpy(FilterStatus, &_Ituner_Valid_Filter, sizeof(AMBA_ITUNER_VALID_FILTER_t));
}

void AmbaItuner_Get_CcReg(amba_img_dsp_color_correction_reg_t *CcReg) {
    // Note: Only Get, without Set Api
    memcpy(CcReg, &GData.CcReg, sizeof(amba_img_dsp_color_correction_reg_t));
}

void AmbaItuner_Get_CcThreeD(amba_img_dsp_color_correction_t *CcThreeD) {
    // Note: Only Get, without Set Api
    memcpy(CcThreeD, &GData.CcThreeD, sizeof(amba_img_dsp_color_correction_t));
}

void AmbaItuner_Set_ColorCorrection(ITUNER_COLOR_CORRECTION_s *ColorCorrection) {
    memcpy(&GData.ColorCorrection, ColorCorrection, sizeof(GData.ColorCorrection));
    _AmbaItuner_Set_Filter_Valid(ITUNER_COLOR_CORRECTION);
}

void AmbaItuner_Get_ColorCorrection(ITUNER_COLOR_CORRECTION_s *ColorCorrection) {
    memcpy(ColorCorrection, &GData.ColorCorrection, sizeof(ITUNER_COLOR_CORRECTION_s));
}

void AmbaItuner_Set_ToneCurve(amba_img_dsp_tone_curve_t *ToneCurve) {
    memcpy(&GData.ToneCurve, ToneCurve, sizeof(GData.ToneCurve));
    _AmbaItuner_Set_Filter_Valid(ITUNER_TONE_CURVE);
}

void AmbaItuner_Get_ToneCurve(amba_img_dsp_tone_curve_t *ToneCurve) {
    memcpy(ToneCurve, &GData.ToneCurve, sizeof(amba_img_dsp_tone_curve_t));
}

void AmbaItuner_Set_RgbToYuvMatrix(amba_img_dsp_rgb_to_yuv_t *RgbToYuvMatrix) {
    memcpy(&GData.RgbToYuvMatrix, RgbToYuvMatrix, sizeof(GData.RgbToYuvMatrix));
    _AmbaItuner_Set_Filter_Valid(ITUNER_RGB_TO_YUV_MATRIX);
}

void AmbaItuner_Get_RgbToYuvMatrix(amba_img_dsp_rgb_to_yuv_t *RgbToYuvMatrix) {
    memcpy(RgbToYuvMatrix, &GData.RgbToYuvMatrix, sizeof(amba_img_dsp_rgb_to_yuv_t));
}

void AmbaItuner_Set_ChromaScale(amba_img_dsp_chroma_scale_t *ChromaScale) {
    memcpy(&GData.ChromaScale, ChromaScale, sizeof(GData.ChromaScale));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_SCALE);
}

void AmbaItuner_Get_ChromaScale(amba_img_dsp_chroma_scale_t *ChromaScale) {
    memcpy(ChromaScale, &GData.ChromaScale, sizeof(amba_img_dsp_chroma_scale_t));
}

void AmbaItuner_Set_ChromaMedianFilter(amba_img_dsp_chroma_median_filter_t *ChromaMedianFilter) {
    memcpy(&GData.ChromaMedianFilter, ChromaMedianFilter, sizeof(GData.ChromaMedianFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_MEDIAN_FILTER);
}

void AmbaItuner_Get_ChromaMedianFilter(amba_img_dsp_chroma_median_filter_t *ChromaMedianFilter) {
    memcpy(ChromaMedianFilter, &GData.ChromaMedianFilter, sizeof(amba_img_dsp_chroma_median_filter_t));
}

void AmbaItuner_Set_HisoChromaMedianFilter(amba_img_dsp_chroma_median_filter_t *HisoChromaMedianFilter) {
    memcpy(&GData.HisoChromaMedianFilter, HisoChromaMedianFilter, sizeof(GData.HisoChromaMedianFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_MEDIAN_FILTER);
}

void AmbaItuner_Get_HisoChromaMedianFilter(amba_img_dsp_chroma_median_filter_t *HisoChromaMedianFilter) {
    memcpy(HisoChromaMedianFilter, &GData.HisoChromaMedianFilter, sizeof(amba_img_dsp_chroma_median_filter_t));
}

void AmbaItuner_Set_DemosaicFilter(amba_img_dsp_demosaic_t *DemosaicFilter) {
    memcpy(&GData.DemosaicFilter, DemosaicFilter, sizeof(amba_img_dsp_demosaic_t));
    _AmbaItuner_Set_Filter_Valid(ITUNER_DEMOSAIC_FILTER);
}

void AmbaItuner_Get_DemosaicFilter(amba_img_dsp_demosaic_t *DemosaicFilter) {
    memcpy(DemosaicFilter, &GData.DemosaicFilter, sizeof(GData.DemosaicFilter));
}

void AmbaItuner_Set_HisoDemosaicFilter(amba_img_dsp_demosaic_t *HisoDemosaicFilter) {
    memcpy(&GData.HisoDemosaicFilter, HisoDemosaicFilter, sizeof(GData.HisoDemosaicFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_DEMOSAIC_FILTER);
}
void AmbaItuner_Get_HisoDemosaicFilter(amba_img_dsp_demosaic_t *HisoDemosaicFilter) {
    memcpy(HisoDemosaicFilter, &GData.HisoDemosaicFilter, sizeof(amba_img_dsp_demosaic_t));
}

void AmbaItuner_Set_SharpenBoth(amba_img_dsp_sharpen_both_t *SharpenBoth) {
    memcpy(&GData.SharpenBoth, SharpenBoth, sizeof(GData.SharpenBoth));
    _AmbaItuner_Set_Filter_Valid(ITUNER_SHARPEN_BOTH);
}

void AmbaItuner_Get_SharpenBoth(amba_img_dsp_sharpen_both_t *SharpenBoth) {
    memcpy(SharpenBoth, &GData.SharpenBoth, sizeof(amba_img_dsp_sharpen_both_t));
}

void AmbaItuner_Set_FinalSharpenBoth(amba_img_dsp_sharpen_both_t *FinalSharpenBoth) {
    memcpy(&GData.FinalSharpenBoth, FinalSharpenBoth, sizeof(GData.FinalSharpenBoth));
    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SHARPEN_BOTH);
}

void AmbaItuner_Get_FinalSharpenBoth(amba_img_dsp_sharpen_both_t *FinalSharpenBoth) {
    memcpy(FinalSharpenBoth, &GData.FinalSharpenBoth, sizeof(amba_img_dsp_sharpen_both_t));
}

void AmbaItuner_Set_HisoHighSharpenBoth(amba_img_dsp_sharpen_both_t *HisoHighSharpenBoth) {
    memcpy(&GData.HisoHighSharpenBoth, HisoHighSharpenBoth, sizeof(GData.HisoHighSharpenBoth));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_SHARPEN_BOTH);
}

void AmbaItuner_Get_HisoHighSharpenBoth(amba_img_dsp_sharpen_both_t *HisoHighSharpenBoth) {
    memcpy(HisoHighSharpenBoth, &GData.HisoHighSharpenBoth, sizeof(amba_img_dsp_sharpen_both_t));
}

void AmbaItuner_Set_HisoMedSharpenBoth(amba_img_dsp_sharpen_both_t *HisoMedSharpenBoth) {
    memcpy(&GData.HisoMedSharpenBoth, HisoMedSharpenBoth, sizeof(GData.HisoMedSharpenBoth));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_SHARPEN_BOTH);
}

void AmbaItuner_Get_HisoMedSharpenBoth(amba_img_dsp_sharpen_both_t *HisoMedSharpenBoth) {
    memcpy(HisoMedSharpenBoth, &GData.HisoMedSharpenBoth, sizeof(amba_img_dsp_sharpen_both_t));
}

void AmbaItuner_Set_SharpenNoise(amba_img_dsp_sharpen_noise_t *SharpenNoise) {
    memcpy(&GData.SharpenNoise, SharpenNoise, sizeof(GData.SharpenNoise));
    _AmbaItuner_Set_Filter_Valid(ITUNER_SHARPEN_NOISE);
}

void AmbaItuner_Get_SharpenNoise(amba_img_dsp_sharpen_noise_t *SharpenNoise) {
    memcpy(SharpenNoise, &GData.SharpenNoise, sizeof(amba_img_dsp_sharpen_noise_t));
}

void AmbaItuner_Set_FinalSharpenNoise(amba_img_dsp_sharpen_noise_t *FinalSharpenNoise) {
    memcpy(&GData.FinalSharpenNoise, FinalSharpenNoise, sizeof(GData.FinalSharpenNoise));
    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SHARPEN_NOISE);
}

void AmbaItuner_Get_FinalSharpenNoise(amba_img_dsp_sharpen_noise_t *FinalSharpenNoise) {
    memcpy(FinalSharpenNoise, &GData.FinalSharpenNoise, sizeof(amba_img_dsp_sharpen_noise_t));
}

void AmbaItuner_Set_HisoHighSharpenNoise(amba_img_dsp_sharpen_noise_t *HisoHighSharpenNoise) {
    memcpy(&GData.HisoHighSharpenNoise, HisoHighSharpenNoise, sizeof(GData.HisoHighSharpenNoise));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_SHARPEN_NOISE);
}

void AmbaItuner_Get_HisoHighSharpenNoise(amba_img_dsp_sharpen_noise_t *HisoHighSharpenNoise) {
    memcpy(HisoHighSharpenNoise, &GData.HisoHighSharpenNoise, sizeof(amba_img_dsp_sharpen_noise_t));
}

void AmbaItuner_Set_HisoMedSharpenNoise(amba_img_dsp_sharpen_noise_t *HisoMedSharpenNoise) {
    memcpy(&GData.HisoMedSharpenNoise, HisoMedSharpenNoise, sizeof(GData.HisoMedSharpenNoise));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_SHARPEN_NOISE);
}

void AmbaItuner_Get_HisoMedSharpenNoise(amba_img_dsp_sharpen_noise_t *HisoMedSharpenNoise) {
    memcpy(HisoMedSharpenNoise, &GData.HisoMedSharpenNoise, sizeof(amba_img_dsp_sharpen_noise_t));
}

void AmbaItuner_Set_Fir(amba_img_dsp_fir_t *Fir) {
    memcpy(&GData.Fir, Fir, sizeof(GData.Fir));
    _AmbaItuner_Set_Filter_Valid(ITUNER_FIR);
}

void AmbaItuner_Get_Fir(amba_img_dsp_fir_t *Fir) {
    memcpy(Fir, &GData.Fir, sizeof(amba_img_dsp_fir_t));
}

void AmbaItuner_Set_FinalFir(amba_img_dsp_fir_t *FinalFir) {
    memcpy(&GData.FinalFir, FinalFir, sizeof(GData.FinalFir));
    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_FIR);
}

void AmbaItuner_Get_FinalFir(amba_img_dsp_fir_t *FinalFir) {
    memcpy(FinalFir, &GData.FinalFir, sizeof(amba_img_dsp_fir_t));
}

void AmbaItuner_Set_HisoHighFir(amba_img_dsp_fir_t *HisoHighFir) {
    memcpy(&GData.HisoHighFir, HisoHighFir, sizeof(GData.HisoHighFir));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_FIR);
}

void AmbaItuner_Get_HisoHighFir(amba_img_dsp_fir_t *HisoHighFir) {
    memcpy(HisoHighFir, &GData.HisoHighFir, sizeof(amba_img_dsp_fir_t));
}

void AmbaItuner_Set_HisoMedFir(amba_img_dsp_fir_t *HisoMedFir) {
    memcpy(&GData.HisoMedFir, HisoMedFir, sizeof(GData.HisoMedFir));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_FIR);
}

void AmbaItuner_Get_HisoMedFir(amba_img_dsp_fir_t *HisoMedFir) {
    memcpy(HisoMedFir, &GData.HisoMedFir, sizeof(amba_img_dsp_fir_t));
}

void AmbaItuner_Set_Coring(amba_img_dsp_coring_t *Coring) {
    memcpy(&GData.Coring, Coring, sizeof(GData.Coring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CORING);
}

void AmbaItuner_Get_Coring(amba_img_dsp_coring_t *Coring) {
    memcpy(Coring, &GData.Coring, sizeof(amba_img_dsp_coring_t));
}

void AmbaItuner_Set_FinalCoring(amba_img_dsp_coring_t *FinalCoring) {
    memcpy(&GData.FinalCoring, FinalCoring, sizeof(GData.FinalCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_CORING);
}

void AmbaItuner_Get_FinalCoring(amba_img_dsp_coring_t *FinalCoring) {
    memcpy(FinalCoring, &GData.FinalCoring, sizeof(amba_img_dsp_coring_t));
}

void AmbaItuner_Set_HisoHighCoring(amba_img_dsp_coring_t *HisoHighCoring) {
    memcpy(&GData.HisoHighCoring, HisoHighCoring, sizeof(GData.HisoHighCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_CORING);
}

void AmbaItuner_Get_HisoHighCoring(amba_img_dsp_coring_t *HisoHighCoring) {
    memcpy(HisoHighCoring, &GData.HisoHighCoring, sizeof(amba_img_dsp_coring_t));
}

void AmbaItuner_Set_HisoMedCoring(amba_img_dsp_coring_t *HisoMedCoring) {
    memcpy(&GData.HisoMedCoring, HisoMedCoring, sizeof(GData.HisoMedCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_CORING);
}

void AmbaItuner_Get_HisoMedCoring(amba_img_dsp_coring_t *HisoMedCoring) {
    memcpy(HisoMedCoring, &GData.HisoMedCoring, sizeof(amba_img_dsp_coring_t));
}

void AmbaItuner_Set_CoringIndexScale(amba_img_dsp_level_t *CoringIndexScale) {
    memcpy(&GData.CoringIndexScale, CoringIndexScale, sizeof(GData.CoringIndexScale));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CORING_INDEX_SCALE);
}

void AmbaItuner_Get_CoringIndexScale(amba_img_dsp_level_t *CoringIndexScale) {
    memcpy(CoringIndexScale, &GData.CoringIndexScale, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_MinCoringResult(amba_img_dsp_level_t *MinCoringResult) {
    memcpy(&GData.MinCoringResult, MinCoringResult, sizeof(GData.MinCoringResult));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MIN_CORING_RESULT);
}

void AmbaItuner_Get_MinCoringResult(amba_img_dsp_level_t *MinCoringResult) {
    memcpy(MinCoringResult, &GData.MinCoringResult, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_ScaleCoring(amba_img_dsp_level_t *ScaleCoring) {
    memcpy(&GData.ScaleCoring, ScaleCoring, sizeof(GData.ScaleCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_SCALE_CORING);
}

void AmbaItuner_Get_ScaleCoring(amba_img_dsp_level_t *ScaleCoring) {
    memcpy(ScaleCoring, &GData.ScaleCoring, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_FinalCoringIndexScale(amba_img_dsp_level_t *FinalCoringIndexScale) {
    memcpy(&GData.FinalCoringIndexScale, FinalCoringIndexScale, sizeof(GData.FinalCoringIndexScale));
    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_CORING_INDEX_SCALE);
}

void AmbaItuner_Get_FinalCoringIndexScale(amba_img_dsp_level_t *FinalCoringIndexScale) {
    memcpy(FinalCoringIndexScale, &GData.FinalCoringIndexScale, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_FinalMinCoringResult(amba_img_dsp_level_t *FinalMinCoringResult) {
    memcpy(&GData.FinalMinCoringResult, FinalMinCoringResult, sizeof(GData.FinalMinCoringResult));
    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_MIN_CORING_RESULT);
}

void AmbaItuner_Get_FinalMinCoringResult(amba_img_dsp_level_t *FinalMinCoringResult) {
    memcpy(FinalMinCoringResult, &GData.FinalMinCoringResult, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_FinalScaleCoring(amba_img_dsp_level_t *FinalScaleCoring) {
    memcpy(&GData.FinalScaleCoring, FinalScaleCoring, sizeof(GData.FinalScaleCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SCALE_CORING);
}

void AmbaItuner_Get_FinalScaleCoring(amba_img_dsp_level_t *FinalScaleCoring) {
    memcpy(FinalScaleCoring, &GData.FinalScaleCoring, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_HisoHighCoringIndexScale(amba_img_dsp_level_t *HisoHighCoringIndexScale) {
    memcpy(&GData.HisoHighCoringIndexScale, HisoHighCoringIndexScale, sizeof(GData.HisoHighCoringIndexScale));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_CORING_INDEX_SCALE);
}

void AmbaItuner_Get_HisoHighCoringIndexScale(amba_img_dsp_level_t *HisoHighCoringIndexScale) {
    memcpy(HisoHighCoringIndexScale, &GData.HisoHighCoringIndexScale, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_HisoHighMinCoringResult(amba_img_dsp_level_t *HisoHighMinCoringResult) {
    memcpy(&GData.HisoHighMinCoringResult, HisoHighMinCoringResult, sizeof(GData.HisoHighMinCoringResult));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_MIN_CORING_RESULT);
}

void AmbaItuner_Get_HisoHighMinCoringResult(amba_img_dsp_level_t *HisoHighMinCoringResult) {
    memcpy(HisoHighMinCoringResult, &GData.HisoHighMinCoringResult, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_HisoHighScaleCoring(amba_img_dsp_level_t *HisoHighScaleCoring) {
    memcpy(&GData.HisoHighScaleCoring, HisoHighScaleCoring, sizeof(GData.HisoHighScaleCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_SCALE_CORING);
}

void AmbaItuner_Get_HisoHighScaleCoring(amba_img_dsp_level_t *HisoHighScaleCoring) {
    memcpy(HisoHighScaleCoring, &GData.HisoHighScaleCoring, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_HisoMedCoringIndexScale(amba_img_dsp_level_t *HisoMedCoringIndexScale) {
    memcpy(&GData.HisoMedCoringIndexScale, HisoMedCoringIndexScale, sizeof(GData.HisoMedCoringIndexScale));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_CORING_INDEX_SCALE);
}

void AmbaItuner_Get_HisoMedCoringIndexScale(amba_img_dsp_level_t *HisoMedCoringIndexScale) {
    memcpy(HisoMedCoringIndexScale, &GData.HisoMedCoringIndexScale, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_HisoMedMinCoringResult(amba_img_dsp_level_t *HisoMedMinCoringResult) {
    memcpy(&GData.HisoMedMinCoringResult, HisoMedMinCoringResult, sizeof(GData.HisoMedMinCoringResult));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_MIN_CORING_RESULT);
}

void AmbaItuner_Get_HisoMedMinCoringResult(amba_img_dsp_level_t *HisoMedMinCoringResult) {
    memcpy(HisoMedMinCoringResult, &GData.HisoMedMinCoringResult, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_HisoMedScaleCoring(amba_img_dsp_level_t *HisoMedScaleCoring) {
    memcpy(&GData.HisoMedScaleCoring, HisoMedScaleCoring, sizeof(GData.HisoMedScaleCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_SCALE_CORING);
}

void AmbaItuner_Get_HisoMedScaleCoring(amba_img_dsp_level_t *HisoMedScaleCoring) {
    memcpy(HisoMedScaleCoring, &GData.HisoMedScaleCoring, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_VideoMctf(amba_img_dsp_video_mctf_info_t *VideoMctf) {
    memcpy(&GData.VideoMctf, VideoMctf, sizeof(GData.VideoMctf));
    _AmbaItuner_Set_Filter_Valid(ITUNER_VIDEO_MCTF);
}

void AmbaItuner_Get_VideoMctf(amba_img_dsp_video_mctf_info_t *VideoMctf) {
    memcpy(VideoMctf, &GData.VideoMctf, sizeof(amba_img_dsp_video_mctf_info_t));
}

void AmbaItuner_Set_VideoMctfTemporalAdjust(amba_img_dsp_video_mctf_temporal_adjust_t *VideoMctfTemporalAdjust) {
    memcpy(&GData.VideoMctfTemporalAdjust, VideoMctfTemporalAdjust, sizeof(GData.VideoMctfTemporalAdjust));
    _AmbaItuner_Set_Filter_Valid(ITUNER_VIDEO_MCTF_TEMPORAL_ADJUST);
}

void AmbaItuner_Get_VideoMctfTemporalAdjust(amba_img_dsp_video_mctf_temporal_adjust_t *VideoMctfTemporalAdjust) {
    memcpy(VideoMctfTemporalAdjust, &GData.VideoMctfTemporalAdjust, sizeof(amba_img_dsp_video_mctf_temporal_adjust_t));
}

void AmbaItuner_Set_CDNR(amba_img_dsp_cdnr_info_t *CDNR) {
    memcpy(&GData.CDNR, CDNR, sizeof(GData.CDNR));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CDNR);
}

void AmbaItuner_Get_CDNR(amba_img_dsp_cdnr_info_t *CDNR) {
    memcpy(CDNR, &GData.CDNR, sizeof(amba_img_dsp_cdnr_info_t));
}

void AmbaItuner_Set_HisoDeferColorCorrection(AMBA_DSP_IMG_DEFER_COLOR_CORRECTION_s *HisoDeferColorCorrection) {
    memcpy(&GData.HisoDeferColorCorrection, HisoDeferColorCorrection, sizeof(GData.HisoDeferColorCorrection));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_DEFER_COLOR_CORRECTION);
}

void AmbaItuner_Get_HisoDeferColorCorrection(AMBA_DSP_IMG_DEFER_COLOR_CORRECTION_s *HisoDeferColorCorrection) {
    memcpy(HisoDeferColorCorrection, &GData.HisoDeferColorCorrection, sizeof(AMBA_DSP_IMG_DEFER_COLOR_CORRECTION_s));
}

void AmbaItuner_Set_ShpAOrSpatialFilterSelect(amba_img_dsp_liso_process_select_t *LisoProcessSelect) {
    memcpy(&GData.LisoProcessSelect, LisoProcessSelect, sizeof(amba_img_dsp_liso_process_select_t));
    _AmbaItuner_Set_Filter_Valid(ITUNER_SHP_A_OR_SPATIAL_FILTE_SELECT);
}

void AmbaItuner_Get_ShpAOrSpatialFilterSelect(amba_img_dsp_liso_process_select_t *LisoProcessSelect) {
    memcpy(LisoProcessSelect, &GData.LisoProcessSelect, sizeof(amba_img_dsp_liso_process_select_t));
}

void AmbaItuner_Set_AsfInfo(amba_img_dsp_asf_info_t *AsfInfo) {
    memcpy(&GData.AsfInfo, AsfInfo, sizeof(GData.AsfInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_ASF_INFO);
}

void AmbaItuner_Get_AsfInfo(amba_img_dsp_asf_info_t *AsfInfo) {
    memcpy(AsfInfo, &GData.AsfInfo, sizeof(amba_img_dsp_asf_info_t));
}

void AmbaItuner_Set_HisoAsf(amba_img_dsp_asf_info_t *HisoAsf) {
    memcpy(&GData.HisoAsf, HisoAsf, sizeof(GData.HisoAsf));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_ASF);
}

void AmbaItuner_Get_HisoAsf(amba_img_dsp_asf_info_t *HisoAsf) {
    memcpy(HisoAsf, &GData.HisoAsf, sizeof(amba_img_dsp_asf_info_t));
}

void AmbaItuner_Set_HisoHighAsf(amba_img_dsp_asf_info_t *HisoHighAsf) {
    memcpy(&GData.HisoHighAsf, HisoHighAsf, sizeof(GData.HisoHighAsf));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_ASF);
}

void AmbaItuner_Get_HisoHighAsf(amba_img_dsp_asf_info_t *HisoHighAsf) {
    memcpy(HisoHighAsf, &GData.HisoHighAsf, sizeof(amba_img_dsp_asf_info_t));
}

void AmbaItuner_Set_HisoLowAsf(amba_img_dsp_asf_info_t *HisoLowAsf) {
    memcpy(&GData.HisoLowAsf, HisoLowAsf, sizeof(GData.HisoLowAsf));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LOW_ASF);
}

void AmbaItuner_Get_HisoLowAsf(amba_img_dsp_asf_info_t *HisoLowAsf) {
    memcpy(HisoLowAsf, &GData.HisoLowAsf, sizeof(amba_img_dsp_asf_info_t));
}

void AmbaItuner_Set_HisoMedAsf(amba_img_dsp_asf_info_t *HisoMedAsf) {
    memcpy(&GData.HisoMedAsf, HisoMedAsf, sizeof(GData.HisoMedAsf));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_ASF);
}

void AmbaItuner_Get_HisoMedAsf(amba_img_dsp_asf_info_t *HisoMedAsf) {
    memcpy(HisoMedAsf, &GData.HisoMedAsf, sizeof(amba_img_dsp_asf_info_t));
}

void AmbaItuner_Set_HisoChromaAsf(AMBA_DSP_IMG_CHROMA_ASF_INFO_s *HisoChromaAsf) {
    memcpy(&GData.HisoChromaAsf, HisoChromaAsf, sizeof(GData.HisoChromaAsf));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_ASF);
}

void AmbaItuner_Get_HisoChromaAsf(AMBA_DSP_IMG_CHROMA_ASF_INFO_s *HisoChromaAsf) {
    memcpy(HisoChromaAsf, &GData.HisoChromaAsf, sizeof(AMBA_DSP_IMG_CHROMA_ASF_INFO_s));
}


void AmbaItuner_Set_ChromaFilter(amba_img_dsp_chroma_filter_t *ChromaFilter) {
    memcpy(&GData.ChromaFilter, ChromaFilter, sizeof(GData.ChromaFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_FILTER);
}

void AmbaItuner_Get_ChromaFilter(amba_img_dsp_chroma_filter_t *ChromaFilter) {
    memcpy(ChromaFilter, &GData.ChromaFilter, sizeof(amba_img_dsp_chroma_filter_t));
}

void AmbaItuner_Set_WideChromaFilter(amba_img_dsp_chroma_filter_t *WideChromaFilter) {
    memcpy(&GData.WideChromaFilter, WideChromaFilter, sizeof(GData.WideChromaFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_WIDE_CHROMA_FILTER);
}

void AmbaItuner_Get_WideChromaFilter(amba_img_dsp_chroma_filter_t *WideChromaFilter) {
    memcpy(WideChromaFilter, &GData.WideChromaFilter, sizeof(amba_img_dsp_chroma_filter_t));
}

void AmbaItuner_Set_WideChromaFilterCombine(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s *WideChromaFilterCombine) {
    memcpy(&GData.WideChromaFilterCombine, WideChromaFilterCombine, sizeof(GData.WideChromaFilterCombine));
    _AmbaItuner_Set_Filter_Valid(ITUNER_WIDE_CHROMA_FILTER_COMBINE);
}

void AmbaItuner_Get_WideChromaFilterCombine(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s *WideChromaFilterCombine) {
    memcpy(WideChromaFilterCombine, &GData.WideChromaFilterCombine, sizeof(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s));
}

void AmbaItuner_Set_HisoChromaFilterHigh(amba_img_dsp_chroma_filter_t *HisoChromaFilterHigh) {
    memcpy(&GData.HisoChromaFilterHigh, HisoChromaFilterHigh, sizeof(GData.HisoChromaFilterHigh));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_HIGH);
}

void AmbaItuner_Get_HisoChromaFilterHigh(amba_img_dsp_chroma_filter_t *HisoChromaFilterHigh) {
    memcpy(HisoChromaFilterHigh, &GData.HisoChromaFilterHigh, sizeof(amba_img_dsp_chroma_filter_t));
}

void AmbaItuner_Set_GbGrMismatch(amba_img_dsp_gbgr_mismatch_t *GbGrMismatch) {
    memcpy(&GData.GbGrMismatch, GbGrMismatch, sizeof(GData.GbGrMismatch));
    _AmbaItuner_Set_Filter_Valid(ITUNER_GB_GR_MISMATCH);
}

void AmbaItuner_Get_GbGrMismatch(amba_img_dsp_gbgr_mismatch_t *GbGrMismatch) {
    memcpy(GbGrMismatch, &GData.GbGrMismatch, sizeof(amba_img_dsp_gbgr_mismatch_t));
}

void AmbaItuner_Set_HisoGbGrMismatch(amba_img_dsp_gbgr_mismatch_t *HisoGbGrMismatch) {
    memcpy(&GData.HisoGbGrMismatch, HisoGbGrMismatch, sizeof(GData.HisoGbGrMismatch));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_GB_GR_MISMATCH);
}

void AmbaItuner_Get_HisoGbGrMismatch(amba_img_dsp_gbgr_mismatch_t *HisoGbGrMismatch) {
    memcpy(HisoGbGrMismatch, &GData.HisoGbGrMismatch, sizeof(amba_img_dsp_gbgr_mismatch_t));
}

void AmbaItuner_Set_ChromaAberrationInfo(ITUNER_CHROMA_ABERRATION_s *ChromaAberrationInfo) {
    memcpy(&GData.ChromaAberrationInfo, ChromaAberrationInfo, sizeof(GData.ChromaAberrationInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_ABERRATION_INFO);
}

void AmbaItuner_Get_ChromaAberrationInfo(ITUNER_CHROMA_ABERRATION_s *ChromaAberrationInfo) {
    memcpy(ChromaAberrationInfo, &GData.ChromaAberrationInfo, sizeof(ITUNER_CHROMA_ABERRATION_s));
}

void AmbaItuner_Get_CACalcInfo(AMBA_DSP_IMG_CAWARP_CALC_INFO_s *CACalcInfo) {
    // Note: Only Get, without Set Api
    memcpy(CACalcInfo, &GData.CACalcInfo, sizeof(AMBA_DSP_IMG_CAWARP_CALC_INFO_s));
}
void AmbaItuner_Set_ChromaAberrationInfoByPass(ITUNER_CHROMA_ABERRATION_BYPASS_s *ChromaAberrationInfoByPass) {
    memcpy(&GData.ChromaAberrationInfoByPass, ChromaAberrationInfoByPass, sizeof(GData.ChromaAberrationInfoByPass));
    _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_ABERRATION_INFO_BY_PASS);
}

void AmbaItuner_Get_ChromaAberrationInfoByPass(ITUNER_CHROMA_ABERRATION_BYPASS_s *ChromaAberrationInfoByPass) {
    memcpy(ChromaAberrationInfoByPass, &GData.ChromaAberrationInfoByPass, sizeof(ITUNER_CHROMA_ABERRATION_BYPASS_s));
}

void AmbaItuner_Set_HisoChromaFilterLowVeryLow(AMBA_DSP_IMG_HISO_CHROMA_LOW_VERY_LOW_FILTER_s *HisoChromaFilterLowVeryLow) {
    memcpy(&GData.HisoChromaFilterLowVeryLow, HisoChromaFilterLowVeryLow, sizeof(GData.HisoChromaFilterLowVeryLow));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_LOW_VERY_LOW);
}

void AmbaItuner_Get_HisoChromaFilterLowVeryLow(AMBA_DSP_IMG_HISO_CHROMA_LOW_VERY_LOW_FILTER_s *HisoChromaFilterLowVeryLow) {
    memcpy(HisoChromaFilterLowVeryLow, &GData.HisoChromaFilterLowVeryLow, sizeof(AMBA_DSP_IMG_HISO_CHROMA_LOW_VERY_LOW_FILTER_s));
}

void AmbaItuner_Set_HisoChromaFilterPre(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s *HisoChromaFilterPre) {
    memcpy(&GData.HisoChromaFilterPre, HisoChromaFilterPre, sizeof(GData.HisoChromaFilterPre));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_PRE);
}

void AmbaItuner_Get_HisoChromaFilterPre(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s *HisoChromaFilterPre) {
    memcpy(HisoChromaFilterPre, &GData.HisoChromaFilterPre, sizeof(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s));
}

void AmbaItuner_Set_HisoChromaFilterMed(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s *HisoChromaFilterMed) {
    memcpy(&GData.HisoChromaFilterMed, HisoChromaFilterMed, sizeof(GData.HisoChromaFilterMed));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_MED);
}

void AmbaItuner_Get_HisoChromaFilterMed(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s *HisoChromaFilterMed) {
    memcpy(HisoChromaFilterMed, &GData.HisoChromaFilterMed, sizeof(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s));
}

void AmbaItuner_Set_HisoChromaFilterLow(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s *HisoChromaFilterLow) {
    memcpy(&GData.HisoChromaFilterLow, HisoChromaFilterLow, sizeof(GData.HisoChromaFilterLow));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_LOW);
}

void AmbaItuner_Get_HisoChromaFilterLow(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s *HisoChromaFilterLow) {
    memcpy(HisoChromaFilterLow, &GData.HisoChromaFilterLow, sizeof(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s));
}

void AmbaItuner_Set_HisoChromaFilterVeryLow(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s *HisoChromaFilterVeryLow) {
    memcpy(&GData.HisoChromaFilterVeryLow, HisoChromaFilterVeryLow, sizeof(GData.HisoChromaFilterVeryLow));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_VERY_LOW);
}

void AmbaItuner_Get_HisoChromaFilterVeryLow(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s *HisoChromaFilterVeryLow) {
    memcpy(HisoChromaFilterVeryLow, &GData.HisoChromaFilterVeryLow, sizeof(AMBA_DSP_IMG_HISO_CHROMA_FILTER_s));
}

void AmbaItuner_Set_HisoChromaFilterVeryLowCombine(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s *HisoChromaFilterVeryLowCombine) {
    memcpy(&GData.HisoChromaFilterVeryLowCombine, HisoChromaFilterVeryLowCombine, sizeof(GData.HisoChromaFilterVeryLowCombine));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_VERY_LOW_COMBINE);
}

void AmbaItuner_Get_HisoChromaFilterVeryLowCombine(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s *HisoChromaFilterVeryLowCombine) {
    memcpy(HisoChromaFilterVeryLowCombine, &GData.HisoChromaFilterVeryLowCombine, sizeof(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s));
}

void AmbaItuner_Set_HisoChromaFilterMedCombine(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s *HisoChromaFilterMedCombine) {
    memcpy(&GData.HisoChromaFilterMedCombine, HisoChromaFilterMedCombine, sizeof(GData.HisoChromaFilterMedCombine));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_MED_COMBINE);
}

void AmbaItuner_Get_HisoChromaFilterMedCombine(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s *HisoChromaFilterMedCombine) {
    memcpy(HisoChromaFilterMedCombine, &GData.HisoChromaFilterMedCombine, sizeof(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s));
}

void AmbaItuner_Set_HisoChromaFilterLowCombine(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s *HisoChromaFilterLowCombine) {
    memcpy(&GData.HisoChromaFilterLowCombine, HisoChromaFilterLowCombine, sizeof(GData.HisoChromaFilterLowCombine));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_LOW_COMBINE);
}

void AmbaItuner_Get_HisoChromaFilterLowCombine(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s *HisoChromaFilterLowCombine) {
    memcpy(HisoChromaFilterLowCombine, &GData.HisoChromaFilterLowCombine, sizeof(AMBA_DSP_IMG_HISO_CHROMA_FILTER_COMBINE_s));
}


void AmbaItuner_Set_HisoLumaNoiseCombine(AMBA_DSP_IMG_HISO_LUMA_FILTER_COMBINE_s *HisoLumaNoiseCombine) {
    memcpy(&GData.HisoLumaNoiseCombine, HisoLumaNoiseCombine, sizeof(GData.HisoLumaNoiseCombine));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LUMA_NOISE_COMBINE);
}

void AmbaItuner_Get_HisoLumaNoiseCombine(AMBA_DSP_IMG_HISO_LUMA_FILTER_COMBINE_s *HisoLumaNoiseCombine) {
    memcpy(HisoLumaNoiseCombine, &GData.HisoLumaNoiseCombine, sizeof(AMBA_DSP_IMG_HISO_LUMA_FILTER_COMBINE_s));
}

void AmbaItuner_Set_HisoLowASFCombine(AMBA_DSP_IMG_HISO_LUMA_FILTER_COMBINE_s *HisoLowASFCombine) {
    memcpy(&GData.HisoLowASFCombine, HisoLowASFCombine, sizeof(GData.HisoLowASFCombine));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LOW_ASF_COMBINE);
}
void AmbaItuner_Get_HisoLowASFCombine(AMBA_DSP_IMG_HISO_LUMA_FILTER_COMBINE_s *HisoLowASFCombine) {
    memcpy(HisoLowASFCombine, &GData.HisoLowASFCombine, sizeof(AMBA_DSP_IMG_HISO_LUMA_FILTER_COMBINE_s));
}

void AmbaItuner_Set_HisoFreqRecover(AMBA_DSP_IMG_HISO_FREQ_RECOVER_s *HisoFreqRecover) {
    memcpy(&GData.HisoFreqRecover, HisoFreqRecover, sizeof(GData.HisoFreqRecover));
    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_FREQ_RECOVER);
}

void AmbaItuner_Get_HisoFreqRecover(AMBA_DSP_IMG_HISO_FREQ_RECOVER_s *HisoFreqRecover) {
    memcpy(HisoFreqRecover, &GData.HisoFreqRecover, sizeof(AMBA_DSP_IMG_HISO_FREQ_RECOVER_s));
}

void AmbaItuner_Set_SensorInfo(amba_img_dsp_sensor_info_t *SensorInfo) {
    memcpy(&GData.SensorInfo, SensorInfo, sizeof(GData.SensorInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_SENSOR_INFO);
}

void AmbaItuner_Get_SensorInfo(amba_img_dsp_sensor_info_t *SensorInfo) {
    memcpy(SensorInfo, &GData.SensorInfo, sizeof(amba_img_dsp_sensor_info_t));
}

void AmbaItuner_Set_MoDynamicBadPixelCorrection(amba_img_dsp_dbp_correction_t *MoDynamicBadPixelCorrection) {
    memcpy(&GData.MoDynamicBadPixelCorrection, MoDynamicBadPixelCorrection, sizeof(GData.MoDynamicBadPixelCorrection));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_DYNAMIC_BAD_PIXEL_CORRECTION);
}

void AmbaItuner_Get_MoDynamicBadPixelCorrection(amba_img_dsp_dbp_correction_t *MoDynamicBadPixelCorrection) {
    memcpy(MoDynamicBadPixelCorrection, &GData.MoDynamicBadPixelCorrection, sizeof(amba_img_dsp_dbp_correction_t));
}

void AmbaItuner_Set_MoCfaLeakageFilter(amba_img_dsp_cfa_leakage_filter_t *MoCfaLeakageFilter) {
    memcpy(&GData.MoCfaLeakageFilter, MoCfaLeakageFilter, sizeof(GData.MoCfaLeakageFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_CFA_LEAKAGE_FILTER);
}

void AmbaItuner_Get_MoCfaLeakageFilter(amba_img_dsp_cfa_leakage_filter_t *MoCfaLeakageFilter) {
    memcpy(MoCfaLeakageFilter, &GData.MoCfaLeakageFilter, sizeof(amba_img_dsp_cfa_leakage_filter_t));
}

void AmbaItuner_Set_MoCfaNoiseFilter(amba_img_dsp_cfa_noise_filter_t *MoCfaNoiseFilter) {
    memcpy(&GData.MoCfaNoiseFilter, MoCfaNoiseFilter, sizeof(GData.MoCfaNoiseFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_CFA_NOISE_FILTER);
}

void AmbaItuner_Get_MoCfaNoiseFilter(amba_img_dsp_cfa_noise_filter_t *MoCfaNoiseFilter) {
    memcpy(MoCfaNoiseFilter, &GData.MoCfaNoiseFilter, sizeof(amba_img_dsp_cfa_noise_filter_t));
}

void AmbaItuner_Set_MoAntiAliasingStrength(amba_img_dsp_anti_aliasing_t *MoAntiAliasing) {
    memcpy(&GData.MoAntiAliasing, MoAntiAliasing, sizeof(amba_img_dsp_anti_aliasing_t));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_ANTI_ALIASING_STRENGTH);
}

void AmbaItuner_Get_MoAntiAliasingStrength(amba_img_dsp_anti_aliasing_t *MoAntiAliasing) {
    *MoAntiAliasing = GData.MoAntiAliasing;
}

void AmbaItuner_Set_MoDemosaicFilter(amba_img_dsp_demosaic_t *MoDemosaicFilter) {
    memcpy(&GData.MoDemosaicFilter, MoDemosaicFilter, sizeof(amba_img_dsp_demosaic_t));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_DEMOSAIC_FILTER);
}

void AmbaItuner_Get_MoDemosaicFilter(amba_img_dsp_demosaic_t *MoDemosaicFilter) {
    memcpy(MoDemosaicFilter, &GData.MoDemosaicFilter, sizeof(GData.MoDemosaicFilter));
}

void AmbaItuner_Set_MoGbGrMismatch(amba_img_dsp_gbgr_mismatch_t *MoGbGrMismatch) {
    memcpy(&GData.MoGbGrMismatch, MoGbGrMismatch, sizeof(GData.MoGbGrMismatch));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_GB_GR_MISMATCH);
}

void AmbaItuner_Get_MoGbGrMismatch(amba_img_dsp_gbgr_mismatch_t *MoGbGrMismatch) {
    memcpy(MoGbGrMismatch, &GData.MoGbGrMismatch, sizeof(amba_img_dsp_gbgr_mismatch_t));
}

void AmbaItuner_Set_MoShpAOrSpatialFilterSelect(amba_img_dsp_mo_process_select_t *MoProcessSelect) {
    memcpy(&GData.MoProcessSelect, MoProcessSelect, sizeof(amba_img_dsp_mo_process_select_t));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_SHP_A_OR_SPATIAL_FILTE_SELECT);
}

void AmbaItuner_Get_MoShpAOrSpatialFilterSelect(amba_img_dsp_mo_process_select_t *MoProcessSelect) {
    memcpy(MoProcessSelect, &GData.MoProcessSelect, sizeof(amba_img_dsp_mo_process_select_t));
}

void AmbaItuner_Set_MoAsfInfo(amba_img_dsp_asf_info_t *MoAsfInfo) {
    memcpy(&GData.MoAsfInfo, MoAsfInfo, sizeof(GData.MoAsfInfo));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_ASF_INFO);
}

void AmbaItuner_Get_MoAsfInfo(amba_img_dsp_asf_info_t *MoAsfInfo) {
    memcpy(MoAsfInfo, &GData.MoAsfInfo, sizeof(amba_img_dsp_asf_info_t));
}

void AmbaItuner_Set_MoChromaFilter(amba_img_dsp_chroma_filter_t *MoChromaFilter) {
    memcpy(&GData.MoChromaFilter, MoChromaFilter, sizeof(GData.MoChromaFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_CHROMA_FILTER);
}

void AmbaItuner_Get_MoChromaFilter(amba_img_dsp_chroma_filter_t *MoChromaFilter) {
    memcpy(MoChromaFilter, &GData.MoChromaFilter, sizeof(amba_img_dsp_chroma_filter_t));
}

void AmbaItuner_Set_MoChromaMedianFilter(amba_img_dsp_chroma_median_filter_t *MoChromaMedianFilter) {
    memcpy(&GData.MoChromaMedianFilter, MoChromaMedianFilter, sizeof(GData.MoChromaMedianFilter));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_CHROMA_MEDIAN_FILTER);
}

void AmbaItuner_Get_MoChromaMedianFilter(amba_img_dsp_chroma_median_filter_t *MoChromaMedianFilter) {
    memcpy(MoChromaMedianFilter, &GData.MoChromaMedianFilter, sizeof(amba_img_dsp_chroma_median_filter_t));
}

void AmbaItuner_Set_MoSharpenBoth(amba_img_dsp_sharpen_both_t *MoSharpenBoth) {
    memcpy(&GData.MoSharpenBoth, MoSharpenBoth, sizeof(GData.MoSharpenBoth));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_SHARPEN_BOTH);
}

void AmbaItuner_Get_MoSharpenBoth(amba_img_dsp_sharpen_both_t *MoSharpenBoth) {
    memcpy(MoSharpenBoth, &GData.MoSharpenBoth, sizeof(amba_img_dsp_sharpen_both_t));
}

void AmbaItuner_Set_MoSharpenNoise(amba_img_dsp_sharpen_noise_t *MoSharpenNoise) {
    memcpy(&GData.MoSharpenNoise, MoSharpenNoise, sizeof(GData.MoSharpenNoise));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_SHARPEN_NOISE);
}

void AmbaItuner_Get_MoSharpenNoise(amba_img_dsp_sharpen_noise_t *MoSharpenNoise) {
    memcpy(MoSharpenNoise, &GData.MoSharpenNoise, sizeof(amba_img_dsp_sharpen_noise_t));
}

void AmbaItuner_Set_MoFir(amba_img_dsp_fir_t *MoFir) {
    memcpy(&GData.MoFir, MoFir, sizeof(GData.MoFir));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_FIR);
}

void AmbaItuner_Get_MoFir(amba_img_dsp_fir_t *MoFir) {
    memcpy(MoFir, &GData.MoFir, sizeof(amba_img_dsp_fir_t));
}

void AmbaItuner_Set_MoCoring(amba_img_dsp_coring_t *MoCoring) {
    memcpy(&GData.MoCoring, MoCoring, sizeof(GData.MoCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_CORING);
}

void AmbaItuner_Get_MoCoring(amba_img_dsp_coring_t *MoCoring) {
    memcpy(MoCoring, &GData.MoCoring, sizeof(amba_img_dsp_coring_t));
}

void AmbaItuner_Set_MoCoringIndexScale(amba_img_dsp_level_t *MoCoringIndexScale) {
    memcpy(&GData.MoCoringIndexScale, MoCoringIndexScale, sizeof(GData.MoCoringIndexScale));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_CORING_INDEX_SCALE);
}

void AmbaItuner_Get_MoCoringIndexScale(amba_img_dsp_level_t *MoCoringIndexScale) {
    memcpy(MoCoringIndexScale, &GData.MoCoringIndexScale, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_MoMinCoringResult(amba_img_dsp_level_t *MoMinCoringResult) {
    memcpy(&GData.MoMinCoringResult, MoMinCoringResult, sizeof(GData.MoMinCoringResult));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_MIN_CORING_RESULT);
}

void AmbaItuner_Get_MoMinCoringResult(amba_img_dsp_level_t *MoMinCoringResult) {
    memcpy(MoMinCoringResult, &GData.MoMinCoringResult, sizeof(amba_img_dsp_level_t));
}

void AmbaItuner_Set_MoScaleCoring(amba_img_dsp_level_t *MoScaleCoring) {
    memcpy(&GData.MoScaleCoring, MoScaleCoring, sizeof(GData.MoScaleCoring));
    _AmbaItuner_Set_Filter_Valid(ITUNER_MO_SCALE_CORING);
}

void AmbaItuner_Get_MoScaleCoring(amba_img_dsp_level_t *MoScaleCoring) {
    memcpy(MoScaleCoring, &GData.MoScaleCoring, sizeof(amba_img_dsp_level_t));
}

static int _AmbaItuner_Check_Reg(ITUNER_VALID_s FILTER_ID, int Special_Use)
{
    int ret = 0;
    if (_Ituner_Valid_Filter[FILTER_ID] == 1) {
        ITUNER_DEBF("[Execute] %s", _G_Filter_Name[FILTER_ID]);
        ret = 1;
    } else if (_Ituner_Valid_Filter[FILTER_ID] == 0 && Special_Use == SPECIAL_USE_SKIP) {
        ITUNER_DEBF("[Skip] %s", _G_Filter_Name[FILTER_ID]);
    } else {
        ITUNER_DEBF("[Without] %s", _G_Filter_Name[FILTER_ID]);
    }
    return ret;
}
/*
static int _check_reg(REG_s *pReg, int *Rval, int SpecialUse)
{
    int i,tuning_mode=0;
    INT64 Mask=0;
    ITUNER_SYSTEM_s sys;

    if (pReg == 0)
        return 0;

    if (pReg->ParamCount < 0 || pReg->ParamCount > 63)
        Mask = -1;
    else
        Mask = ((INT64)1 << pReg->ParamCount) - 1;

    if (pReg->Valid == Mask) {
        AmbaPrint("[Execute] %s", pReg->Name);
        return 1;
    } else if (pReg->Valid == 0 && SpecialUse == SPECIAL_USE_SKIP) {
        // for optional register, most for statistic registers
        AmbaPrint("[Skip] %s", pReg->Name);
        return 0;
    } else if (((pReg->Valid & 0x1) == 1) && (strcmp(pReg->ParamList[0].Name, "enable") == 0) && SpecialUse == 0) {
        // if current reg set enable == 0, other param will be don't care
        AmbaPrint("[Disable] %s", pReg->Name);
        return 1;
    } else if (((pReg->Valid & 0x1) == 1) && (strcmp(pReg->ParamList[0].Name, "fir_strength") == 0) && SpecialUse != -1) {
        // if current fir not manual, and only fir_strength is set
        AmbaPrint("[Execute] %s", pReg->Name);
        return 1;
    }

    AmbaItuner_Get_SystemInfo(&sys);
    tuning_mode = lookup_tuning_mode(sys.TuningMode);
    if(tuning_mode == 6) //IMG_MODE_PREVIEW do not check valid value.
    {
        *Rval |= -1;
        return 0;
    }


    {
        for (i = 0; i < pReg->ParamCount; i++) {
            Mask = ((INT64)1 << i);
            if ((pReg->Valid & Mask) == 0)
                AmbaPrint("[Error] %s.%s not set!", pReg->Name, pReg->ParamList[i].Name);
        }
        *Rval |= -1;
        return 0;
    }
}
*/

// Refer to WarpCompensationDzoomByPassParams
#define WARP_COMPENSATION_WARP_CONTROL_BYPASS_INDEX 0
#define WARP_COMPENSATION_WARP_CONTROL_BYPASS_MASK 0x1
#define WARP_COMPENSATION_HORI_BYPASS_MASK 0x41F
        // 0x21F = 100 0001 1111 (2)
#define ERROR_FLAG_MASK_WARP_CONTROL_BYPASS_MASK 0x1

#define WARP_COMPENSATION_VERT_WARP_ENABLE_BYPASS_INDEX 5
#define WARP_COMPENSATION_VERT_WARP_ENABLE_BYPASS_MASK 0x20
        // 0x20 = 10 0000 (2)
#define WARP_COMPENSATION_VERT_BYPASS_MASK 0xBE0
        // 0x5E0 = 1101 1110 0000 (2)
#define ERROR_FLAG_MASK_VERT_WARP_ENABLE_BYPASS_MASK 0x2

#define WARP_COMPENSATION_DZOOM_BYPASS_MASK 0x7FFF000
        // 0x7FFF000 = 111 1111 1111 1111 0000 0000 0000 (2)
#define ERROR_FLAG_MASK_DZOOM_BYPASS_MASK 0x4


// Refer to ChromaAberrationByPassParams
#define CA_HORZ_WARP_ENABLE_BYPASS_INDEX 0
#define CA_HORZ_WARP_ENABLE_BYPASS_MASK 0x1
#define CA_HORZ_WARP_BYPASS_MASK 0x103D
        // 0x103D = 1 0000 0011 1101 (2)
#define ERROR_FLAG_MASK_CA_HORZ_WARP_BYPASS_MASK 0x1

#define CA_VERT_WARP_ENABLE_BYPASS_INDEX 1
#define CA_VERT_WARP_ENABLE_BYPASS_MASK 0x2
        // 0x2 =  10 (2)
#define CA_VERT_WARP_BYPASS_MASK 0x23C2
        // 0x23C2 = 10 0011 1100 0010 (2)
#define ERROR_FLAG_MASK_CA_VERT_WARP_BYPASS_MASK 0x2

#define CA_COMMON_BYPASS_MASK 0xC00
        // 0xC00 = 1100 0000 0000 (2)
#define ERROR_FLAG_MASK_CA_COMMON_BYPASS_MASK 0x4

#define SPECIAL_USE_GENERAL    1
// Note: SPECIAL_USE_GENERAL is used for bypass FPN and vignette function.

#define SPECIAL_USE_WARP_DZOOM 2
#define SPECIAL_USE_CAWARP     3

#define BYPASS_STATUS_SKIP    0
#define BYPASS_STATUS_EXECUTE 1
#define BYPASS_STATUS_DISABLE 2
#define BYPASS_STATUS_ERROR   3
// Using _bypass_check_reg to check regs about the bypass mode function
/*
static int _bypass_check_reg(REG_s *pReg, int *Rval, int SpecialUse, UINT32 *pParam)
{
    int i,tuning_mode = 0;
    INT64 Mask = 0;
    ITUNER_SYSTEM_s sys;

    if (pReg == 0) {
        return BYPASS_STATUS_ERROR;
    }

    if (pReg->ParamCount < 0 || pReg->ParamCount > 63) {
        Mask = -1;
    } else {
        Mask = ((INT64)1 << pReg->ParamCount) - 1;
    }

    AmbaItuner_Get_SystemInfo(&sys);
    tuning_mode = lookup_tuning_mode(sys.TuningMode);

    if (pReg->Valid == Mask) {
        AmbaPrint("[Execute] %s", pReg->Name);
        return BYPASS_STATUS_EXECUTE;
    } else if (pReg->Valid == 0) {
        // We assume that all the bypass mode functions allow skip (not exist).
        // for optional register, most for statistic registers
        AmbaPrint("[Skip] %s", pReg->Name);
        return BYPASS_STATUS_SKIP;
    } else if (((pReg->Valid & 0x1) == 1) && (strcmp(pReg->ParamList[0].Name, "enable") == 0) && SpecialUse == SPECIAL_USE_GENERAL) {

        // Case: SPECIAL_USE_GENERAL means bit 0 is the only one enable/disable control for the bypass function
        UINT8 ByPassGerenalEnable = (UINT8) *pParam;
        if (ByPassGerenalEnable == 0) {
            AmbaPrint("[Disable] %s", pReg->Name);
            return BYPASS_STATUS_DISABLE;
        }

    }  else if (SpecialUse == SPECIAL_USE_WARP_DZOOM) {
        // Special case for warp_compensation_bypass
        // We must check warp_control(hori_warp_enable) and vert_warp_enable

        UINT8 WarpCompensationBypassErrorFlag = 0;
        UINT8 ByPassWarpControl = (UINT8) *pParam;
        UINT8 ByPassVertWarpEnable = (UINT8) (*(pParam + 1));

        // warp_control part (hori_warp_enable)
        if ((pReg->Valid & WARP_COMPENSATION_WARP_CONTROL_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            // This branch means that warp control (hori_warp_enable) is set.
            if ((pReg->Valid & WARP_COMPENSATION_HORI_BYPASS_MASK) == WARP_COMPENSATION_HORI_BYPASS_MASK) {
                // This case means that all warp control fields are set.
                AmbaPrint("[Execute] warp_compensation_bypass horizontal part");
            } else {
                // This case means that warp control is set, but some fields are lost.
                // If warp control is 0, it means disable.
                // If warp control is not 0, it is an error case.
                if (ByPassWarpControl == 0) {
                    AmbaPrint("[Disable] warp_compensation_bypass horizontal part");
                } else {
                    AmbaPrint("[Param lost] warp_compensation_bypass horizontal part");
                    WarpCompensationBypassErrorFlag |= ERROR_FLAG_MASK_WARP_CONTROL_BYPASS_MASK;
                }
            }
        } else {
            AmbaPrint("[Param lost] warp_compensation_bypass horizontal part");
            WarpCompensationBypassErrorFlag |= ERROR_FLAG_MASK_WARP_CONTROL_BYPASS_MASK;
        }

        // warp_control part (hori_warp_enable) error handling
        if ((WarpCompensationBypassErrorFlag & ERROR_FLAG_MASK_WARP_CONTROL_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            if(tuning_mode != 6) { //Except IMG_MODE_PREVIEW, checking valid value.

                for (i = 0; i < pReg->ParamCount; i++) {
                    Mask = ((INT64)1 << i);
                    if ((pReg->Valid & Mask) == 0 && (Mask & WARP_COMPENSATION_HORI_BYPASS_MASK) != 0) {
                        AmbaPrint("[Error] %s.%s not set!", pReg->Name, pReg->ParamList[i].Name);
                    }
                }
            }
        }

        // vert_warp_enable part
        if ((pReg->Valid & WARP_COMPENSATION_VERT_WARP_ENABLE_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            // This branch means that vert_warp_enable is set.
            if ((pReg->Valid & WARP_COMPENSATION_VERT_BYPASS_MASK) == WARP_COMPENSATION_VERT_BYPASS_MASK) {
                // This case means that all vert_warp_enable are set.
                AmbaPrint("[Execute] warp_compensation_bypass vertical part");
            } else {
                // This case means that vert_warp_enable is set, but some fields are lost.
                // If vert_warp_enable is 0, it means disable.
                // If vert_warp_enable is not 0, it is an error case.
                if (ByPassVertWarpEnable == 0) {
                    AmbaPrint("[Disable] warp_compensation_bypass vertical part");
                } else {
                    AmbaPrint("[Param lost] warp_compensation_bypass vertical part");
                    WarpCompensationBypassErrorFlag |= ERROR_FLAG_MASK_VERT_WARP_ENABLE_BYPASS_MASK;
                }
            }
        } else {
            AmbaPrint("[Param lost] warp_compensation_bypass vertical part");
            WarpCompensationBypassErrorFlag |= ERROR_FLAG_MASK_VERT_WARP_ENABLE_BYPASS_MASK;
        }

        // vert_warp_enable part error handling
        if ((WarpCompensationBypassErrorFlag & ERROR_FLAG_MASK_VERT_WARP_ENABLE_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            if(tuning_mode != 6) { //Except IMG_MODE_PREVIEW, checking valid value.

                for (i = 0; i < pReg->ParamCount; i++) {
                    Mask = ((INT64)1 << i);
                    if ((pReg->Valid & Mask) == 0 && (Mask & WARP_COMPENSATION_VERT_BYPASS_MASK) != 0) {
                        AmbaPrint("[Error] %s.%s not set!", pReg->Name, pReg->ParamList[i].Name);
                    }
                }
            }
        }

        // dzoom part, all the param shall be set.
        if ((pReg->Valid & WARP_COMPENSATION_DZOOM_BYPASS_MASK) == WARP_COMPENSATION_DZOOM_BYPASS_MASK) {
            AmbaPrint("[Execute] warp_compensation_bypass dzoom part");
        } else {
            AmbaPrint("[Param lost] warp_compensation_bypass dzoom part");
            WarpCompensationBypassErrorFlag |= ERROR_FLAG_MASK_DZOOM_BYPASS_MASK;
        }

        // dzoom part error handling
        if ((WarpCompensationBypassErrorFlag & ERROR_FLAG_MASK_DZOOM_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            if(tuning_mode != 6) { //Except IMG_MODE_PREVIEW, checking valid value.
                for (i = 0; i < pReg->ParamCount; i++) {
                    Mask = ((INT64)1 << i);
                    if ( ((pReg->Valid & Mask) == 0) && ((Mask & WARP_COMPENSATION_DZOOM_BYPASS_MASK) != 0)) {
                        // Caution: operator prioiry, != is higher than &
                        AmbaPrint("[Error] %s.%s not set!", pReg->Name, pReg->ParamList[i].Name);
                    }
                }
            }
        }

        // After checking warp_control part, vert_warp_enable part and dzoom part, judge that it's executable or not.
        if (WarpCompensationBypassErrorFlag == 0) {
            AmbaPrint("[Execute] %s", pReg->Name);
            return BYPASS_STATUS_EXECUTE;
        } else {
            *Rval |= -1;
            return BYPASS_STATUS_ERROR;
        }

    } else if (SpecialUse == SPECIAL_USE_CAWARP) {
        // strcmp(pReg->Name, "chromatic_aberration_correction_bypass") == 0
        // Special case forchromatic_aberration_correction_bypass

        UINT8  CaWarpBypassErrorFlag = 0;
        UINT16 ByPassHorzCaWarpEnable = (UINT16) *pParam;
        UINT16 ByPassVertCaWarpEnable = (UINT16) (*(pParam + 1));

        // Horizontal part
        if ((pReg->Valid & CA_HORZ_WARP_ENABLE_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            // This branch means that horz_warp_enable is set. horz_warp_enable is the field name of CaWarp in A7L.
            if ((pReg->Valid & CA_HORZ_WARP_BYPASS_MASK) == CA_HORZ_WARP_BYPASS_MASK) {
                // This case means that all fields in horizontal part are set.
                AmbaPrint("[Execute] chromatic_aberration_correction_bypass horizontal part");
            } else {
                // This case means that ByPassHorzCaWarpEnable (horz_warp_enable) is set, but some fields are lost.
                // If ByPassHorzCaWarpEnable (horz_warp_enable) is 0, it means disable.
                // If ByPassHorzCaWarpEnable (horz_warp_enable) is not 0, it is an error case.
                if (ByPassHorzCaWarpEnable == 0) {
                    AmbaPrint("[Disable] chromatic_aberration_correction_bypass horizontal part");
                } else {
                    AmbaPrint("[Param lost] chromatic_aberration_correction_bypass horizontal part");
                    CaWarpBypassErrorFlag |= ERROR_FLAG_MASK_CA_HORZ_WARP_BYPASS_MASK;
                }
            }
        } else {
            AmbaPrint("[Param lost] chromatic_aberration_correction_bypass horizontal part");
            CaWarpBypassErrorFlag |= ERROR_FLAG_MASK_CA_HORZ_WARP_BYPASS_MASK;
        }

        // Horizontal part error handling
        if ((CaWarpBypassErrorFlag & ERROR_FLAG_MASK_CA_HORZ_WARP_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            if(tuning_mode != 6) { //Except IMG_MODE_PREVIEW, checking valid value.

                for (i = 0; i < pReg->ParamCount; i++) {
                    Mask = ((INT64)1 << i);
                    if ((pReg->Valid & Mask) == 0 && (Mask & CA_HORZ_WARP_BYPASS_MASK) != 0) {
                        AmbaPrint("[Error] %s.%s not set!", pReg->Name, pReg->ParamList[i].Name);
                    }
                }
            }
        }

        // Vertical part
        if ((pReg->Valid & CA_VERT_WARP_ENABLE_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            // This branch means that vert_warp_enable is set. vert_warp_enable is the field name of CaWarp in A7L.
            if ((pReg->Valid & CA_VERT_WARP_BYPASS_MASK) == CA_VERT_WARP_BYPASS_MASK) {
                // This case means that all fields in vertical part are set.
                AmbaPrint("[Execute] chromatic_aberration_correction_bypass vertical part");
            } else {
                // This case means that ByPassVertCaWarpEnable (vert_warp_enable) is set, but some fields are lost.
                // If ByPassVertCaWarpEnable (vert_warp_enable) is 0, it means disable.
                // If ByPassVertCaWarpEnable (vert_warp_enable) is not 0, it is an error case.
                if (ByPassVertCaWarpEnable == 0) {
                    AmbaPrint("[Disable] chromatic_aberration_correction_bypass vertical part");
                } else {
                    AmbaPrint("[Param lost] chromatic_aberration_correction_bypass vertical part");
                    CaWarpBypassErrorFlag |= ERROR_FLAG_MASK_CA_VERT_WARP_BYPASS_MASK;
                }
            }
        } else {
            AmbaPrint("[Param lost] chromatic_aberration_correction_bypass vertical part");
            CaWarpBypassErrorFlag |= ERROR_FLAG_MASK_CA_VERT_WARP_BYPASS_MASK;
        }

        // Vertical part error handling
        if ((CaWarpBypassErrorFlag & ERROR_FLAG_MASK_CA_VERT_WARP_BYPASS_MASK) != 0) {
            // Caution: operator prioiry, != is higher than &
            if(tuning_mode != 6) { //Except IMG_MODE_PREVIEW, checking valid value.

                for (i = 0; i < pReg->ParamCount; i++) {
                    Mask = ((INT64)1 << i);
                    if ((pReg->Valid & Mask) == 0 && (Mask & CA_VERT_WARP_BYPASS_MASK) != 0) {
                        AmbaPrint("[Error] %s.%s not set!", pReg->Name, pReg->ParamList[i].Name);
                    }
                }
            }
        }

        // Check common part, anyone of CaWarp is enable, we must check.
        if ((ByPassHorzCaWarpEnable != 0) || (ByPassVertCaWarpEnable != 0)) {

            if ((pReg->Valid & CA_COMMON_BYPASS_MASK) == CA_COMMON_BYPASS_MASK) {
                AmbaPrint("[Execute] chromatic_aberration_correction_bypass common part");
                AmbaPrint("[Execute] %s", pReg->Name);
            } else {
                AmbaPrint("[Param lost] chromatic_aberration_correction_bypass common part");
                CaWarpBypassErrorFlag |= ERROR_FLAG_MASK_CA_COMMON_BYPASS_MASK;
            }

            // common part error handling
            if ((CaWarpBypassErrorFlag & ERROR_FLAG_MASK_CA_COMMON_BYPASS_MASK) != 0) {
                // Caution: operator prioiry, != is higher than &
                if(tuning_mode != 6) { //Except IMG_MODE_PREVIEW, checking valid value.
                    for (i = 0; i < pReg->ParamCount; i++) {
                        Mask = ((INT64)1 << i);
                        if ( ((pReg->Valid & Mask) == 0) && ((Mask & CA_COMMON_BYPASS_MASK) != 0)) {
                            // Caution: operator prioiry, != is higher than &
                            AmbaPrint("[Error] %s.%s not set!", pReg->Name, pReg->ParamList[i].Name);
                        }
                    }
                }
            }
        } else if ((ByPassHorzCaWarpEnable == 0) && (ByPassVertCaWarpEnable == 0)) {
            AmbaPrint("[Disable] chromatic_aberration_correction_bypass");
        }

        // After checking horizontal part, vertical part and common part, judge that it's executable or not.
        if (CaWarpBypassErrorFlag == 0) {
            return BYPASS_STATUS_EXECUTE;
        } else {
            *Rval |= -1;
            return BYPASS_STATUS_ERROR;
        }

    }


    if(tuning_mode == 6) //IMG_MODE_PREVIEW do not check valid value.
    {
        *Rval |= -1;
        return BYPASS_STATUS_ERROR;
    }

    {
        for (i = 0; i < pReg->ParamCount; i++) {
            Mask = ((INT64)1 << i);
            if ((pReg->Valid & Mask) == 0)
                AmbaPrint("[Error] %s.%s not set!", pReg->Name, pReg->ParamList[i].Name);
        }
        *Rval |= -1;
        return BYPASS_STATUS_ERROR;
    }
}
*/
//===============image algo======================//
#define WB_DGAIN_UNIT           4096


/* //TBD
static int _load_vignette_file(const char *filename, idsp_vignette_info_t *vig_info)
{
    AMBA_FS_FILE *fid;
    char uni_fname[64];
    char f_mode[3] = {'r','\0'};
    int size = 33*33*sizeof(UINT16);
    int rval = -1;
    asc_to_uni(filename, uni_fname);
    fid = AmbaFS_fopen(uni_fname, f_mode);
    do {
        if (fid == 0) {
            AmbaPrint("[Error] Vignette file open fails!");
            rval = -1;
            break;
        }
        if (AmbaFS_fread((void*)vig_info->vignette_red_gain_addr, size, 1, fid) != 1) {
            AmbaPrint("[Error] Vignette file read error!");
            rval = -1;
            break;
        }
        if (AmbaFS_fread((void*)vig_info->vignette_green_even_gain_addr, size, 1, fid) != 1) {
            AmbaPrint("[Error] Vignette file read error!");
            rval = -1;
            break;
        }
        if (AmbaFS_fread((void*)vig_info->vignette_green_odd_gain_addr, size, 1, fid) != 1) {
            AmbaPrint("[Error] Vignette file read error!");
            rval = -1;
            break;
        }
        if (AmbaFS_fread((void*)vig_info->vignette_blue_gain_addr, size, 1, fid) != 1) {
            AmbaPrint("[Error] Vignette file read error!");
            rval = -1;
            break;
        }
        rval = 0;
    } while (0);
    AmbaFS_fclose(fid);
    return 0;
}

static int _save_vignette_file(const char *filename, idsp_vignette_info_t *vig_info)
{
    AMBA_FS_FILE *fid;
    char uni_fname[64];
    char f_mode[3] = {'w','\0'};
    int size = 33*33*sizeof(UINT16);
    int rval = -1;
    asc_to_uni(filename, uni_fname);
    fid = AmbaFS_fopen(uni_fname, f_mode);
    do {
        if (fid == 0) {
            AmbaPrint("[Error] Vignette file open fails!");
            rval = -1;
            break;
        }
        if (AmbaFS_fwrite(vig_info->vignette_red_gain_addr, size, 1, fid) != 1) {
            AmbaPrint("[Error] Vignette file write error!");
            rval = -1;
            break;
        }
        if (AmbaFS_fwrite(vig_info->vignette_green_even_gain_addr, size, 1, fid) != 1) {
            AmbaPrint("[Error] Vignette file write error!");
            rval = -1;
            break;
        }
        if (AmbaFS_fwrite(vig_info->vignette_green_odd_gain_addr, size, 1, fid) != 1) {
            AmbaPrint("[Error] Vignette file write error!");
            rval = -1;
            break;
        }
        if (AmbaFS_fwrite(vig_info->vignette_blue_gain_addr, size, 1, fid) != 1) {
            AmbaPrint("[Error] Vignette file write error!");
            rval = -1;
            break;
        }
        rval = 0;
    } while (0);
    AmbaFS_fclose(fid);
    return rval;
}
*/
/*
static int _get_file_size(char *FileName)
{

    AMBA_FS_STAT TmpStat;

    if (AmbaFS_Stat(FileName, &TmpStat) == OK) {
        return TmpStat.Size;
    } else {
        AmbaPrint("[Error] _get_file_size failed!");
        return -1;
    }
}
*/
/*
static int _load_ext_file(char *FileName, int Size, void *Buf)
{
    AMBA_FS_FILE *Fid;
    char UniFname[64];
    char Fmode[5] = {'r','\0'};

    check_ituner_system_drive(FileName);
    asc_to_uni(FileName, UniFname);
    Fid = AmbaFS_fopen(UniFname, Fmode);
    if (Fid == 0) {
        AmbaPrint("[Error] Ext file open fails! %s", FileName);
        return -1;
    }
    if (AmbaFS_fread(Buf, Size, 1, Fid)) {
        AmbaFS_fclose(Fid);
        return 0;
    } else {
        AmbaPrint("[Error] Ext file read error!");
        AmbaFS_fclose(Fid);
        return -2;
    }
}
*/
/*
static int _save_ext_file(const char *FileName, int Size, void *Buf)
{
    AMBA_FS_FILE *Fid;
    char UniFname[64];
    char Fmode[5] = {'w','\0'};
    asc_to_uni(FileName, UniFname);
    Fid = AmbaFS_fopen(UniFname, Fmode);
    if (Fid == 0) {
        AmbaPrint("[Error] Ext file open fails!");
        return -1;
    }
    if (AmbaFS_fwrite(Buf, Size, 1, Fid)) {
        AmbaFS_fclose(Fid);
        return 0;
    } else {
        AmbaPrint("[Error] Ext file write error!");
        AmbaFS_fclose(Fid);
        return -1;
    }
}
*/
/*
static void _build_ext_file_name(const char *Src, char *Dst, char *PostFix, char *Ext)
{
    char Buf[64];//, *Token;
    strcpy(Buf, Src);
    //Token = strtok(Buf, ".");
    strcat(Buf, PostFix);
    strcat(Buf, Ext);
    strcpy(Dst, Buf);
}
*/
/*
int ituner_build_header(const char *raw_path, const char *cfg_path, postproc_info_t *info)
{
    int mode = _Ituner.tuning_mode;
    vin_status_t vin_status={0};
    postproc_info_t _info;

    _set_reglist_valid(1);
    //AMP_img_sensor_cmd(MW_IMG_GET_VIDEO_INPUT_STATUS, &vin_status, 0);  //TBD

    // A7 does not support FAST MODE, it will use LOW ISO instead
    // so if system try to dump FAST MODE config, dump LOW ISO instead
    if (mode == IMG_MODE_STILL)
        mode = IMG_MODE_LOW_ISO_STILL;

    strcpy(_System.AmbacamRev, "2.2.0");
    strcpy(_System.ChipRev, "A9");
    strcpy(_System.SensorId, "MT9J001_ID");
    strcpy(_System.UserMode, "Normal");
    strcpy(_System.TuningMode, _str_tuning_mode[mode]);
    strcpy(_System.TuningModeExt, _str_tuning_mode_ext[_Ituner.tuning_mode_ext]);
    strcpy(_System.RawPath, raw_path);
    if (_Ituner.tuning_mode_ext != SINGLE_SHOT) {
        char ext_file_path[64];
        _System.RawPath[0] = '\0';
        strcpy(ext_file_path, cfg_path);
        strtok(ext_file_path, ".");
        strcat(ext_file_path, "_ext_cfg.txt");
        strcpy(_System.ExtConfigPath, ext_file_path);
    } else {
        _System.ExtConfigPath[0] = '\0';
    }
    if (info == NULL) {
        if (_is_video_mode(mode)) {
            _info.src_raw_width = vin_status.vidcap_w;
            _info.src_raw_height = vin_status.vidcap_h;
            //raw_pitch should be 32-bytes aligment
            _info.src_raw_pitch = ((_info.src_raw_width+15)>>4)<<5;
            _info.src_y_width = _info.src_raw_width;
            _info.src_y_height = _info.src_raw_height;
        } else {
            _info.src_raw_width = vin_status.stillcap_w;
            _info.src_raw_height = vin_status.stillcap_h;
            //raw_pitch should be 32-bytes aligment
            _info.src_raw_pitch = ((_info.src_raw_width+15)>>4)<<5;
            _info.src_y_width = _info.src_raw_width;
            _info.src_y_height = _info.src_raw_height;
        }
    } else {
        _info = *info;
    }
    _System.RawWidth = _info.src_raw_width;
    _System.RawHeight = _info.src_raw_height;
    _System.RawPitch = _info.src_raw_pitch;
    _System.MainWidth = _info.src_y_width;
    _System.MainHeight = _info.src_y_height;
    _System.RawResolution = 14;//vin_status.bit_resolution;
    _System.RawBayer = vin_status.bayer_pattern;
    _System.InputPicCnt = 1;
    _System.SensorReadoutMode = vin_status.sensor_readout_mode;
    if (_Ituner.tuning_mode_ext == MULTI_SHOT_MF_HISO) {
        _System.InputPicCnt = 6;
        _System.RawHeight = ((_info.src_raw_height+15)>>4)<<4;
    } else if (_Ituner.tuning_mode_ext == MULTI_SHOT_MAHDR) {
        _System.InputPicCnt = 4;
    }

    if ( _System.RawPitch < 2 * _System.RawWidth) {
        _System.CompressedRaw = 1;
    } else {
        _System.CompressedRaw = 0;
    }

    if ((_System.RawPitch != 2 * _System.RawWidth) && (_System.CompressedRaw != 1)) {
        int pitch = (((_System.RawWidth) * 2 + 31) >> 5) << 5;
        AmbaPrint("Warning: DSP returned pitch value is wrong %d (DSP report) vs %d", info->src_raw_pitch, pitch);
    }

    if (_Ituner.tuning_mode == 4) {
        _System.RawPath[0] = '\0';
        _System.RawPitch = _System.RawWidth;
        _System.CompressedRaw = 0;
    }
    //NOTE: internal REG will not be exposed
    return 0;
}
*/


/* iTuner external API */
int AmbaItuner_Init(AmbaItuner_Config_t *Config)
{
    memcpy(&Ituner_Hook_Func, &Config->Hook_Func, sizeof(Ituner_Hook_Func));
    _AmbaItuner_Internal_Init();
    _AmbaItuner_System_Init();
    _AmbaItuner_GData_Init();
    return 0;
}

int AmbaItuner_Execute(int fd_iav, amba_img_dsp_mode_cfg_t Mode, AMBA_ITUNER_PROC_INFO_s *ProcInfo)
{
    ITUNER_DEBF("%s() %d, Execute", __func__, __LINE__);
    if (!_AmbaItuner_Is_Video_Preview_Tuning()) {
        if (_AmbaItuner_Check_Filter(Mode) != 0) {
            ITUNER_WARF("%s() %d, call _AmbaItuner_Check_Filter() Fail\n", __func__, __LINE__);
            return -1;
        }
    }

    int Ret = 0;
    Ituner_Ext_File_Param_s Ext_File_Param;
    UINT32 RawWidth;
    UINT32 RawHeight;
    UINT32 MainWidth;
    UINT32 MainHeight;
    UINT32 RawStartX;
    UINT32 RawStartY;
    UINT8 HSubSampleFactorNum, HSubSampleFactorDen, VSubSampleFactorNum, VSubSampleFactorDen;
    amba_img_dsp_size_info_t SizeInfo;
    do {
        amba_img_img_set_diag_case_id(&Mode, _Internal.DiagMode);
        if (0/*Mode.Pipe == AMBA_DSP_IMG_PIPE_VIDEO*/) {
//            IMG_IDSP_CONFIG_INFO_s IMG_IDSP_CONFIG_INFO;
//            extern int AmbaDSP_GetIdspCfgInfo(void *pCfgInfo);
            RawStartX = 0;
            RawStartY = 0;
            HSubSampleFactorNum = 1;
            HSubSampleFactorDen = 1;
            VSubSampleFactorNum = 1;
            VSubSampleFactorDen = 1;
//            AmbaDSP_GetIdspCfgInfo((void*)&IMG_IDSP_CONFIG_INFO);
            RawWidth  = 1920;//IMG_IDSP_CONFIG_INFO.VCapWin.Width;
            RawHeight = 1080;//IMG_IDSP_CONFIG_INFO.VCapWin.Height;
            MainWidth  = 1920;//IMG_IDSP_CONFIG_INFO.EncWin.Width;
            MainHeight = 1080;//IMG_IDSP_CONFIG_INFO.EncWin.Height;
        } else {
            RawStartX = _System.RawStartX;
            RawStartY = _System.RawStartY;
            HSubSampleFactorNum = _System.HSubSampleFactorNum;
            HSubSampleFactorDen = _System.HSubSampleFactorDen;
            VSubSampleFactorNum = _System.VSubSampleFactorNum;
            VSubSampleFactorDen = _System.VSubSampleFactorDen;
            RawWidth = _System.RawWidth;
            RawHeight = _System.RawHeight;
            MainWidth = _System.MainWidth;
            MainHeight = _System.MainHeight;
        }
        ITUNER_DEBF("%s() %d Ituner RawWidth = %d RawHeight = %d MainWidth = %d MainHeight = %d", __func__, __LINE__, RawWidth,RawHeight,MainWidth,MainHeight);

        SizeInfo.WidthIn = RawWidth;
        SizeInfo.HeightIn= RawHeight;
        SizeInfo.WidthMain= MainWidth;
        SizeInfo.HeightMain= MainHeight;
        CHECK_RET(0, amba_img_dsp_set_size_info(&Mode, &SizeInfo));
        {
            extern int amba_img_dsp_set_static_bad_pixel_correction_highlight_mode( amba_img_dsp_mode_cfg_t *Mode, UINT8 *pSbpHighligh);
            if (_Internal.FpnHighlight != -1) {
                UINT8 FpnHighlight = (UINT8)_Internal.FpnHighlight;
                CHECK_RET(0,  amba_img_dsp_set_static_bad_pixel_correction_highlight_mode(&Mode, &FpnHighlight));
            }
        }
/*        if (_AmbaItuner_Check_Reg(ITUNER_AE_STATISTICS_INFO, SPECIAL_USE_SKIP)) {
            CHECK_RET(0, AmbaDSP_Img3aSetAeStatInfo(&Mode, &GData.AeStatisticsInfo));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_AWB_STATISTICS_INFO, SPECIAL_USE_SKIP)) {
            CHECK_RET(0,  AmbaDSP_Img3aSetAwbStatInfo(&Mode, &GData.AwbStatisticsInfo));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_AF_STATISTICS_INFO, SPECIAL_USE_SKIP)) {
            CHECK_RET(0,  AmbaDSP_Img3aSetAfStatInfo(&Mode, &GData.AfStatisticsInfo));
        }
*/
        //if (Mode.Pipe != AMBA_DSP_IMG_PIPE_VIDEO) {
            memset(&GData.SensorInfo, 0x0, sizeof(amba_img_dsp_sensor_info_t));
            CHECK_RET(0,  amba_img_dsp_get_vin_sensor_info(&Mode, &GData.SensorInfo));
            //temp for now
            GData.SensorInfo.SensorID = 0;
            GData.SensorInfo.NumFieldsPerFormat = 1;
            GData.SensorInfo.SensorResolution = _System.RawResolution;
            GData.SensorInfo.SensorPattern = _System.RawBayer;
            GData.SensorInfo.SensorReadOutMode = _System.SensorReadoutMode;
            if (_AmbaItuner_Check_Reg(ITUNER_SENSOR_INFO, SPECIAL_USE_SKIP)) {
                GData.SensorInfo.SensorReadOutMode = GData.SensorInputInfo.ReadoutMode;
            }
            CHECK_RET(0,  amba_img_dsp_set_vin_sensor_info(&Mode, &GData.SensorInfo));
        //}
        if (_AmbaItuner_Check_Reg(ITUNER_STATIC_BAD_PIXEL_CORRECTION_BY_PASS, SPECIAL_USE_NONE)) {
            if (GData.StaticBadPixelCorrectionByPass.Enable) {
                GData.SbpCorrByPass.Enable = GData.StaticBadPixelCorrectionByPass.Enable;
                GData.SbpCorrByPass.PixelMapWidth = GData.StaticBadPixelCorrectionByPass.PixelMapWidth;
                GData.SbpCorrByPass.PixelMapHeight = GData.StaticBadPixelCorrectionByPass.PixelMapHeight;
                GData.SbpCorrByPass.PixelMapPitch = GData.StaticBadPixelCorrectionByPass.PixelMapPitch;
                {
                    memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                    Ext_File_Param.Bypass_FPN_MAP_Ext_Load_Param.Address = FPNMap;
                    Ext_File_Param.Bypass_FPN_MAP_Ext_Load_Param.Size = ITUNER_CAL_BYPASS_FPN_MAP_SIZE(GData.StaticBadPixelCorrectionByPass.PixelMapPitch, GData.StaticBadPixelCorrectionByPass.PixelMapHeight);
                    if (Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_FPN_MAP, &Ext_File_Param) < 0) {
                        ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_FPN_MAP) Fail", __func__, __LINE__);
                    }
                }
                GData.SbpCorrByPass.pMap = FPNMap;
            } else {
                GData.SbpCorrByPass.Enable = 0;
            }
            extern int amba_img_dsp_set_static_bad_pixel_correction_bypass(int fd_iav, amba_img_dsp_mode_cfg_t *Mode,AMBA_DSP_IMG_BYPASS_SBP_INFO_s *pSbpCorrByPass);
            CHECK_RET(0,  amba_img_dsp_set_static_bad_pixel_correction_bypass(fd_iav, &Mode, &GData.SbpCorrByPass));

        } else {
            if (_AmbaItuner_Check_Reg(ITUNER_STATIC_BAD_PIXEL_CORRECTION, GData.StaticBadPixelCorrection.Enable)) {
                if (GData.StaticBadPixelCorrection.Enable) {
                    GData.SbpCorr.CurrentVinSensorGeo.StartX = _System.RawStartX;
                    GData.SbpCorr.CurrentVinSensorGeo.StartY = _System.RawStartY;
                    GData.SbpCorr.CurrentVinSensorGeo.HSubSample.FactorNum = _System.HSubSampleFactorNum;
                    GData.SbpCorr.CurrentVinSensorGeo.HSubSample.FactorDen = _System.HSubSampleFactorDen;
                    GData.SbpCorr.CurrentVinSensorGeo.VSubSample.FactorNum = _System.VSubSampleFactorNum;
                    GData.SbpCorr.CurrentVinSensorGeo.VSubSample.FactorDen = _System.VSubSampleFactorDen;
                    GData.SbpCorr.CurrentVinSensorGeo.Width = _System.RawWidth;
                    GData.SbpCorr.CurrentVinSensorGeo.Height = _System.RawHeight;
                    GData.SbpCorr.Enb = GData.StaticBadPixelCorrection.Enable;
                    GData.SbpCorr.CalibSbpInfo.Version = GData.StaticBadPixelCorrection.CalibVersion;
                    GData.SbpCorr.CalibSbpInfo.VinSensorGeo.StartX = GData.StaticBadPixelCorrection.CailbVinStartX;
                    GData.SbpCorr.CalibSbpInfo.VinSensorGeo.StartY = GData.StaticBadPixelCorrection.CailbVinStartY;
                    GData.SbpCorr.CalibSbpInfo.VinSensorGeo.Width = GData.StaticBadPixelCorrection.CailbVinWidth;
                    GData.SbpCorr.CalibSbpInfo.VinSensorGeo.Height = GData.StaticBadPixelCorrection.CailbVinHeight;
                    GData.SbpCorr.CalibSbpInfo.VinSensorGeo.HSubSample.FactorNum = GData.StaticBadPixelCorrection.CailbVinHSubSampleFactorNum;
                    GData.SbpCorr.CalibSbpInfo.VinSensorGeo.HSubSample.FactorDen = GData.StaticBadPixelCorrection.CailbVinHSubSampleFactorDen;
                    GData.SbpCorr.CalibSbpInfo.VinSensorGeo.VSubSample.FactorNum = GData.StaticBadPixelCorrection.CailbVinVSubSampleFactorNum;
                    GData.SbpCorr.CalibSbpInfo.VinSensorGeo.VSubSample.FactorDen = GData.StaticBadPixelCorrection.CailbVinVSubSampleFactorDen;
                    GData.SbpCorr.CalibSbpInfo.SbpBuffer = FPNMap;
                    // Note: Load Ext FPN Map
                    memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                    Ext_File_Param.FPN_MAP_Ext_Load_Param.Address = GData.SbpCorr.CalibSbpInfo.SbpBuffer;
                    Ext_File_Param.FPN_MAP_Ext_Load_Param.Size = ITUNER_CAL_FPN_MAP_SIZE(GData.StaticBadPixelCorrection.CailbVinWidth, GData.StaticBadPixelCorrection.CailbVinHeight);
                    Ext_File_Param.FPN_MAP_Ext_Load_Param.Size = (Ext_File_Param.FPN_MAP_Ext_Load_Param.Size > sizeof(FPNMap)) ? sizeof(FPNMap) : Ext_File_Param.FPN_MAP_Ext_Load_Param.Size;
                    if (Ituner_Hook_Func.Load_Data(EXT_FILE_FPN_MAP, &Ext_File_Param) < 0) {
                        ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_FPN_MAP) Fail", __func__, __LINE__);
                    }
                } else {
                    GData.SbpCorr.Enb = 0;
                }
                CHECK_RET(0,  amba_img_dsp_set_static_bad_pixel_correction(fd_iav, &Mode, &GData.SbpCorr));
            }

        }
        if (_AmbaItuner_Check_Reg(ITUNER_VIGNETTE_COMPENSATION_BY_PASS, SPECIAL_USE_NONE)) {
            if (GData.VignetteCompensationByPass.Enable) {
                GData.VignetteByPass.Enable = GData.VignetteCompensationByPass.Enable;
                GData.VignetteByPass.GainShift = GData.VignetteCompensationByPass.GainShift;
                // There are four 33x33 vignette tables. Each data uses '2' bytes.
                // Caution: A7L uses 33x33 vignette table, but A9 uses 65*49 vignette table.
                GData.VignetteByPass.pRedGain = (UINT16 *)(VignetteTable + (ITUNER_BYPASS_VIGNETTE_GAIN_MAP_SIZE * 0));
                GData.VignetteByPass.pGreenEvenGain = (UINT16 *)(VignetteTable + (ITUNER_BYPASS_VIGNETTE_GAIN_MAP_SIZE * 1));
                GData.VignetteByPass.pGreenOddGain = (UINT16 *)(VignetteTable + (ITUNER_BYPASS_VIGNETTE_GAIN_MAP_SIZE * 2));
                GData.VignetteByPass.pBlueGain = (UINT16 *)(VignetteTable + (ITUNER_BYPASS_VIGNETTE_GAIN_MAP_SIZE * 3));
                // Note: Load Bypass Vignette Gain Table
                memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                Ext_File_Param.Bypass_Vignette_Gain_Load_Param.Address = VignetteTable;
                Ext_File_Param.Bypass_Vignette_Gain_Load_Param.Size = ITUNER_BYPASS_VIGNETTE_GAIN_MAP_SIZE * 4;
                if (Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_VIGNETTE_GAIN, &Ext_File_Param) < 0) {
                    ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_VIGNETTE_GAIN) Fail", __func__, __LINE__);
                }
            } else {
                GData.VignetteByPass.Enable = 0;
                GData.VignetteByPass.GainShift = 0;
            }
            extern int amba_img_dsp_set_vignette_compensation_bypass(int fd_iav, amba_img_dsp_mode_cfg_t *Mode, AMBA_DSP_IMG_BYPASS_VIGNETTE_INFO_s *pVigCorrByPass);
            // Non-released API, we use extern and avoid that the API is used through header file.
            CHECK_RET(0,  amba_img_dsp_set_vignette_compensation_bypass(fd_iav, &Mode, &GData.VignetteByPass));
        } else {
            if (_AmbaItuner_Check_Reg(ITUNER_VIGNETTE_COMPENSATION, GData.VignetteCompensation.Enable)) {
                if (GData.VignetteCompensation.Enable) {
                GData.VignetteCalcInfo.Enb = GData.VignetteCompensation.Enable;
                GData.VignetteCalcInfo.GainShift = GData.VignetteCompensation.GainShift;
                GData.VignetteCalcInfo.VigStrength = GData.VignetteCompensation.Strength;
                GData.VignetteCalcInfo.CurrentVinSensorGeo.StartX = (GData.VignetteCompensation.CalibVinWidth - RawWidth)>>1;
                GData.VignetteCalcInfo.CurrentVinSensorGeo.StartY = (GData.VignetteCompensation.CalibVinHeight - RawHeight)>>1;
                GData.VignetteCalcInfo.CurrentVinSensorGeo.Width = RawWidth;
                GData.VignetteCalcInfo.CurrentVinSensorGeo.Height = RawHeight;
                GData.VignetteCalcInfo.CurrentVinSensorGeo.HSubSample.FactorNum = HSubSampleFactorNum;
                GData.VignetteCalcInfo.CurrentVinSensorGeo.HSubSample.FactorDen = HSubSampleFactorDen;
                GData.VignetteCalcInfo.CurrentVinSensorGeo.VSubSample.FactorNum = VSubSampleFactorNum;
                GData.VignetteCalcInfo.CurrentVinSensorGeo.VSubSample.FactorDen = VSubSampleFactorDen;
                GData.VignetteCalcInfo.CalibVignetteInfo.Version = GData.VignetteCompensation.CalibVersion;
                GData.VignetteCalcInfo.CalibVignetteInfo.TableWidth = GData.VignetteCompensation.CalibTableWidth;
                GData.VignetteCalcInfo.CalibVignetteInfo.TableHeight = GData.VignetteCompensation.CalibTableHeight;
                GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.StartX = GData.VignetteCompensation.CalibVinStartX;
                GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.StartY = GData.VignetteCompensation.CalibVinStartY;
                GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.Width = GData.VignetteCompensation.CalibVinWidth;
                GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.Height = GData.VignetteCompensation.CalibVinHeight;
                GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.HSubSample.FactorNum    = GData.VignetteCompensation.CailbVinHSubSampleFactorNum;
                GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.HSubSample.FactorDen = GData.VignetteCompensation.CailbVinHSubSampleFactorDen;
                GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.VSubSample.FactorNum = GData.VignetteCompensation.CailbVinVSubSampleFactorNum;
                GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.VSubSample.FactorDen = GData.VignetteCompensation.CailbVinVSubSampleFactorDen;
                GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteRedGain = (UINT16 *)(VignetteTable       + (ITUNER_VIGNETTE_GAIN_MAP_SIZE*0));
                GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteGreenEvenGain = (UINT16 *)(VignetteTable + (ITUNER_VIGNETTE_GAIN_MAP_SIZE*1));
                GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteGreenOddGain = (UINT16 *)(VignetteTable  + (ITUNER_VIGNETTE_GAIN_MAP_SIZE*2));
                GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteBlueGain = (UINT16 *)(VignetteTable      + (ITUNER_VIGNETTE_GAIN_MAP_SIZE*3));
                {
                    memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                    Ext_File_Param.Vignette_Gain_Load_Param.Address = (void*)GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteRedGain;
                    Ext_File_Param.Vignette_Gain_Load_Param.Size = ITUNER_VIGNETTE_GAIN_MAP_SIZE * 4;
                    if (Ituner_Hook_Func.Load_Data(EXT_FILE_VIGNETTE_GAIN, &Ext_File_Param) < 0) {
                        ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_VIGNETTE_GAIN) Fail", __func__, __LINE__);
                    }
                }
            } else {
                GData.VignetteCalcInfo.Enb = 0;
                GData.VignetteCalcInfo.GainShift = 0;
            }
            CHECK_RET(0,  amba_img_dsp_calc_vignette_compensation(&Mode, &GData.VignetteCalcInfo));
            CHECK_RET(0,  amba_img_dsp_set_vignette_compensation(fd_iav, &Mode));
        }
        }
        memset(WarpGrid, 0, sizeof(WarpGrid));
        if (_AmbaItuner_Check_Reg(ITUNER_WARP_COMPENSATION_DZOOM_BY_PASS, SPECIAL_USE_NONE)) {
            // Dzoom Part
            GData.WarpByPass.ActualLeftTopX = GData.WarpCompensationDzoomByPass.ActualLeftTopX;
            GData.WarpByPass.ActualLeftTopY = GData.WarpCompensationDzoomByPass.ActualLeftTopY;
            GData.WarpByPass.ActualRightBotX = GData.WarpCompensationDzoomByPass.ActualRightBotX;
            GData.WarpByPass.ActualRightBotY = GData.WarpCompensationDzoomByPass.ActualRightBotY;
            GData.WarpByPass.ZoomX = GData.WarpCompensationDzoomByPass.ZoomX;
            GData.WarpByPass.ZoomY = GData.WarpCompensationDzoomByPass.ZoomY;
            GData.WarpByPass.XCenterOffset = GData.WarpCompensationDzoomByPass.XCenterOffset;
            GData.WarpByPass.YCenterOffset = GData.WarpCompensationDzoomByPass.YCenterOffset;
            GData.WarpByPass.HorSkewPhaseInc = GData.WarpCompensationDzoomByPass.HorSkewPhaseInc;
            GData.WarpByPass.DummyWindowXLeft = GData.WarpCompensationDzoomByPass.DummyWindowXLeft;
            GData.WarpByPass.DummyWindowYTop = GData.WarpCompensationDzoomByPass.DummyWindowYTop;
            GData.WarpByPass.DummyWindowWidth = GData.WarpCompensationDzoomByPass.DummyWindowWidth;
            GData.WarpByPass.DummyWindowHeight = GData.WarpCompensationDzoomByPass.DummyWindowHeight;
            GData.WarpByPass.CfaOutputWidth = GData.WarpCompensationDzoomByPass.CfaOutputWidth;
            GData.WarpByPass.CfaOutputHeight = GData.WarpCompensationDzoomByPass.CfaOutputHeight;
            // Set Cfa for A9 CaWarp and WarpCalcInfo structure.
            GData.WarpCalcInfo.CfaWinDim.Width = GData.WarpByPass.CfaOutputWidth;
            GData.WarpCalcInfo.CfaWinDim.Height = GData.WarpByPass.CfaOutputHeight;
            GData.WarpCalcInfo.DmyWinGeo.StartX = GData.WarpByPass.DummyWindowXLeft;
            GData.WarpCalcInfo.DmyWinGeo.StartY = GData.WarpByPass.DummyWindowYTop;
            GData.WarpCalcInfo.DmyWinGeo.Width = GData.WarpByPass.DummyWindowWidth;
            GData.WarpCalcInfo.DmyWinGeo.Height = GData.WarpByPass.DummyWindowHeight;
            GData.WarpCalcInfo.R2rOutWinDim.Width = RawWidth;
            GData.WarpCalcInfo.R2rOutWinDim.Height = RawHeight;
            GData.WarpCalcInfo.MainWinDim.Width = MainWidth;
            GData.WarpCalcInfo.MainWinDim.Height = MainHeight;
            GData.WarpCalcInfo.VinSensorGeo.StartX = RawStartX;
            GData.WarpCalcInfo.VinSensorGeo.StartY = RawStartY;
            GData.WarpCalcInfo.VinSensorGeo.Width = RawWidth;
            GData.WarpCalcInfo.VinSensorGeo.Height = RawHeight;
            GData.WarpCalcInfo.VinSensorGeo.HSubSample.FactorNum = HSubSampleFactorNum;
            GData.WarpCalcInfo.VinSensorGeo.HSubSample.FactorDen = HSubSampleFactorDen;
            GData.WarpCalcInfo.VinSensorGeo.VSubSample.FactorNum = VSubSampleFactorNum;
            GData.WarpCalcInfo.VinSensorGeo.VSubSample.FactorDen = VSubSampleFactorDen;
            GData.WarpCalcInfo.ActWinCrop.LeftTopX = GData.WarpByPass.ActualLeftTopX;
            GData.WarpCalcInfo.ActWinCrop.LeftTopY = GData.WarpByPass.ActualLeftTopY;
            GData.WarpCalcInfo.ActWinCrop.RightBotX = GData.WarpByPass.ActualRightBotX;
            GData.WarpCalcInfo.ActWinCrop.RightBotY = GData.WarpByPass.ActualRightBotY;
//            CHECK_RET(0,  amba_img_dsp_calc_warp_compensation(Mode, &GData.WarpCalcInfo));
            // Set for warp bypass part
            // Bypass warp horizontal part
            if (GData.WarpCompensationDzoomByPass.WarpControl) {
                GData.WarpByPass.WarpControl = GData.WarpCompensationDzoomByPass.WarpControl;
                GData.WarpByPass.GridArrayWidth = GData.WarpCompensationDzoomByPass.GridArrayWidth;
                GData.WarpByPass.GridArrayHeight = GData.WarpCompensationDzoomByPass.GridArrayHeight;
                GData.WarpByPass.HorzGridSpacingExponent = GData.WarpCompensationDzoomByPass.HorzGridSpacingExponent;
                GData.WarpByPass.VertGridSpacingExponent = GData.WarpCompensationDzoomByPass.VertGridSpacingExponent;
                GData.WarpByPass.pWarpHorizontalTable = (INT16 *) WarpGrid;
                {
                    memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                    Ext_File_Param.Bypass_Warp_Horizontal_Table_Load_Param.Address = WarpGrid;
                    Ext_File_Param.Bypass_Warp_Horizontal_Table_Load_Param.Max_Size = sizeof(WarpGrid) >> 1;
                    if (Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_WARP_HORIZONTAL_TABLE, &Ext_File_Param) < 0) {
                        ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_WARP_HORIZONTAL_TABLE) Fail", __func__, __LINE__);
                    }
                }
            } else {
            #if 0
                GData.WarpByPass.WarpControl = 0;
                GData.WarpByPass.pWarpHorizontalTable = (INT16 *) WarpGrid;
                // Avoid crash, so we assign reasonable values for GridArrayWidth, GridArrayHeight,
                // HorzGridSpacingExponent, and VertGridSpacingExponent.
                // We reference to AmbaDSP_ImgWarpCompensation.c (SVN 5404).
                int EffectiveWidth, EffectiveHeight;
                int TileWLog2Minus4, TileHLog2Minus4;
                int TileW, TileH, HorGridNum, VerGridNum;
                UINT32 MaxHorGrid, MaxVerGrid;
                switch (Mode.Pipe) {
                case AMBA_DSP_IMG_PIPE_VIDEO:
                    EffectiveWidth = GData.WarpCalcInfo.MainWinDim.Width;
                    EffectiveHeight = GData.WarpCalcInfo.CfaWinDim.Height;
                    TileWLog2Minus4 = 0;
                    TileHLog2Minus4 = 0;
                    MaxHorGrid = WARP_VIDEO_MAXHORGRID;
                    MaxVerGrid = WARP_VIDEO_MAXVERGRID;
                    break;
                case AMBA_DSP_IMG_PIPE_STILL:
                    EffectiveWidth = (GData.WarpCalcInfo.ActWinCrop.RightBotX - GData.WarpCalcInfo.ActWinCrop.LeftTopX + 0xFFFF) >> SFT;
                    EffectiveHeight = (GData.WarpCalcInfo.DmyWinGeo.Height + 19) & 0xFFFFFFF0;  // Add 4 line and pad to next 16
                    TileWLog2Minus4 = (EffectiveWidth > 1280)?3:0;
                    TileHLog2Minus4 = (EffectiveHeight > 1280)?3:0;
                    MaxHorGrid = WARP_VIDEO_MAXHORGRID; // Can allow max 32 grid_width because no stitching
                    MaxVerGrid = WARP_STILL_MAXVERGRID;
                    break;
                case AMBA_DSP_IMG_PIPE_DEC:
                default:
                    AmbaPrint("[Error] We don't support this pipe!!");
                }
                while ((MaxHorGrid - 1) * (1 << (4 + TileWLog2Minus4)) < EffectiveWidth) {
                    TileWLog2Minus4++;
                }
                while ((MaxVerGrid - 1) * (1 << (4 + TileHLog2Minus4)) < EffectiveHeight) {
                    TileHLog2Minus4++;
                }
                TileW = 1 << (4 + TileWLog2Minus4);
                TileH = 1 << (4 + TileHLog2Minus4);
                HorGridNum = 1 + ((EffectiveWidth + TileW - 1) >> (4 + TileWLog2Minus4));
                VerGridNum = 1 + ((EffectiveHeight + TileH - 1) >> (4 + TileHLog2Minus4));
                GData.WarpByPass.HorzGridSpacingExponent = TileWLog2Minus4;
                GData.WarpByPass.VertGridSpacingExponent = TileHLog2Minus4;
                GData.WarpByPass.GridArrayWidth = HorGridNum - 1;
                GData.WarpByPass.GridArrayHeight = VerGridNum - 1;
                // Bypass warp vertical part
                if (GData.WarpCompensationDzoomByPass.VertWarpEnable) {
                    GData.WarpByPass.VertWarpEnable = GData.WarpCompensationDzoomByPass.VertWarpEnable;
                    GData.WarpByPass.VertWarpGridArrayWidth = GData.WarpCompensationDzoomByPass.VertWarpGridArrayWidth;
                    GData.WarpByPass.VertWarpGridArrayHeight = GData.WarpCompensationDzoomByPass.VertWarpGridArrayHeight;
                    GData.WarpByPass.VertWarpHorzGridSpacingExponent = GData.WarpCompensationDzoomByPass.VertWarpHorzGridSpacingExponent;
                    GData.WarpByPass.VertWarpVertGridSpacingExponent = GData.WarpCompensationDzoomByPass.VertWarpVertGridSpacingExponent;
                    GData.WarpByPass.pWarpVerticalTable = (INT16 *) (WarpGrid + (sizeof(WarpGrid) >> 1));
                    {
                        memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                        Ext_File_Param.Bypass_Warp_Vertical_Table_Load_Param.Address = GData.WarpByPass.pWarpVerticalTable;
                        Ext_File_Param.Bypass_Warp_Vertical_Table_Load_Param.Max_Size = sizeof(WarpGrid) >> 1;
                        if (Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_WARP_VERTICAL_TABLE, &Ext_File_Param) < 0) {
                            ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_WARP_VERITCAL_TABLE) Fail", __func__, __LINE__);
                        }
                    }
                } else {
                    GData.WarpByPass.VertWarpEnable = 0;
                    GData.WarpByPass.pWarpVerticalTable = (INT16 *) (WarpGrid + (sizeof(WarpGrid) >> 1));
                    // Avoid crash, so we assign reasonable values for VertWarpGridArrayWidth, VertWarpGridArrayHeight,
                    // VertWarpHorzGridSpacingExponent, and VertWarpVertGridSpacingExponent.
                    // We reference to AmbaDSP_ImgWarpCompensation.c (SVN 5404).
                    int EffectiveWidth, EffectiveHeight;
                    int TileWLog2Minus4, TileHLog2Minus4;
                    int TileW, TileH, HorGridNum, VerGridNum;
                    UINT32 MaxHorGrid, MaxVerGrid;
                    UINT32 W0;
                    switch (Mode.Pipe) {
                    case AMBA_DSP_IMG_PIPE_VIDEO:
                        EffectiveWidth = GData.WarpCalcInfo.MainWinDim.Width;
                        EffectiveHeight = GData.WarpCalcInfo.MainWinDim.Height;
                        if (EffectiveHeight == 1080){
                            EffectiveHeight = 1088; // h264 needs 16 align height so ucode will pad to 1088 in section2 output
                        }
                        TileWLog2Minus4 = 0;
                        TileHLog2Minus4 = 0;
                        MaxHorGrid = WARP_VIDEO_MAXHORGRID;
                        MaxVerGrid = WARP_VIDEO_MAXVERGRID;
                        break;
                    case AMBA_DSP_IMG_PIPE_STILL:
                        W0 = (((GData.WarpCalcInfo.ActWinCrop.RightBotX - GData.WarpCalcInfo.ActWinCrop.LeftTopX + 0xFFFF) >> SFT));
                        EffectiveWidth = (((UINT64)(W0) * GData.WarpCalcInfo.CfaWinDim.Width) / GData.WarpCalcInfo.DmyWinGeo.Width);
                        EffectiveHeight = (((GData.WarpCalcInfo.ActWinCrop.RightBotY - GData.WarpCalcInfo.ActWinCrop.LeftTopY + 0xFFFF) >> SFT ) + 19 ) & 0xFFFFFFF0;  // Add 4 line and pad to next 16
                        TileWLog2Minus4 = 0;
                        TileHLog2Minus4 = 0;
                        MaxHorGrid = WARP_VIDEO_MAXHORGRID; // Can allow max 32 grid_width because no stitching
                        MaxVerGrid = WARP_STILL_MAXVERGRID;
                        break;
                    case AMBA_DSP_IMG_PIPE_DEC:
                    default:
                        AmbaPrint("[Error] We don't support this pipe!!");
                    }
                    while ((MaxHorGrid - 1) * (1 << (4 + TileWLog2Minus4)) < EffectiveWidth) {
                        TileWLog2Minus4++;
                    }
                    while ((MaxVerGrid - 1) * (1 << (4 + TileHLog2Minus4)) < EffectiveHeight) {
                        TileHLog2Minus4++;
                    }
                    TileW = 1 << (4 + TileWLog2Minus4);
                    TileH = 1 << (4 + TileHLog2Minus4);
                    HorGridNum = 1 + ((EffectiveWidth + TileW - 1) >> (4 + TileWLog2Minus4));
                    VerGridNum = 1 + ((EffectiveHeight + TileH - 1) >> (4 + TileHLog2Minus4));
                    GData.WarpByPass.VertWarpHorzGridSpacingExponent = TileWLog2Minus4;
                    GData.WarpByPass.VertWarpVertGridSpacingExponent = TileHLog2Minus4;
                    GData.WarpByPass.VertWarpGridArrayWidth = HorGridNum - 1;
                    GData.WarpByPass.VertWarpGridArrayHeight = VerGridNum - 1;
                }
//               		 extern int AmbaDSP_ImgSetWarpCompensationByPass(amba_img_dsp_mode_cfg_t Mode, AMBA_DSP_IMG_BYPASS_WARP_DZOOM_INFO_s *pWarpDzoomCorrByPass);
//                		CHECK_RET(0,  AmbaDSP_ImgSetWarpCompensationByPass(Mode, &GData.WarpByPass));
		#endif
            }
        } else {
            if (_AmbaItuner_Check_Reg(ITUNER_WARP_COMPENSATION, GData.WarpCompensation.Enable) && GData.WarpCompensation.Enable) {
                GData.WarpCalcInfo.WarpEnb = GData.WarpCompensation.Enable;
                GData.WarpCalcInfo.Control = GData.WarpCompensation.Enable;
                GData.WarpCalcInfo.CalibWarpInfo.Version = GData.WarpCompensation.CalibVersion;
                GData.WarpCalcInfo.CalibWarpInfo.HorGridNum = GData.WarpCompensation.HorizontalGridNumber;
                GData.WarpCalcInfo.CalibWarpInfo.VerGridNum = GData.WarpCompensation.VerticalGridNumber;
                GData.WarpCalcInfo.CalibWarpInfo.TileWidthExp = GData.WarpCompensation.TileWidthExponent;
                GData.WarpCalcInfo.CalibWarpInfo.TileHeightExp = GData.WarpCompensation.TileHeightExponent;
                GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.StartX = GData.WarpCompensation.VinSensorStartX;
                GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.StartY = GData.WarpCompensation.VinSensorStartY;
                GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.Width = GData.WarpCompensation.VinSensorWidth;
                GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.Height = GData.WarpCompensation.VinSensorHeight;
                GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.HSubSample.FactorNum = GData.WarpCompensation.VinSensorHSubSampleFactorNum;
                GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.HSubSample.FactorDen = GData.WarpCompensation.VinSensorHSubSampleFactorDen;
                GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.VSubSample.FactorNum = GData.WarpCompensation.VinSensorVSubSampleFactorNum;
                GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.VSubSample.FactorDen = GData.WarpCompensation.VinSensorVSubSampleFactorDen;
                GData.WarpCalcInfo.CalibWarpInfo.pWarp = (AMBA_DSP_IMG_GRID_POINT_s *)WarpGrid;
                memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                Ext_File_Param.Warp_Table_Load_Param.Address = GData.WarpCalcInfo.CalibWarpInfo.pWarp;
                Ext_File_Param.Warp_Table_Load_Param.Size = ITUNER_CAL_WARP_TABLE_SIZE(GData.WarpCalcInfo.CalibWarpInfo.HorGridNum, GData.WarpCalcInfo.CalibWarpInfo.VerGridNum);
                if (Ituner_Hook_Func.Load_Data(EXT_FILE_WARP_TABLE, &Ext_File_Param) < 0) {
                    ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_WARP_TABLE) Fail", __func__, __LINE__);
                }
                GData.WarpCalcInfo.MainWinDim.Width = MainWidth;
                GData.WarpCalcInfo.MainWinDim.Height  = MainHeight;
            } else {
                GData.WarpCalcInfo.WarpEnb = 0;
                GData.WarpCalcInfo.MainWinDim.Width = MainWidth;
                GData.WarpCalcInfo.MainWinDim.Height  = MainHeight;
            }
            GData.WarpCalcInfo.VinSensorGeo.StartX = RawStartX;
            GData.WarpCalcInfo.VinSensorGeo.StartY = RawStartY;
            GData.WarpCalcInfo.VinSensorGeo.Width = RawWidth;
            GData.WarpCalcInfo.VinSensorGeo.Height = RawHeight;
            GData.WarpCalcInfo.VinSensorGeo.HSubSample.FactorNum = HSubSampleFactorNum;
            GData.WarpCalcInfo.VinSensorGeo.HSubSample.FactorDen = HSubSampleFactorDen;
            GData.WarpCalcInfo.VinSensorGeo.VSubSample.FactorNum = VSubSampleFactorNum;
            GData.WarpCalcInfo.VinSensorGeo.VSubSample.FactorDen = VSubSampleFactorDen;
            if (_AmbaItuner_Check_Reg(ITUNER_DZOOM, GData.Dzoom.Enable)) {
                if (GData.Dzoom.Enable == 1) {
                    GData.WarpCalcInfo.R2rOutWinDim.Width = GData.Dzoom.R2rOutputWidth;
                    GData.WarpCalcInfo.R2rOutWinDim.Height = GData.Dzoom.R2rOutputHeigh;
                    GData.WarpCalcInfo.DmyWinGeo.StartX = GData.Dzoom.DummyWindowLeftX;
                    GData.WarpCalcInfo.DmyWinGeo.StartY = GData.Dzoom.DummyWindowTopY;
                    GData.WarpCalcInfo.DmyWinGeo.Width = GData.Dzoom.DummyWindowWidth;
                    GData.WarpCalcInfo.DmyWinGeo.Height = GData.Dzoom.DummyWindowHeight;
                    GData.WarpCalcInfo.CfaWinDim.Width = GData.Dzoom.CfaOutputWidth;
                    GData.WarpCalcInfo.CfaWinDim.Height = GData.Dzoom.CfaOutputHeight;
                    GData.WarpCalcInfo.ActWinCrop.LeftTopX = GData.Dzoom.ActualLeftTopX;
                    GData.WarpCalcInfo.ActWinCrop.LeftTopY = GData.Dzoom.ActualLeftTopY;
                    GData.WarpCalcInfo.ActWinCrop.RightBotX = GData.Dzoom.ActualRightBotX;
                    GData.WarpCalcInfo.ActWinCrop.RightBotY = GData.Dzoom.ActualRightBotY;
                    GData.WarpCalcInfo.HorSkewPhaseInc = GData.Dzoom.HorSkewPhaseInc;
                } else if (GData.Dzoom.Enable == 0) {
                    GData.WarpCalcInfo.R2rOutWinDim.Width = RawWidth;
                    GData.WarpCalcInfo.R2rOutWinDim.Height = RawHeight;
                    GData.WarpCalcInfo.DmyWinGeo.StartX = RawStartX;
                    GData.WarpCalcInfo.DmyWinGeo.StartY = RawStartY;
                    GData.WarpCalcInfo.DmyWinGeo.Width = RawWidth;
                    GData.WarpCalcInfo.DmyWinGeo.Height = RawHeight;
                    GData.WarpCalcInfo.CfaWinDim.Width = RawWidth;
                    GData.WarpCalcInfo.CfaWinDim.Height = RawHeight;
                    GData.WarpCalcInfo.ActWinCrop.LeftTopX = 0;
                    GData.WarpCalcInfo.ActWinCrop.LeftTopY = 0;
                    GData.WarpCalcInfo.ActWinCrop.RightBotX = (RawWidth)<<16;
                    GData.WarpCalcInfo.ActWinCrop.RightBotY = (RawHeight)<<16;
                    GData.WarpCalcInfo.HorSkewPhaseInc = 0;
                }
            }
//            CHECK_RET(0,  AmbaDSP_ImgCalcWarpCompensation(Mode, &GData.WarpCalcInfo));
//            CHECK_RET(0,  AmbaDSP_ImgSetWarpCompensation(Mode));
        }

#if 0
        memset(ca_grid, 0, sizeof(ca_grid));
        if (_AmbaItuner_Check_Reg(ITUNER_CHROMA_ABERRATION_INFO_BY_PASS, SPECIAL_USE_NONE)) {
            // Horizontal part
            if (GData.ChromaAberrationInfoByPass.HorzWarpEnable) {
                GData.CAByPass.HorzWarpEnable = GData.ChromaAberrationInfoByPass.HorzWarpEnable;
                GData.CAByPass.HorzPassGridArrayWidth = GData.ChromaAberrationInfoByPass.HorzPassGridArrayWidth;
                GData.CAByPass.HorzPassGridArrayHeight = GData.ChromaAberrationInfoByPass.HorzPassGridArrayHeight;
                GData.CAByPass.HorzPassHorzGridSpacingExponent = GData.ChromaAberrationInfoByPass.HorzPassHorzGridSpacingExponent;
                GData.CAByPass.HorzPassVertGridSpacingExponent = GData.ChromaAberrationInfoByPass.HorzPassVertGridSpacingExponent;
                GData.CAByPass.pWarpHorzTable = (INT16 *) ca_grid;
                memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                Ext_File_Param.Bypass_Ca_Horizontal_Table_Load_Param.Address = GData.CAByPass.pWarpHorzTable;
                Ext_File_Param.Bypass_Ca_Horizontal_Table_Load_Param.Max_Size = sizeof(ca_grid) >> 1;
                if (Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_CA_HORIZONTAL_TABLE, &Ext_File_Param) < 0) {
                    ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_CA_HORIZONTAL_TABLE) Fail", __func__, __LINE__);
                }
            } else {
                GData.CAByPass.HorzWarpEnable = 0;
                GData.CAByPass.pWarpHorzTable = (INT16 *) ca_grid;
                // Avoid crash, so we assign reasonable values for HorzPassGridArrayWidth, HorzPassGridArrayHeight,
                // HorzPassHorzGridSpacingExponent, and HorzPassVertGridSpacingExponent.
                // We reference to AmbaDSP_ImgCawarpCompensation.c (SVN 5404).
                int OutWidth, OutHeight;
                int TileWLog2Minus4, TileHLog2Minus4;
                int TileW, TileH, HorGridNum, VerGridNum;
                UINT32 MaxHorGrid, MaxVerGrid;
                switch (Mode.Pipe) {
                case AMBA_DSP_IMG_PIPE_VIDEO:
                    MaxHorGrid = CAWARP_VIDEO_MAXHORGRID;
                    MaxVerGrid = CAWARP_VIDEO_MAXVERGRID;
                    break;
                case AMBA_DSP_IMG_PIPE_STILL:
                    MaxHorGrid = CAWARP_VIDEO_MAXHORGRID;
                    MaxVerGrid = CAWARP_VIDEO_MAXVERGRID;
                    break;
                case AMBA_DSP_IMG_PIPE_DEC:
                default:
                    AmbaPrint("[Error] We don't support this pipe!!");
                }
                OutWidth = GData.WarpCalcInfo.CfaWinDim.Width;
                OutHeight = GData.WarpCalcInfo.DmyWinGeo.Height;
                TileWLog2Minus4 = 0;
                while ((MaxHorGrid - 1) * (1 << (4 + TileWLog2Minus4)) < OutWidth) {
                    TileWLog2Minus4++;
                }
                TileHLog2Minus4 = 0;
                while ((MaxVerGrid - 1) * (1 << (4 + TileHLog2Minus4)) < OutHeight) {
                    TileHLog2Minus4++;
                }
                TileW = 1 << (4 + TileWLog2Minus4);
                TileH = 1 << (4 + TileHLog2Minus4);
                HorGridNum = 1 + ((OutWidth + TileW - 1) >> (4 + TileWLog2Minus4));
                VerGridNum = 1 + ((OutHeight + TileH - 1) >> (4 + TileHLog2Minus4));
                GData.CAByPass.HorzPassHorzGridSpacingExponent = TileWLog2Minus4;
                GData.CAByPass.HorzPassVertGridSpacingExponent = TileHLog2Minus4;
                GData.CAByPass.HorzPassGridArrayWidth = HorGridNum - 1;
                GData.CAByPass.HorzPassGridArrayHeight = VerGridNum - 1;
            }

            // Vertical part
            if (GData.ChromaAberrationInfoByPass.VertWarpEnable) {
                GData.CAByPass.VertWarpEnable = GData.ChromaAberrationInfoByPass.VertWarpEnable;
                GData.CAByPass.VertPassGridArrayWidth = GData.ChromaAberrationInfoByPass.VertPassGridArrayWidth;
                GData.CAByPass.VertPassGridArrayHeight = GData.ChromaAberrationInfoByPass.VertPassGridArrayHeight;
                GData.CAByPass.VertPassHorzGridSpacingExponent = GData.ChromaAberrationInfoByPass.VertPassHorzGridSpacingExponent;
                GData.CAByPass.VertPassVertGridSpacingExponent = GData.ChromaAberrationInfoByPass.VertPassVertGridSpacingExponent;
                GData.CAByPass.pWarpVertTable = (INT16 *) (ca_grid + (sizeof(ca_grid) >> 1));

                memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                Ext_File_Param.Bypass_Ca_Vertical_Table_Load_Param.Address = GData.CAByPass.pWarpVertTable;
                Ext_File_Param.Bypass_Ca_Vertical_Table_Load_Param.Max_Size = sizeof(ca_grid) >> 1;
                if (Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_CA_VERTICAL_TABLE, &Ext_File_Param) < 0) {
                    ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_BYPASS_CA_VERTICAL_TABLE) Fail", __func__, __LINE__);
                }
            } else {
                GData.CAByPass.VertWarpEnable = 0;
                GData.CAByPass.pWarpVertTable = (INT16 *) (ca_grid + (sizeof(ca_grid) >> 1));

                // Avoid crash, so we assign reasonable values for VertPassGridArrayWidth, VertPassGridArrayHeight,
                // VertPassHorzGridSpacingExponent, and VertPassVertGridSpacingExponent.
                // We reference to AmbaDSP_ImgCawarpCompensation.c (SVN 5404).

                // Caution: In vertical part, there is no formula for width. It's using value from horiztontal part.
                //          So we use the formula in horiztontal part again.
                //          Counting here again voids the case -  "horizontal part is disable, but vertical part is enable".
                int OutWidth, OutHeight;
                int TileWLog2Minus4, TileHLog2Minus4;
                int TileW, TileH, HorGridNum, VerGridNum;
                UINT32 MaxHorGrid, MaxVerGrid;
                switch (Mode.Pipe) {
                case AMBA_DSP_IMG_PIPE_VIDEO:
                    MaxHorGrid = CAWARP_VIDEO_MAXHORGRID;
                    MaxVerGrid = CAWARP_VIDEO_MAXVERGRID;
                    break;
                case AMBA_DSP_IMG_PIPE_STILL:
                    MaxHorGrid = CAWARP_VIDEO_MAXHORGRID;
                    MaxVerGrid = CAWARP_VIDEO_MAXVERGRID;
                    break;
                case AMBA_DSP_IMG_PIPE_DEC:
                default:
                    AmbaPrint("[Error] We don't support this pipe!!");
                }
                OutWidth = GData.WarpCalcInfo.CfaWinDim.Width;
                OutHeight = GData.WarpCalcInfo.CfaWinDim.Height;
                TileWLog2Minus4 = 0;
                while ((MaxHorGrid - 1) * (1 << (4 + TileWLog2Minus4)) < OutWidth) {
                    TileWLog2Minus4++;
                }
                TileHLog2Minus4 = 0;
                while ((MaxVerGrid - 1) * (1 << (4 + TileHLog2Minus4)) < OutHeight) {
                    TileHLog2Minus4++;
                }
                TileW = 1 << (4 + TileWLog2Minus4);
                TileH = 1 << (4 + TileHLog2Minus4);
                HorGridNum = 1 + ((OutWidth + TileW - 1) >> (4 + TileWLog2Minus4));
                VerGridNum = 1 + ((OutHeight + TileH - 1) >> (4 + TileHLog2Minus4));
                GData.CAByPass.VertPassHorzGridSpacingExponent = TileWLog2Minus4;
                GData.CAByPass.VertPassVertGridSpacingExponent = TileHLog2Minus4;
                GData.CAByPass.VertPassGridArrayWidth = HorGridNum - 1;
                GData.CAByPass.VertPassGridArrayHeight = VerGridNum - 1;
            }
            // Check common part
            if (GData.ChromaAberrationInfoByPass.HorzWarpEnable || GData.ChromaAberrationInfoByPass.VertWarpEnable) {
                GData.CAByPass.RedScaleFactor = GData.ChromaAberrationInfoByPass.RedScaleFactor;
                GData.CAByPass.BlueScaleFactor = GData.ChromaAberrationInfoByPass.BlueScaleFactor;
            } else {
                GData.CAByPass.RedScaleFactor = 0;
                GData.CAByPass.BlueScaleFactor = 0;
            }
//            extern int   AmbaDSP_ImgSetCawarpCompensationByPass(amba_img_dsp_mode_cfg_t Mode, AMBA_DSP_IMG_BYPASS_CAWARP_INFO_s *pCAWarpCorrByPass);
//            CHECK_RET(0,  AmbaDSP_ImgSetCawarpCompensationByPass(Mode, &GData.CAByPass));
        } else {
            if (_AmbaItuner_Check_Reg(ITUNER_CHROMA_ABERRATION_INFO, GData.ChromaAberrationInfo.Enable) && GData.ChromaAberrationInfo.Enable) {
                GData.CACalcInfo.CaWarpEnb = GData.ChromaAberrationInfo.Enable;
                GData.CACalcInfo.CalibCaWarpInfo.Version = GData.ChromaAberrationInfo.CalibVersion;
                GData.CACalcInfo.CalibCaWarpInfo.HorGridNum = GData.ChromaAberrationInfo.HorizontalGridNumber;
                GData.CACalcInfo.CalibCaWarpInfo.VerGridNum = GData.ChromaAberrationInfo.VerticalGridNumber;
                GData.CACalcInfo.CalibCaWarpInfo.TileWidthExp = GData.ChromaAberrationInfo.TileWidthExponent;
                GData.CACalcInfo.CalibCaWarpInfo.TileHeightExp = GData.ChromaAberrationInfo.TileHeightExponent;
                GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.StartX = GData.ChromaAberrationInfo.VinSensorStartX;
                GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.StartY = GData.ChromaAberrationInfo.VinSensorStartY;
                GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.Width = GData.ChromaAberrationInfo.VinSensorWidth;
                GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.Height = GData.ChromaAberrationInfo.VinSensorHeight;
                GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.HSubSample.FactorNum = GData.ChromaAberrationInfo.VinSensorHSubSampleFactorNum;
                GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.HSubSample.FactorDen = GData.ChromaAberrationInfo.VinSensorHSubSampleFactorDen;
                GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.VSubSample.FactorNum = GData.ChromaAberrationInfo.VinSensorVSubSampleFactorNum;
                GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.VSubSample.FactorDen = GData.ChromaAberrationInfo.VinSensorVSubSampleFactorDen;
                GData.CACalcInfo.CalibCaWarpInfo.RedScaleFactor = GData.ChromaAberrationInfo.RedScaleFactor;
                GData.CACalcInfo.CalibCaWarpInfo.BlueScaleFactor = GData.ChromaAberrationInfo.BlueScaleFactor;
                GData.CACalcInfo.CalibCaWarpInfo.pCaWarp = (AMBA_DSP_IMG_GRID_POINT_s *)ca_grid;
                memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                Ext_File_Param.Ca_Table_Load_Param.Address = GData.CACalcInfo.CalibCaWarpInfo.pCaWarp;
                Ext_File_Param.Ca_Table_Load_Param.Size = ITUNER_CAL_CA_TABLE_SIZE(GData.CACalcInfo.CalibCaWarpInfo.HorGridNum, GData.CACalcInfo.CalibCaWarpInfo.VerGridNum);
                if (Ituner_Hook_Func.Load_Data(EXT_FILE_CA_TABLE, &Ext_File_Param) < 0) {
                    ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_CA_TABLE) Fail", __func__, __LINE__);
                }
            } else {
                GData.CACalcInfo.CaWarpEnb = 0;
            }
            GData.CACalcInfo.VinSensorGeo.StartX = RawStartX;
            GData.CACalcInfo.VinSensorGeo.StartY = RawStartY;
            GData.CACalcInfo.VinSensorGeo.Width = RawWidth;
            GData.CACalcInfo.VinSensorGeo.Height = RawHeight;
            GData.CACalcInfo.VinSensorGeo.HSubSample.FactorNum = HSubSampleFactorNum;
            GData.CACalcInfo.VinSensorGeo.HSubSample.FactorDen = HSubSampleFactorDen;
            GData.CACalcInfo.VinSensorGeo.VSubSample.FactorNum = VSubSampleFactorNum;
            GData.CACalcInfo.VinSensorGeo.VSubSample.FactorDen = VSubSampleFactorDen;
            GData.CACalcInfo.R2rOutWinDim = GData.WarpCalcInfo.R2rOutWinDim;
            GData.CACalcInfo.DmyWinGeo = GData.WarpCalcInfo.DmyWinGeo;
            GData.CACalcInfo.CfaWinDim = GData.WarpCalcInfo.CfaWinDim;
//            CHECK_RET(0,  AmbaDSP_ImgCalcCawarpCompensation(Mode, &GData.CACalcInfo));
//            CHECK_RET(0,  AmbaDSP_ImgSetCawarpCompensation(Mode));
        }
#endif
        if (_AmbaItuner_Check_Reg(ITUNER_COLOR_CORRECTION, SPECIAL_USE_NONE)) {
            GData.CcReg.RegSettingAddr = (UINT32)CcReg;
            if (GData.CcReg.RegSettingAddr != 0) {
                memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                Ext_File_Param.CC_Reg_Load_Param.Address = (void*)GData.CcReg.RegSettingAddr;
                Ext_File_Param.CC_Reg_Load_Param.Size = AMBA_DSP_IMG_CC_REG_SIZE;
                if (Ituner_Hook_Func.Load_Data(EXT_FILE_CC_REG, &Ext_File_Param) < 0) {
                    ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_CC_REG) Fail", __func__, __LINE__);
                } else {
                    CHECK_RET(0,  amba_img_dsp_set_color_correction_reg(&Mode, &GData.CcReg));
                }

            }

            GData.CcThreeD.MatrixThreeDTableAddr = (UINT32)Cc3d;
            if (GData.CcThreeD.MatrixThreeDTableAddr != 0) {
                memset(&Ext_File_Param, 0x0, sizeof(Ext_File_Param));
                Ext_File_Param.CC_ThreeD_Load_Param.Address = (void*)GData.CcThreeD.MatrixThreeDTableAddr;
                Ext_File_Param.CC_ThreeD_Load_Param.Size = AMBA_DSP_IMG_CC_3D_SIZE;
                if (Ituner_Hook_Func.Load_Data(EXT_FILE_CC_THREED, &Ext_File_Param) < 0) {
                    ITUNER_WARF("%s() %d, call Ituner_Hook_Func.Load_Data(EXT_FILE_CC_THREED) Fail", __func__, __LINE__);
                } else {
                    CHECK_RET(0,  amba_img_dsp_set_color_correction(fd_iav, &Mode, &GData.CcThreeD));
                }
            }
        }
        if (_AmbaItuner_Check_Reg(ITUNER_STATIC_BLACK_LEVEL, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_static_black_level(fd_iav, &Mode, &GData.StaticBlackLevel));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_WB_GAIN, SPECIAL_USE_NONE)) {
            GData.WbGain.AeGain = (_Ituner_Valid_Filter[ITUNER_AE_INFO] == 1) ? GData.AeInfo.Dgain : WB_DGAIN_UNIT;
            GData.WbGain.GlobalDGain = (_Ituner_Valid_Filter[ITUNER_GLOBAL_DGAIN] == 1) ? GData.GlobalDgain : WB_DGAIN_UNIT;
            CHECK_RET(0,  amba_img_dsp_set_wb_gain(fd_iav, &Mode, &GData.WbGain));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_DEFERRED_BLACK_LEVEL, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_deferred_black_level(fd_iav, &Mode, &GData.DeferredBlackLevel));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_DYNAMIC_BAD_PIXEL_CORRECTION, GData.DynamicBadPixelCorrection.Enb)) {
            CHECK_RET(0,  amba_img_dsp_set_dynamic_bad_pixel_correction(fd_iav, &Mode, &GData.DynamicBadPixelCorrection));/*Need to double check*/
        }
        if (_AmbaItuner_Check_Reg(ITUNER_CFA_LEAKAGE_FILTER, GData.CfaLeakageFilter.Enb)) {
            CHECK_RET(0,  amba_img_dsp_set_cfa_leakage_filter(fd_iav, &Mode, &GData.CfaLeakageFilter));/*Need to double check*/
        }
        if (_AmbaItuner_Check_Reg(ITUNER_CFA_NOISE_FILTER, GData.CfaNoiseFilter.Enb)) {
            CHECK_RET(0,  amba_img_dsp_set_cfa_noise_filter(fd_iav, &Mode, &GData.CfaNoiseFilter));/*Need to double check*/
        }
        if (_AmbaItuner_Check_Reg(ITUNER_ANTI_ALIASING_STRENGTH, GData.AntiAliasing.Enb)) {
            CHECK_RET(0,  amba_img_dsp_set_anti_aliasing(fd_iav, &Mode, &GData.AntiAliasing));/*Need to double check*/
        }
        if (_AmbaItuner_Check_Reg(ITUNER_DGAIN_SATURATION_LEVEL, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_dgain_saturation_level(fd_iav, &Mode, &GData.DgainSaturationLevel));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_LOCAL_EXPOSURE, GData.LocalExposure.Enb)) {
            CHECK_RET(0,  amba_img_dsp_set_local_exposure(fd_iav, &Mode, &GData.LocalExposure));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_TONE_CURVE, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_tone_curve(fd_iav, &Mode, &GData.ToneCurve));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_RGB_TO_YUV_MATRIX, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_rgb_to_yuv_matrix(fd_iav, &Mode, &GData.RgbToYuvMatrix));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_CHROMA_SCALE, GData.ChromaScale.Enb)) {
            CHECK_RET(0,  amba_img_dsp_set_chroma_scale(fd_iav, &Mode, &GData.ChromaScale));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_CHROMA_MEDIAN_FILTER, GData.ChromaMedianFilter.Enable)) {
            CHECK_RET(0,  amba_img_dsp_set_chroma_median_filter(fd_iav, &Mode, &GData.ChromaMedianFilter));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_DEMOSAIC_FILTER, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_demosaic(fd_iav, &Mode, &GData.DemosaicFilter));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_GB_GR_MISMATCH, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_gbgr_mismatch(fd_iav, &Mode, &GData.GbGrMismatch));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_SHP_A_OR_SPATIAL_FILTE_SELECT, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_luma_processing_mode(fd_iav, &Mode, &GData.LisoProcessSelect));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_CDNR, SPECIAL_USE_NONE)) {
            CHECK_RET(0,  amba_img_dsp_set_color_dependent_noise_reduction(fd_iav, &Mode, &GData.CDNR));
        }
        if (_AmbaItuner_Check_Reg(ITUNER_CHROMA_FILTER, GData.ChromaFilter.Enable)) {
            CHECK_RET(0,  amba_img_dsp_set_chroma_filter(fd_iav, &Mode, &GData.ChromaFilter));
        }

        if (GData.LisoProcessSelect.AdvancedFeaturesEnable == 2) { // 2-pass LISO
            // wide chroma filter
            if (_AmbaItuner_Check_Reg(ITUNER_WIDE_CHROMA_FILTER, GData.WideChromaFilter.Enable)) {
                CHECK_RET(0,  amba_img_dsp_set_wide_chroma_filter(fd_iav, &Mode, &GData.WideChromaFilter));
            }
            // wide chroma filter combine
            if (_AmbaItuner_Check_Reg(ITUNER_WIDE_CHROMA_FILTER_COMBINE, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_wide_chroma_filter_combine(fd_iav, &Mode, &GData.WideChromaFilterCombine));
            }

            if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_final_sharpen_noise_both(fd_iav, &Mode, &GData.FinalSharpenBoth));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_final_sharpen_noise_noise(fd_iav, &Mode, &GData.FinalSharpenNoise));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_FINAL_FIR, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_final_sharpen_noise_sharpen_fir(fd_iav, &Mode, &GData.FinalFir));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_FINAL_CORING, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_final_sharpen_noise_sharpen_coring(fd_iav, &Mode, &GData.FinalCoring));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_FINAL_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_final_sharpen_noise_sharpen_coring_index_scale(fd_iav, &Mode, &GData.FinalCoringIndexScale));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_FINAL_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_final_sharpen_noise_sharpen_min_coring_result(fd_iav, &Mode, &GData.FinalMinCoringResult));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SCALE_CORING, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_final_sharpen_noise_sharpen_scale_coring(fd_iav, &Mode, &GData.FinalScaleCoring));
            }
        }

        if ((((GData.LisoProcessSelect.AdvancedFeaturesEnable == 2) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 0) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 3)) && (GData.LisoProcessSelect.UseSharpenNotAsf == 0)) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 1)) {
            if (_AmbaItuner_Check_Reg(ITUNER_ASF_INFO, GData.AsfInfo.Enable)) {
                    CHECK_RET(0,  amba_img_dsp_set_advance_spatial_filter(fd_iav, &Mode, &GData.AsfInfo));
            }
        }
        if ((((GData.LisoProcessSelect.AdvancedFeaturesEnable == 2) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 0) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 3)) && (GData.LisoProcessSelect.UseSharpenNotAsf == 1)) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 1)) {
            if (_AmbaItuner_Check_Reg(ITUNER_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_1st_sharpen_noise_both(fd_iav, &Mode, &GData.SharpenBoth));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_1st_sharpen_noise_noise(fd_iav, &Mode, &GData.SharpenNoise));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_FIR, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_1st_sharpen_noise_sharpen_fir(fd_iav, &Mode, &GData.Fir));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_CORING, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_1st_sharpen_noise_sharpen_coring(fd_iav, &Mode, &GData.Coring));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_1st_sharpen_noise_sharpen_coring_index_scale(fd_iav, &Mode, &GData.CoringIndexScale));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_1st_sharpen_noise_sharpen_min_coring_result(fd_iav, &Mode, &GData.MinCoringResult));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_SCALE_CORING, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_1st_sharpen_noise_sharpen_scale_coring(fd_iav, &Mode, &GData.ScaleCoring));
            }
        }

        if (GData.LisoProcessSelect.AdvancedFeaturesEnable == 3) { // 3-pass LISO
            if (_AmbaItuner_Check_Reg(ITUNER_MO_DYNAMIC_BAD_PIXEL_CORRECTION, GData.MoDynamicBadPixelCorrection.Enb)) {
	            CHECK_RET(0,  amba_img_dsp_set_mo_dynamic_bad_pixel_correction(fd_iav, &Mode, &GData.MoDynamicBadPixelCorrection));/*Need to double check*/
	        }
	        if (_AmbaItuner_Check_Reg(ITUNER_MO_CFA_LEAKAGE_FILTER, GData.MoCfaLeakageFilter.Enb)) {
	            CHECK_RET(0,  amba_img_dsp_set_mo_cfa_leakage_filter(fd_iav, &Mode, &GData.MoCfaLeakageFilter));/*Need to double check*/
	        }
	        if (_AmbaItuner_Check_Reg(ITUNER_MO_CFA_NOISE_FILTER, GData.MoCfaNoiseFilter.Enb)) {
	            CHECK_RET(0,  amba_img_dsp_set_mo_cfa_noise_filter(fd_iav, &Mode, &GData.MoCfaNoiseFilter));/*Need to double check*/
	        }
	        if (_AmbaItuner_Check_Reg(ITUNER_MO_ANTI_ALIASING_STRENGTH, GData.MoAntiAliasing.Enb)) {
	            CHECK_RET(0,  amba_img_dsp_set_mo_anti_aliasing(fd_iav, &Mode, &GData.MoAntiAliasing));/*Need to double check*/
	        }
            if (_AmbaItuner_Check_Reg(ITUNER_MO_CHROMA_MEDIAN_FILTER, GData.MoChromaMedianFilter.Enable)) {
	            CHECK_RET(0,  amba_img_dsp_set_mo_chroma_median_filter(fd_iav, &Mode, &GData.MoChromaMedianFilter));
	        }
	        if (_AmbaItuner_Check_Reg(ITUNER_MO_DEMOSAIC_FILTER, SPECIAL_USE_NONE)) {
	            CHECK_RET(0,  amba_img_dsp_set_mo_demosaic(fd_iav, &Mode, &GData.MoDemosaicFilter));
	        }
	        if (_AmbaItuner_Check_Reg(ITUNER_MO_GB_GR_MISMATCH, SPECIAL_USE_NONE)) {
	            CHECK_RET(0,  amba_img_dsp_set_mo_gbgr_mismatch(fd_iav, &Mode, &GData.MoGbGrMismatch));
	        }

            ////////////////////////////////////////////////////////////////////
	        if (_AmbaItuner_Check_Reg(ITUNER_MO_SHP_A_OR_SPATIAL_FILTE_SELECT, SPECIAL_USE_NONE)) {
				amba_img_dsp_liso_process_select_t MoProcessSelect;
				MoProcessSelect.UseSharpenNotAsf = GData.MoProcessSelect.UseSharpenNotAsf;
				MoProcessSelect.AdvancedFeaturesEnable = GData.LisoProcessSelect.AdvancedFeaturesEnable;
	            CHECK_RET(0,  amba_img_dsp_set_mo_luma_processing_mode(fd_iav, &Mode, &MoProcessSelect));
	        }
	        if (_AmbaItuner_Check_Reg(ITUNER_MO_CHROMA_FILTER, GData.MoChromaFilter.Enable)) {
	            CHECK_RET(0,  amba_img_dsp_set_mo_chroma_filter(fd_iav, &Mode, &GData.MoChromaFilter));
	        }

            if(GData.MoProcessSelect.UseSharpenNotAsf==0){
				if (_AmbaItuner_Check_Reg(ITUNER_MO_ASF_INFO, GData.MoAsfInfo.Enable)) {
	                    CHECK_RET(0,  amba_img_dsp_set_mo_advance_spatial_filter(fd_iav, &Mode, &GData.MoAsfInfo));
	            }
            }
			if(GData.MoProcessSelect.UseSharpenNotAsf==1){
				if (_AmbaItuner_Check_Reg(ITUNER_MO_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
	                CHECK_RET(0,  amba_img_dsp_set_mo_sharpen_noise_both(fd_iav, &Mode, &GData.MoSharpenBoth));
	            }
	            if (_AmbaItuner_Check_Reg(ITUNER_MO_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
	                CHECK_RET(0,  amba_img_dsp_set_mo_sharpen_noise_noise(fd_iav, &Mode, &GData.MoSharpenNoise));
	            }
	            if (_AmbaItuner_Check_Reg(ITUNER_MO_FIR, SPECIAL_USE_NONE)) {
	                CHECK_RET(0,  amba_img_dsp_set_mo_sharpen_noise_sharpen_fir(fd_iav, &Mode, &GData.MoFir));
	            }
	            if (_AmbaItuner_Check_Reg(ITUNER_MO_CORING, SPECIAL_USE_NONE)) {
	                CHECK_RET(0,  amba_img_dsp_set_mo_sharpen_noise_sharpen_coring(fd_iav, &Mode, &GData.MoCoring));
	            }
	            if (_AmbaItuner_Check_Reg(ITUNER_MO_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
	                CHECK_RET(0,  amba_img_dsp_set_mo_sharpen_noise_sharpen_coring_index_scale(fd_iav, &Mode, &GData.MoCoringIndexScale));
	            }
	            if (_AmbaItuner_Check_Reg(ITUNER_MO_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
	                CHECK_RET(0,  amba_img_dsp_set_mo_sharpen_noise_sharpen_min_coring_result(fd_iav, &Mode, &GData.MoMinCoringResult));
	            }
	            if (_AmbaItuner_Check_Reg(ITUNER_MO_SCALE_CORING, SPECIAL_USE_NONE)) {
	                CHECK_RET(0,  amba_img_dsp_set_mo_sharpen_noise_sharpen_scale_coring(fd_iav, &Mode, &GData.MoScaleCoring));
	            }
			}
        }



        if (Mode.Pipe == AMBA_DSP_IMG_PIPE_VIDEO) {
            if (_AmbaItuner_Check_Reg(ITUNER_VIDEO_MCTF, GData.VideoMctf.Enable)) {
                CHECK_RET(0,  amba_img_dsp_set_video_mctf(fd_iav, &Mode, &GData.VideoMctf));
            }
            if (_AmbaItuner_Check_Reg(ITUNER_VIDEO_MCTF_TEMPORAL_ADJUST, SPECIAL_USE_NONE)) {
                CHECK_RET(0,  amba_img_dsp_set_video_mctf_temporal_adjust(fd_iav, &Mode, &GData.VideoMctfTemporalAdjust));
            }
        }
#if 0
        if (Mode.Pipe == AMBA_DSP_IMG_PIPE_VIDEO) {
            if (_AmbaItuner_Check_Reg(ITUNER_VIDEO_MCTF, GData.VideoMctf.Enable)) {
                CHECK_RET(0,  amba_img_dsp_set_video_mctf( &Mode, &GData.VideoMctf));
            } else {
                GData.VideoMctf.Enable = 0;
                CHECK_RET(0,  amba_img_dsp_set_video_mctf( &Mode, &GData.VideoMctf));
            }
            //if (Mode.AlgoMode == AMBA_DSP_IMG_ALGO_MODE_HISO) {
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseBoth(&Mode, &GData.FinalSharpenBoth));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
                    ITUNER_DEBF("%s() %d, FinalSharpenNoise fir_strength_dir: %d", __func__, __LINE__, GData.FinalSharpenNoise.SpatialFir.StrengthDir);
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseNoise(&Mode, &GData.FinalSharpenNoise));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINALFIR, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenFir(&Mode, &GData.FinalFir));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenCoring(&Mode, &GData.FinalCoring));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenCoringIndexScale(&Mode, &GData.FinalCoringIndexScale));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenMinCoringResult(&Mode, &GData.FinalMinCoringResult));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SCALE_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenScaleCoring(&Mode, &GData.FinalScaleCoring));
                }
            //}
        }
//	else {
            if (Mode.AlgoMode == AMBA_DSP_IMG_ALGO_MODE_LISO) {
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseBoth(fd_iav, &Mode, &GData.FinalSharpenBoth));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseNoise(fd_iav, &Mode, &GData.FinalSharpenNoise));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINALFIR, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenFir(fd_iav, &Mode, &GData.FinalFir));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenCoring(fd_iav, &Mode, &GData.FinalCoring));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenCoringIndexScale(fd_iav, &Mode, &GData.FinalCoringIndexScale));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenMinCoringResult(fd_iav, &Mode, &GData.FinalMinCoringResult));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_FINAL_SCALE_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetFinalSharpenNoiseSharpenScaleCoring(fd_iav, &Mode, &GData.FinalScaleCoring));
                }
            } else if (Mode.AlgoMode == AMBA_DSP_IMG_ALGO_MODE_HISO) {
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_ANTI_ALIASING_STRENGTH, GData.HisoAntiAliasingStrength)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoAntiAliasing(&Mode, GData.HisoAntiAliasingStrength));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CFA_LEAKAGE_FILTER, GData.HisoCfaLeakageFilter.Enb)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoCfaLeakageFilter( &Mode, &GData.HisoCfaLeakageFilter));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_DYNAMIC_BAD_PIXEL_CORRECTION, GData.HisoDynamicBadPixelCorrection.Enb)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoDynamicBadPixelCorrection( &Mode, &GData.HisoDynamicBadPixelCorrection));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CFA_NOISE_FILTER, GData.HisoCfaNoiseFilter.Enb)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoCfaNoiseFilter(&Mode, &GData.HisoCfaNoiseFilter));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_GB_GR_MISMATCH, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoGbGrMismatch( &Mode, &GData.HisoGbGrMismatch));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_DEMOSAIC_FILTER, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoDemosaic( &Mode, &GData.HisoDemosaicFilter));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_MEDIAN_FILTER, GData.HisoChromaMedianFilter.Enable)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoChromaMedianFilter( &Mode, &GData.HisoChromaMedianFilter));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CDNR, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoColorDependentNoiseReduction(&Mode, &GData.HisoCDNR));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_DEFER_COLOR_CORRECTION, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoDeferColorCorrection(&Mode, &GData.HisoDeferColorCorrection));
                }
                //Hiso Asf
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_ASF, GData.HisoAsf.Enable)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoAdvanceSpatialFilter(&Mode, &GData.HisoAsf));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_HIGH_ASF, GData.HisoHighAsf.Enable)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoHighAdvanceSpatialFilter(&Mode, &GData.HisoHighAsf));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LOW_ASF, GData.HisoLowAsf.Enable)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLowAdvanceSpatialFilter(&Mode, &GData.HisoLowAsf));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_MED_ASF, GData.HisoMedAsf.Enable)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoMed1AdvanceSpatialFilter(&Mode, &GData.HisoMedAsf));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LI2ND_ASF, GData.HisoLi2ndAsf.Enable)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLi2ndAdvanceSpatialFilter(&Mode, &GData.HisoLi2ndAsf));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_ASF, GData.HisoChromaAsf.Enable)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoChromaAdvanceSpatialFilter(&Mode, &GData.HisoChromaAsf));
                }
                //Hiso Sharpen hi_high_
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_HIGH_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoHighSharpenNoiseBoth(&Mode, &GData.HisoHighSharpenBoth));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_HIGH_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoHighSharpenNoiseNoise(&Mode, &GData.HisoHighSharpenNoise));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_HIGH_FIR, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoHighSharpenNoiseSharpenFir(&Mode, &GData.HisoHighFir));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_HIGH_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoHighSharpenNoiseSharpenCoring(&Mode, &GData.HisoHighCoring));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_HIGH_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoHighSharpenNoiseSharpenCoringIndexScale(&Mode, &GData.HisoHighCoringIndexScale));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_HIGH_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoHighSharpenNoiseSharpenMinCoringResult(&Mode, &GData.HisoHighMinCoringResult));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_HIGH_SCALE_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoHighSharpenNoiseSharpenScaleCoring(&Mode, &GData.HisoHighScaleCoring));
                }
                //Hiso Sharpen hi_med_
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_MED_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoMedSharpenNoiseBoth(&Mode, &GData.HisoMedSharpenBoth));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_MED_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoMedSharpenNoiseNoise(&Mode, &GData.HisoMedSharpenNoise));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_MED_FIR, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoMedSharpenNoiseSharpenFir(&Mode, &GData.HisoMedFir));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_MED_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoMedSharpenNoiseSharpenCoring(&Mode, &GData.HisoMedCoring));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_MED_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoMedSharpenNoiseSharpenCoringIndexScale(&Mode, &GData.HisoMedCoringIndexScale));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_MED_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoMedSharpenNoiseSharpenMinCoringResult(&Mode, &GData.HisoMedMinCoringResult));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_MED_SCALE_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoMedSharpenNoiseSharpenScaleCoring(&Mode, &GData.HisoMedScaleCoring));
                }
                //Hiso Sharpen hili_
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO1_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso1SharpenNoiseBoth(&Mode, &GData.HisoLiso1SharpenBoth));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO1_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso1SharpenNoiseNoise(&Mode, &GData.HisoLiso1SharpenNoise));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO1_FIR, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso1SharpenNoiseSharpenFir(&Mode, &GData.HisoLiso1Fir));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO1_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso1SharpenNoiseSharpenCoring(&Mode, &GData.HisoLiso1Coring));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO1_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso1SharpenNoiseSharpenCoringIndexScale(&Mode, &GData.HisoLiso1CoringIndexScale));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO1_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso1SharpenNoiseSharpenMinCoringResult(&Mode, &GData.HisoLiso1MinCoringResult));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO1_SCALE_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso1SharpenNoiseSharpenScaleCoring(&Mode, &GData.HisoLiso1ScaleCoring));
                }
                //Hiso Sharpen li_2nd_
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO2_SHARPEN_BOTH, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso2SharpenNoiseBoth(&Mode, &GData.HisoLiso2SharpenBoth));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO2_SHARPEN_NOISE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso2SharpenNoiseNoise(&Mode, &GData.HisoLiso2SharpenNoise));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO2_FIR, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso2SharpenNoiseSharpenFir(&Mode, &GData.HisoLiso2Fir));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO2_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso2SharpenNoiseSharpenCoring(&Mode, &GData.HisoLiso2Coring));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO2_CORING_INDEX_SCALE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso2SharpenNoiseSharpenCoringIndexScale(&Mode, &GData.HisoLiso2CoringIndexScale));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO2_MIN_CORING_RESULT, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso2SharpenNoiseSharpenMinCoringResult(&Mode, &GData.HisoLiso2MinCoringResult));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LISO2_SCALE_CORING, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgSetHighIsoLiso2SharpenNoiseSharpenScaleCoring(&Mode, &GData.HisoLiso2ScaleCoring));
                }
                //Chroma
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_HIGH, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterHigh(&Mode, &GData.HisoChromaFilterHigh));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_LOW_VERY_LOW, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterLowVeryLow(&Mode, &GData.HisoChromaFilterLowVeryLow));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_PRE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterPre(&Mode, &GData.HisoChromaFilterPre));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_MED, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterMed(&Mode, &GData.HisoChromaFilterMed));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_LOW, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterLow(&Mode, &GData.HisoChromaFilterLow));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_VERY_LOW, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterVeryLow(&Mode, &GData.HisoChromaFilterVeryLow));
                }
                //Combine
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_MED_COMBINE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterMedCombine(&Mode, &GData.HisoChromaFilterMedCombine));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_LOW_COMBINE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterLowCombine(&Mode, &GData.HisoChromaFilterLowCombine));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_CHROMA_FILTER_VERY_LOW_COMBINE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetChromaFilterVeryLowCombine(&Mode, &GData.HisoChromaFilterVeryLowCombine));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LUMA_NOISE_COMBINE, SPECIAL_USE_NONE )) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetLumaNoiseCombine(&Mode, &GData.HisoLumaNoiseCombine));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LOW_ASF_COMBINE, SPECIAL_USE_NONE )) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetLowASFCombine(&Mode, &GData.HisoLowASFCombine));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HIGH_ISO_COMBINE, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetHighIsoCombine(&Mode, &GData.HighIsoCombine));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_FREQ_RECOVER, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetHighIsoFreqRecover(&Mode, &GData.HisoFreqRecover));
                }
                if (_AmbaItuner_Check_Reg(ITUNER_HISO_LOW2_LUMA_BLEND, SPECIAL_USE_NONE)) {
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoSetHighIsoLumaBlend(&Mode, &GData.HisoLow2LumaBlend));
                }
                if(GData.HisoLow2LumaBlend.Enable == 1) {
                    if (_AmbaItuner_Check_Reg(ITUNER_HISO_LOW2_BLEND_LUMA_LEVEL, SPECIAL_USE_NONE)) {
                        CHECK_RET(0,  AmbaDSP_ImgHighIsoSetHighIsoBlendLumaLevel(&Mode, &GData.HisoLow2BlendLumaLevel));
                    }
                }

                /*{//to hiso batch
                    amba_img_dsp_mode_cfg_t ModeHisoBatch;
                    ModeHisoBatch = Mode;
                    ModeHisoBatch.BatchId = ProcInfo->HisoBatchId;
                    if (_AmbaItuner_Check_Reg(ITUNER_STATIC_BAD_PIXEL_CORRECTION, GData.StaticBadPixelCorrection.Enable)) {
                        CHECK_RET(0,  amba_img_dsp_set_static_bad_pixel_correction(fd_iav, ModeHisoBatch, &GData.SbpCorr));
                    }
                    CHECK_RET(0,  amba_img_dsp_set_vignette_compensation(fd_iav, ModeHisoBatch));
//                    CHECK_RET(0,  AmbaDSP_ImgSetWarpCompensation(ModeHisoBatch));
//                    CHECK_RET(0,  AmbaDSP_ImgSetCawarpCompensation(ModeHisoBatch));
                }*/

            }
//        }
#endif
    } while (0);
    return Ret;
}

int AmbaItuner_Refresh(amba_img_dsp_mode_cfg_t Mode)
{
    int Ret = 0;
    do {
        /*{
            amba_img_dsp_aaa_stat_info_t AAA_Stat_Info;
//            CHECK_RET(0,  AmbaDSP_Img3aGetAaaStatInfo(&Mode, &AAA_Stat_Info));
            _AmbaItuner_Set_Filter_Valid(ITUNER_AE_STATISTICS_INFO);
            GData.AeStatisticsInfo.AeTileNumCol = AAA_Stat_Info.AeTileNumCol;
            GData.AeStatisticsInfo.AeTileNumRow = AAA_Stat_Info.AeTileNumRow;
            GData.AeStatisticsInfo.AeTileColStart = AAA_Stat_Info.AeTileColStart;
            GData.AeStatisticsInfo.AeTileRowStart = AAA_Stat_Info.AeTileRowStart;
            GData.AeStatisticsInfo.AeTileWidth = AAA_Stat_Info.AeTileWidth;
            GData.AeStatisticsInfo.AeTileHeight = AAA_Stat_Info.AeTileHeight;
            GData.AeStatisticsInfo.AePixMinValue = AAA_Stat_Info.AePixMinValue;
            GData.AeStatisticsInfo.AePixMaxValue = AAA_Stat_Info.AePixMaxValue;
            _AmbaItuner_Set_Filter_Valid(ITUNER_AWB_STATISTICS_INFO);
            GData.AwbStatisticsInfo.AwbTileNumCol = AAA_Stat_Info.AwbTileNumCol;
            GData.AwbStatisticsInfo.AwbTileNumRow = AAA_Stat_Info.AwbTileNumRow;
            GData.AwbStatisticsInfo.AwbTileColStart = AAA_Stat_Info.AwbTileColStart;
            GData.AwbStatisticsInfo.AwbTileRowStart = AAA_Stat_Info.AwbTileRowStart;
            GData.AwbStatisticsInfo.AwbTileWidth = AAA_Stat_Info.AwbTileWidth;
            GData.AwbStatisticsInfo.AwbTileHeight = AAA_Stat_Info.AwbTileHeight;
            GData.AwbStatisticsInfo.AwbTileActiveWidth = AAA_Stat_Info.AwbTileActiveWidth;
            GData.AwbStatisticsInfo.AwbTileActiveHeight = AAA_Stat_Info.AwbTileActiveHeight;
            GData.AwbStatisticsInfo.AwbPixMinValue = AAA_Stat_Info.AwbPixMinValue;
            GData.AwbStatisticsInfo.AwbPixMaxValue = AAA_Stat_Info.AwbPixMaxValue;
            _AmbaItuner_Set_Filter_Valid(ITUNER_AF_STATISTICS_INFO);
            GData.AfStatisticsInfo.AfTileNumCol = AAA_Stat_Info.AfTileNumCol;
            GData.AfStatisticsInfo.AfTileNumRow = AAA_Stat_Info.AfTileNumRow;
            GData.AfStatisticsInfo.AfTileColStart = AAA_Stat_Info.AfTileColStart;
            GData.AfStatisticsInfo.AfTileRowStart = AAA_Stat_Info.AfTileRowStart;
            GData.AfStatisticsInfo.AfTileWidth = AAA_Stat_Info.AfTileWidth;
            GData.AfStatisticsInfo.AfTileHeight = AAA_Stat_Info.AfTileHeight;
            GData.AfStatisticsInfo.AfTileActiveWidth = AAA_Stat_Info.AfTileActiveWidth;
            GData.AfStatisticsInfo.AfTileActiveHeight = AAA_Stat_Info.AfTileActiveHeight;
        }*/
        {// Note: static_bad_pixel_correction
            CHECK_RET(0,  amba_img_dsp_get_static_bad_pixel_correction(&Mode, &GData.SbpCorr));
            // TODO: Need to check , warp will use it
            _AmbaItuner_Set_Filter_Valid(ITUNER_SYSTEM_INFO);
            _System.RawStartX = GData.SbpCorr.CurrentVinSensorGeo.StartX;
            _System.RawStartY = GData.SbpCorr.CurrentVinSensorGeo.StartY;
            _System.HSubSampleFactorNum = GData.SbpCorr.CurrentVinSensorGeo.HSubSample.FactorNum;
            _System.HSubSampleFactorDen = GData.SbpCorr.CurrentVinSensorGeo.HSubSample.FactorDen;
            _System.VSubSampleFactorNum = GData.SbpCorr.CurrentVinSensorGeo.VSubSample.FactorNum;
            _System.VSubSampleFactorDen = GData.SbpCorr.CurrentVinSensorGeo.VSubSample.FactorDen;
            _System.RawWidth = GData.SbpCorr.CurrentVinSensorGeo.Width;
            _System.RawHeight = GData.SbpCorr.CurrentVinSensorGeo.Height;
			CHECK_RET(0,  amba_img_dsp_get_vin_sensor_info(&Mode, &GData.SensorInfo));
			_System.RawBayer = GData.SensorInfo.SensorPattern;
			_System.RawResolution = GData.SensorInfo.SensorResolution;
			_System.SensorReadoutMode = GData.SensorInfo.SensorReadOutMode;
			_AmbaItuner_Set_Filter_Valid(ITUNER_STATIC_BAD_PIXEL_CORRECTION);
            GData.StaticBadPixelCorrection.Enable = GData.SbpCorr.Enb;
            GData.StaticBadPixelCorrection.CalibVersion = GData.SbpCorr.CalibSbpInfo.Version;
            GData.StaticBadPixelCorrection.CailbVinStartX = GData.SbpCorr.CalibSbpInfo.VinSensorGeo.StartX;
            GData.StaticBadPixelCorrection.CailbVinStartY = GData.SbpCorr.CalibSbpInfo.VinSensorGeo.StartY;
            GData.StaticBadPixelCorrection.CailbVinWidth = GData.SbpCorr.CalibSbpInfo.VinSensorGeo.Width;
            GData.StaticBadPixelCorrection.CailbVinHeight = GData.SbpCorr.CalibSbpInfo.VinSensorGeo.Height;
            GData.StaticBadPixelCorrection.CailbVinHSubSampleFactorNum = GData.SbpCorr.CalibSbpInfo.VinSensorGeo.HSubSample.FactorNum;
            GData.StaticBadPixelCorrection.CailbVinHSubSampleFactorDen = GData.SbpCorr.CalibSbpInfo.VinSensorGeo.HSubSample.FactorDen;
            GData.StaticBadPixelCorrection.CailbVinVSubSampleFactorNum = GData.SbpCorr.CalibSbpInfo.VinSensorGeo.VSubSample.FactorNum;
            GData.StaticBadPixelCorrection.CailbVinVSubSampleFactorDen = GData.SbpCorr.CalibSbpInfo.VinSensorGeo.VSubSample.FactorDen;
            ITUNER_DEBF("%s() %d, X : %d, Y: %d", __func__, __LINE__, GData.SbpCorr.CalibSbpInfo.VinSensorGeo.StartX, GData.SbpCorr.CalibSbpInfo.VinSensorGeo.StartY);
        }


        {// Note: vignette_compensation
            CHECK_RET(0,  amba_img_dsp_get_vignette_compensation(&Mode, &GData.VignetteCalcInfo));
            _AmbaItuner_Set_Filter_Valid(ITUNER_VIGNETTE_COMPENSATION);
            GData.VignetteCompensation.CalibVinWidth = (GData.VignetteCalcInfo.CurrentVinSensorGeo.StartX << 1) + _System.RawWidth; //GData.VignetteCalcInfo.CurrentVinSensorGeo.StartX = (GData.VignetteCompensation.CalibVinWidth - RawWidth)>>1;
            GData.VignetteCompensation.CalibVinHeight = (GData.VignetteCalcInfo.CurrentVinSensorGeo.StartY << 1) + _System.RawHeight; //GData.VignetteCalcInfo.CurrentVinSensorGeo.StartY = (GData.VignetteCompensation.CalibVinHeight - RawHeight)>>1;
            //_System.RawWidth = GData.VignetteCalcInfo.CurrentVinSensorGeo.Width;
            //_System.RawHeight = GData.VignetteCalcInfo.CurrentVinSensorGeo.Height;
            //_System.HSubSampleFactorNum = GData.VignetteCalcInfo.CurrentVinSensorGeo.HSubSample.FactorNum;
            //_System.HSubSampleFactorDen = GData.VignetteCalcInfo.CurrentVinSensorGeo.HSubSample.FactorDen;
            //_System.VSubSampleFactorNum = GData.VignetteCalcInfo.CurrentVinSensorGeo.VSubSample.FactorNum;
            //_System.VSubSampleFactorDen = GData.VignetteCalcInfo.CurrentVinSensorGeo.VSubSample.FactorDen;

            GData.VignetteCompensation.Enable = GData.VignetteCalcInfo.Enb;
            GData.VignetteCompensation.GainShift = GData.VignetteCalcInfo.GainShift;
            GData.VignetteCompensation.Strength = GData.VignetteCalcInfo.VigStrength;
            GData.VignetteCompensation.CalibVersion = GData.VignetteCalcInfo.CalibVignetteInfo.Version;
            GData.VignetteCompensation.CalibTableWidth = GData.VignetteCalcInfo.CalibVignetteInfo.TableWidth;
            GData.VignetteCompensation.CalibTableHeight = GData.VignetteCalcInfo.CalibVignetteInfo.TableHeight;
            GData.VignetteCompensation.CalibVinStartX = GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.StartX;
            GData.VignetteCompensation.CalibVinStartY = GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.StartY;
            GData.VignetteCompensation.CalibVinWidth = GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.Width;
            GData.VignetteCompensation.CalibVinHeight = GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.Height;
            GData.VignetteCompensation.CailbVinHSubSampleFactorNum = GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.HSubSample.FactorNum;
            GData.VignetteCompensation.CailbVinHSubSampleFactorDen= GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.HSubSample.FactorDen;
            GData.VignetteCompensation.CailbVinVSubSampleFactorNum = GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.VSubSample.FactorNum;
            GData.VignetteCompensation.CailbVinVSubSampleFactorDen = GData.VignetteCalcInfo.CalibVignetteInfo.CalibVinSensorGeo.VSubSample.FactorDen;
    //        GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteRedGain = (UINT16 *)(VignetteTable       + (65*49*2*0));
    //        GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteGreenEvenGain = (UINT16 *)(VignetteTable + (65*49*2*1));
    //        GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteGreenOddGain = (UINT16 *)(VignetteTable  + (65*49*2*2));
    //        GData.VignetteCalcInfo.CalibVignetteInfo.pVignetteBlueGain = (UINT16 *)(VignetteTable      + (65*49*2*3));
        }

        {// Note: warp_compensation
//            CHECK_RET(0,  AmbaDSP_ImgGetWarpCompensation(&Mode, &GData.WarpCalcInfo));
            _AmbaItuner_Set_Filter_Valid(ITUNER_WARP_COMPENSATION);
            GData.WarpCompensation.Enable = GData.WarpCalcInfo.WarpEnb;
            GData.WarpCompensation.CalibVersion = GData.WarpCalcInfo.CalibWarpInfo.Version;
            GData.WarpCompensation.HorizontalGridNumber = GData.WarpCalcInfo.CalibWarpInfo.HorGridNum;
            GData.WarpCompensation.VerticalGridNumber = GData.WarpCalcInfo.CalibWarpInfo.VerGridNum;
            GData.WarpCompensation.TileWidthExponent = GData.WarpCalcInfo.CalibWarpInfo.TileWidthExp;
            GData.WarpCompensation.TileHeightExponent = GData.WarpCalcInfo.CalibWarpInfo.TileHeightExp;
            GData.WarpCompensation.VinSensorStartX = GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.StartX;
            GData.WarpCompensation.VinSensorStartY = GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.StartY;
            GData.WarpCompensation.VinSensorWidth = GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.Width;
            GData.WarpCompensation.VinSensorHeight = GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.Height;
            GData.WarpCompensation.VinSensorHSubSampleFactorNum = GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.HSubSample.FactorNum;
            GData.WarpCompensation.VinSensorHSubSampleFactorDen = GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.HSubSample.FactorDen;
            GData.WarpCompensation.VinSensorVSubSampleFactorNum = GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.VSubSample.FactorNum;
            GData.WarpCompensation.VinSensorVSubSampleFactorDen = GData.WarpCalcInfo.CalibWarpInfo.VinSensorGeo.VSubSample.FactorDen;
            //_System.MainWidth = GData.WarpCalcInfo.MainWinDim.Width;
            //_System.MainHeight = GData.WarpCalcInfo.MainWinDim.Height;
            //_System.RawStartX = GData.WarpCalcInfo.VinSensorGeo.StartX;
            //_System.RawStartY = GData.WarpCalcInfo.VinSensorGeo.StartY;
            //_System.RawWidth = GData.WarpCalcInfo.VinSensorGeo.Width;
            //_System.RawHeight = GData.WarpCalcInfo.VinSensorGeo.Height;
            //_System.HSubSampleFactorNum = GData.WarpCalcInfo.VinSensorGeo.HSubSample.FactorNum;
            //_System.HSubSampleFactorDen = GData.WarpCalcInfo.VinSensorGeo.HSubSample.FactorDen;
            //_System.VSubSampleFactorNum = GData.WarpCalcInfo.VinSensorGeo.VSubSample.FactorNum;
            //_System.VSubSampleFactorDen = GData.WarpCalcInfo.VinSensorGeo.VSubSample.FactorDen;

            //HENRY TBD Get Dzoom Enable AmbaDSP_ImgGetDzoom
            _AmbaItuner_Set_Filter_Valid(ITUNER_DZOOM);
            if ((GData.WarpCalcInfo.R2rOutWinDim.Width == _System.RawWidth) && (GData.WarpCalcInfo.R2rOutWinDim.Height == _System.RawHeight)) {
                GData.Dzoom.Enable = 0;
            } else {
                GData.Dzoom.Enable = 1;
                GData.Dzoom.R2rOutputWidth = GData.WarpCalcInfo.R2rOutWinDim.Width;
                GData.Dzoom.R2rOutputHeigh = GData.WarpCalcInfo.R2rOutWinDim.Height;
                GData.Dzoom.DummyWindowLeftX = GData.WarpCalcInfo.DmyWinGeo.StartX;
                GData.Dzoom.DummyWindowTopY = GData.WarpCalcInfo.DmyWinGeo.StartY;
                GData.Dzoom.DummyWindowWidth = GData.WarpCalcInfo.DmyWinGeo.Width;
                GData.Dzoom.DummyWindowHeight = GData.WarpCalcInfo.DmyWinGeo.Height;
                GData.Dzoom.CfaOutputWidth = GData.WarpCalcInfo.CfaWinDim.Width;
                GData.Dzoom.CfaOutputHeight = GData.WarpCalcInfo.CfaWinDim.Height;
                GData.Dzoom.ActualLeftTopX = GData.WarpCalcInfo.ActWinCrop.LeftTopX;
                GData.Dzoom.ActualLeftTopY = GData.WarpCalcInfo.ActWinCrop.LeftTopY;
                GData.Dzoom.ActualRightBotX = GData.WarpCalcInfo.ActWinCrop.RightBotX;
                GData.Dzoom.ActualRightBotY = GData.WarpCalcInfo.ActWinCrop.RightBotY;
                GData.Dzoom.HorSkewPhaseInc = GData.WarpCalcInfo.HorSkewPhaseInc;
            }
        }
        {// Note: chromatic_aberration_correction
//            CHECK_RET(0,  AmbaDSP_ImgGetCawarpCompensation(&Mode, &GData.CACalcInfo));
            _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_ABERRATION_INFO);
            GData.ChromaAberrationInfo.Enable = GData.CACalcInfo.CaWarpEnb;
            GData.ChromaAberrationInfo.CalibVersion = GData.CACalcInfo.CalibCaWarpInfo.Version;
            GData.ChromaAberrationInfo.HorizontalGridNumber = GData.CACalcInfo.CalibCaWarpInfo.HorGridNum;
            GData.ChromaAberrationInfo.VerticalGridNumber = GData.CACalcInfo.CalibCaWarpInfo.VerGridNum;
            GData.ChromaAberrationInfo.TileWidthExponent = GData.CACalcInfo.CalibCaWarpInfo.TileWidthExp;
            GData.ChromaAberrationInfo.TileHeightExponent = GData.CACalcInfo.CalibCaWarpInfo.TileHeightExp;
            GData.ChromaAberrationInfo.VinSensorStartX = GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.StartX;
            GData.ChromaAberrationInfo.VinSensorStartY = GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.StartY;
            GData.ChromaAberrationInfo.VinSensorWidth = GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.Width;
            GData.ChromaAberrationInfo.VinSensorHeight = GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.Height;
            GData.ChromaAberrationInfo.VinSensorHSubSampleFactorNum = GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.HSubSample.FactorNum;
            GData.ChromaAberrationInfo.VinSensorHSubSampleFactorDen = GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.HSubSample.FactorDen;
            GData.ChromaAberrationInfo.VinSensorVSubSampleFactorNum = GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.VSubSample.FactorNum;
            GData.ChromaAberrationInfo.VinSensorVSubSampleFactorDen = GData.CACalcInfo.CalibCaWarpInfo.VinSensorGeo.VSubSample.FactorDen;
            GData.ChromaAberrationInfo.RedScaleFactor = GData.CACalcInfo.CalibCaWarpInfo.RedScaleFactor;
            GData.ChromaAberrationInfo.BlueScaleFactor = GData.CACalcInfo.CalibCaWarpInfo.BlueScaleFactor;

             //_System.RawStartX = GData.CACalcInfo.VinSensorGeo.StartX;
             //_System.RawStartY = GData.CACalcInfo.VinSensorGeo.StartY;
             //_System.RawWidth = GData.CACalcInfo.VinSensorGeo.Width;
             //_System.RawHeight = GData.CACalcInfo.VinSensorGeo.Height;
             //_System.HSubSampleFactorNum = GData.CACalcInfo.VinSensorGeo.HSubSample.FactorNum;
             //_System.HSubSampleFactorDen = GData.CACalcInfo.VinSensorGeo.HSubSample.FactorDen;
             //_System.VSubSampleFactorNum = GData.CACalcInfo.VinSensorGeo.VSubSample.FactorNum;
             //_System.VSubSampleFactorDen = GData.CACalcInfo.VinSensorGeo.VSubSample.FactorDen;
             GData.WarpCalcInfo.R2rOutWinDim = GData.CACalcInfo.R2rOutWinDim;
             GData.WarpCalcInfo.DmyWinGeo = GData.CACalcInfo.DmyWinGeo;
             GData.WarpCalcInfo.CfaWinDim = GData.CACalcInfo.CfaWinDim;
        }
        {// Note: color_correction
            CHECK_RET(0,  amba_img_dsp_get_color_correction_reg(&Mode, &GData.CcReg));
            CHECK_RET(0,  amba_img_dsp_get_color_correction(&Mode, &GData.CcThreeD));
            _AmbaItuner_Set_Filter_Valid(ITUNER_COLOR_CORRECTION);
        }
        {// Note: static_black_level
            CHECK_RET(0,  amba_img_dsp_get_static_black_level(&Mode, &GData.StaticBlackLevel));
            _AmbaItuner_Set_Filter_Valid(ITUNER_STATIC_BLACK_LEVEL);
        }
        {// Note: wb_gains
            _AmbaItuner_Set_Filter_Valid(ITUNER_WB_GAIN);
            CHECK_RET(0,  amba_img_dsp_get_wb_gain(&Mode, &GData.WbGain));/*OK*/
            _AmbaItuner_Set_Filter_Valid(ITUNER_AE_INFO);
            GData.AeInfo.Dgain = GData.WbGain.AeGain;
            _AmbaItuner_Set_Filter_Valid(ITUNER_GLOBAL_DGAIN);
            GData.GlobalDgain = GData.WbGain.GlobalDGain;
        }
        {// Note: deferred_black_level
            CHECK_RET(0,  amba_img_dsp_get_deferred_black_level(&Mode, &GData.DeferredBlackLevel));
            _AmbaItuner_Set_Filter_Valid(ITUNER_DEFERRED_BLACK_LEVEL);
        }
        {
            _AmbaItuner_Set_Filter_Valid(ITUNER_DYNAMIC_BAD_PIXEL_CORRECTION);
            CHECK_RET(0,  amba_img_dsp_get_dynamic_bad_pixel_correction(&Mode, &GData.DynamicBadPixelCorrection));/*Need to double check*/
        }
        {// Note: li_cfa_leakage_filter
            _AmbaItuner_Set_Filter_Valid(ITUNER_CFA_LEAKAGE_FILTER);
            CHECK_RET(0,  amba_img_dsp_get_cfa_leakage_filter(&Mode, &GData.CfaLeakageFilter));/*Need to double check*/
        }
        {// Note: li_cfa_noise_filter
            _AmbaItuner_Set_Filter_Valid(ITUNER_CFA_NOISE_FILTER);
            CHECK_RET(0,  amba_img_dsp_get_cfa_noise_filter(&Mode, &GData.CfaNoiseFilter));/*Need to double check*/
        }
        {// Note: li_anti_aliasing
            _AmbaItuner_Set_Filter_Valid(ITUNER_ANTI_ALIASING_STRENGTH);
            CHECK_RET(0,  amba_img_dsp_get_anti_aliasing(&Mode, &GData.AntiAliasing));/*Need to double check*/
        }
        {// Note: dgain_saturation_level
            _AmbaItuner_Set_Filter_Valid(ITUNER_DGAIN_SATURATION_LEVEL);
            CHECK_RET(0,  amba_img_dsp_get_dgain_saturation_level(&Mode, &GData.DgainSaturationLevel));/*OK*/
        }
        {// Note: local_exposure
            _AmbaItuner_Set_Filter_Valid(ITUNER_LOCAL_EXPOSURE);
            CHECK_RET(0,  amba_img_dsp_get_local_exposure(&Mode, &GData.LocalExposure));/*Need to double check*/
        }
        {// Note: tone_curve
            _AmbaItuner_Set_Filter_Valid(ITUNER_TONE_CURVE);
            CHECK_RET(0,  amba_img_dsp_get_tone_curve(&Mode, &GData.ToneCurve));/*Need to double check*/
        }
        {// Note: rgb_to_yuv_matrix
            _AmbaItuner_Set_Filter_Valid(ITUNER_RGB_TO_YUV_MATRIX);
            CHECK_RET(0,  amba_img_dsp_get_rgb_to_yuv_matrix(&Mode, &GData.RgbToYuvMatrix));/*OK*/
        }
        {// Note: chroma_scale
            _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_SCALE);
            CHECK_RET(0,  amba_img_dsp_get_chroma_scale(&Mode, &GData.ChromaScale));/*Need to double check*/
        }
        {// Note: li_chroma_median_filter
            _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_MEDIAN_FILTER);
            CHECK_RET(0,  amba_img_dsp_get_chroma_median_filter(&Mode, &GData.ChromaMedianFilter));/*Need to double check*/
        }

        {// Note: li_demosaic
            _AmbaItuner_Set_Filter_Valid(ITUNER_DEMOSAIC_FILTER);
            CHECK_RET(0,  amba_img_dsp_get_demosaic(&Mode, &GData.DemosaicFilter));/*Need to check*/
        }
        {// Note: li_gb_gr_mismatch_correct
            _AmbaItuner_Set_Filter_Valid(ITUNER_GB_GR_MISMATCH);
            CHECK_RET(0,  amba_img_dsp_get_gbgr_mismatch(&Mode, &GData.GbGrMismatch));/*Need to check*/
        }
        {// Note: li_use_1st_sharpen
            _AmbaItuner_Set_Filter_Valid(ITUNER_SHP_A_OR_SPATIAL_FILTE_SELECT);
            CHECK_RET(0,  amba_img_dsp_get_luma_processing_mode(&Mode, &GData.LisoProcessSelect));
        }
        {// Note: li_color_dependent_luma_noise_reduction
            _AmbaItuner_Set_Filter_Valid(ITUNER_CDNR);
            CHECK_RET(0,  amba_img_dsp_get_color_dependent_noise_reduction(&Mode, &GData.CDNR));/*Need to check*/
        }
        {// Note: li_chroma_filter
            _AmbaItuner_Set_Filter_Valid(ITUNER_CHROMA_FILTER);
            CHECK_RET(0,  amba_img_dsp_get_chroma_filter(&Mode, &GData.ChromaFilter));/*OK*/
        }

		if (GData.LisoProcessSelect.AdvancedFeaturesEnable == 2) { // 2-pass LISO
			// wide chroma filter
			_AmbaItuner_Set_Filter_Valid(ITUNER_WIDE_CHROMA_FILTER);
			CHECK_RET(0,  amba_img_dsp_get_wide_chroma_filter(&Mode, &GData.WideChromaFilter));

			// wide chroma filter combine
			_AmbaItuner_Set_Filter_Valid(ITUNER_WIDE_CHROMA_FILTER_COMBINE);
			CHECK_RET(0,  amba_img_dsp_get_wide_chroma_filter_combine(&Mode, &GData.WideChromaFilterCombine));

			_AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SHARPEN_BOTH);
			CHECK_RET(0,  amba_img_dsp_get_final_sharpen_noise_both(&Mode, &GData.FinalSharpenBoth));

			_AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SHARPEN_NOISE);
			CHECK_RET(0,  amba_img_dsp_get_final_sharpen_noise_noise(&Mode, &GData.FinalSharpenNoise));

			_AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_FIR);
			CHECK_RET(0,  amba_img_dsp_get_final_sharpen_noise_sharpen_fir(&Mode, &GData.FinalFir));

			_AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_CORING);
			CHECK_RET(0,  amba_img_dsp_get_final_sharpen_noise_sharpen_coring(&Mode, &GData.FinalCoring));

			_AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_CORING_INDEX_SCALE);
			CHECK_RET(0,  amba_img_dsp_get_final_sharpen_noise_sharpen_coring_index_scale(&Mode, &GData.FinalCoringIndexScale));

			_AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_MIN_CORING_RESULT);
			CHECK_RET(0,  amba_img_dsp_get_final_sharpen_noise_sharpen_min_coring_result(&Mode, &GData.FinalMinCoringResult));

			_AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SCALE_CORING);
			CHECK_RET(0,  amba_img_dsp_get_final_sharpen_noise_sharpen_scale_coring(&Mode, &GData.FinalScaleCoring));
		}
        if ((((GData.LisoProcessSelect.AdvancedFeaturesEnable == 2) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 0) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 3)) && (GData.LisoProcessSelect.UseSharpenNotAsf == 0)) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 1)) {
            // Note: li_advanced_spatial_filter
            _AmbaItuner_Set_Filter_Valid(ITUNER_ASF_INFO);
            CHECK_RET(0,  amba_img_dsp_get_advance_spatial_filter(&Mode, &GData.AsfInfo));
        } else if ((((GData.LisoProcessSelect.AdvancedFeaturesEnable == 2) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 0) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 3)) && (GData.LisoProcessSelect.UseSharpenNotAsf == 1)) || (GData.LisoProcessSelect.AdvancedFeaturesEnable == 1)){
            // Note: li_sharpen_noise_filter_both
            _AmbaItuner_Set_Filter_Valid(ITUNER_SHARPEN_BOTH);
            CHECK_RET(0,  amba_img_dsp_get_1st_sharpen_noise_both(&Mode, &GData.SharpenBoth));
            // Note: li_sharpen_noise_filter_noise
            _AmbaItuner_Set_Filter_Valid(ITUNER_SHARPEN_NOISE);
            CHECK_RET(0,  amba_img_dsp_get_1st_sharpen_noise_noise(&Mode, &GData.SharpenNoise));
            // Note: li_sharpen_noise_filter_sharpen
            _AmbaItuner_Set_Filter_Valid(ITUNER_FIR);
            CHECK_RET(0,  amba_img_dsp_get_1st_sharpen_noise_sharpen_fir(&Mode, &GData.Fir));
            // Note: li_sharpen_noise_filter_sharpen_coring
            _AmbaItuner_Set_Filter_Valid(ITUNER_CORING);
            CHECK_RET(0,  amba_img_dsp_get_1st_sharpen_noise_sharpen_coring(&Mode, &GData.Coring));
            // Note: li_sharpen_noise_filter_sharpen_coring_index_scale
            _AmbaItuner_Set_Filter_Valid(ITUNER_CORING_INDEX_SCALE);
            CHECK_RET(0,  amba_img_dsp_get_1st_sharpen_noise_sharpen_coring_index_scale(&Mode, &GData.CoringIndexScale));
            // Note: li_sharpen_noise_filter_sharpen_min_coring_result
            _AmbaItuner_Set_Filter_Valid(ITUNER_MIN_CORING_RESULT);
            CHECK_RET(0,  amba_img_dsp_get_1st_sharpen_noise_sharpen_min_coring_result(&Mode, &GData.MinCoringResult));
            // Note: li_sharpen_noise_filter_sharpen_scale_coring
            _AmbaItuner_Set_Filter_Valid(ITUNER_SCALE_CORING);
            CHECK_RET(0,  amba_img_dsp_get_1st_sharpen_noise_sharpen_scale_coring(&Mode, &GData.ScaleCoring));
        }
		if (GData.LisoProcessSelect.AdvancedFeaturesEnable == 3) { // 3-pass LISO
				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_DYNAMIC_BAD_PIXEL_CORRECTION);
	            CHECK_RET(0,  amba_img_dsp_get_mo_dynamic_bad_pixel_correction(&Mode, &GData.MoDynamicBadPixelCorrection));/*Need to double check*/

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_CFA_LEAKAGE_FILTER);
	            CHECK_RET(0,  amba_img_dsp_get_mo_cfa_leakage_filter(&Mode, &GData.MoCfaLeakageFilter));/*Need to double check*/

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_CFA_NOISE_FILTER);
	            CHECK_RET(0,  amba_img_dsp_get_mo_cfa_noise_filter(&Mode, &GData.MoCfaNoiseFilter));/*Need to double check*/

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_ANTI_ALIASING_STRENGTH);
	            CHECK_RET(0,  amba_img_dsp_get_mo_anti_aliasing(&Mode, &GData.MoAntiAliasing));/*Need to double check*/

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_CHROMA_MEDIAN_FILTER);
	            CHECK_RET(0,  amba_img_dsp_get_mo_chroma_median_filter(&Mode, &GData.MoChromaMedianFilter));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_DEMOSAIC_FILTER);
	            CHECK_RET(0,  amba_img_dsp_get_mo_demosaic(&Mode, &GData.MoDemosaicFilter));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_GB_GR_MISMATCH);
	            CHECK_RET(0,  amba_img_dsp_get_mo_gbgr_mismatch(&Mode, &GData.MoGbGrMismatch));

            ////////////////////////////////////////////////////////////////////
				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_SHP_A_OR_SPATIAL_FILTE_SELECT);
				amba_img_dsp_liso_process_select_t MoProcessSelect;
				MoProcessSelect.UseSharpenNotAsf = GData.MoProcessSelect.UseSharpenNotAsf;
				MoProcessSelect.AdvancedFeaturesEnable = GData.LisoProcessSelect.AdvancedFeaturesEnable;
	            CHECK_RET(0,  amba_img_dsp_get_mo_luma_processing_mode(&Mode, &MoProcessSelect));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_CHROMA_FILTER);
	            CHECK_RET(0,  amba_img_dsp_get_mo_chroma_filter(&Mode, &GData.MoChromaFilter));

            if(GData.MoProcessSelect.UseSharpenNotAsf==0){
				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_ASF_INFO);
                CHECK_RET(0,  amba_img_dsp_get_mo_advance_spatial_filter(&Mode, &GData.MoAsfInfo));
            }
			if(GData.MoProcessSelect.UseSharpenNotAsf==1){
				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_SHARPEN_BOTH);
                CHECK_RET(0,  amba_img_dsp_get_mo_sharpen_noise_both(&Mode, &GData.MoSharpenBoth));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_SHARPEN_NOISE);
                CHECK_RET(0,  amba_img_dsp_get_mo_sharpen_noise_noise(&Mode, &GData.MoSharpenNoise));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_FIR);
                CHECK_RET(0,  amba_img_dsp_get_mo_sharpen_noise_sharpen_fir(&Mode, &GData.MoFir));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_CORING);
                CHECK_RET(0,  amba_img_dsp_get_mo_sharpen_noise_sharpen_coring(&Mode, &GData.MoCoring));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_CORING_INDEX_SCALE);
                CHECK_RET(0,  amba_img_dsp_get_mo_sharpen_noise_sharpen_coring_index_scale(&Mode, &GData.MoCoringIndexScale));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_MIN_CORING_RESULT);
                CHECK_RET(0,  amba_img_dsp_get_mo_sharpen_noise_sharpen_min_coring_result(&Mode, &GData.MoMinCoringResult));

				_AmbaItuner_Set_Filter_Valid(ITUNER_MO_SCALE_CORING);
                CHECK_RET(0,  amba_img_dsp_get_mo_sharpen_noise_sharpen_scale_coring(&Mode, &GData.MoScaleCoring));
			}
        }

        if (Mode.Pipe == AMBA_DSP_IMG_PIPE_VIDEO) {
            {// Note: video_mctf
                _AmbaItuner_Set_Filter_Valid(ITUNER_VIDEO_MCTF);
                CHECK_RET(0,  amba_img_dsp_get_video_mctf(&Mode, &GData.VideoMctf));

				_AmbaItuner_Set_Filter_Valid(ITUNER_VIDEO_MCTF_TEMPORAL_ADJUST);
				CHECK_RET(0,  amba_img_dsp_get_video_mctf_temporal_adjust(&Mode, &GData.VideoMctfTemporalAdjust));
            }
        }
#if 0
        if (Mode.Pipe == AMBA_DSP_IMG_PIPE_VIDEO) {
            {// Note: video_mctf
                _AmbaItuner_Set_Filter_Valid(ITUNER_VIDEO_MCTF);
                CHECK_RET(0,  amba_img_dsp_get_video_mctf(&Mode, &GData.VideoMctf));
            }

            if (Mode.AlgoMode == AMBA_DSP_IMG_ALGO_MODE_HISO) {
                {// Note: final_sharpen_noise_filter_both
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SHARPEN_BOTH);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseBoth(&Mode, &GData.FinalSharpenBoth));
                }
                {// Note: final_sharpen_noise_filter_noise
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SHARPEN_NOISE);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseNoise(&Mode, &GData.FinalSharpenNoise));
                }
                {// Note: final_sharpen_noise_filter_sharpen
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINALFIR);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenFir(&Mode, &GData.FinalFir));
                }
                {// Note: final_sharpen_noise_filter_sharpen_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenCoring(&Mode, &GData.FinalCoring));
                }
                {// Note: final_sharpen_noise_filter_sharpen_coring_index_scale
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_CORING_INDEX_SCALE);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenCoringIndexScale(&Mode, &GData.FinalCoringIndexScale));
                }
                {// Note: final_sharpen_noise_filter_sharpen_min_coring_result
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_MIN_CORING_RESULT);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenMinCoringResult(&Mode, &GData.FinalMinCoringResult));
                }
                {// Note: final_sharpen_noise_filter_sharpen_scale_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SCALE_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenScaleCoring(&Mode, &GData.FinalScaleCoring));
                }

           }
        } else {

            if (Mode.AlgoMode == AMBA_DSP_IMG_ALGO_MODE_LISO) {
                {// Note: final_sharpen_noise_filter_both
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SHARPEN_BOTH);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseBoth(&Mode, &GData.FinalSharpenBoth));
                }
                {// Note: final_sharpen_noise_filter_noise
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SHARPEN_NOISE);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseNoise(&Mode, &GData.FinalSharpenNoise));
                }
                {// Note: final_sharpen_noise_filter_sharpen
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINALFIR);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenFir(&Mode, &GData.FinalFir));
                }
                {// Note: final_sharpen_noise_filter_sharpen_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenCoring(&Mode, &GData.FinalCoring));
                }
                {// Note: final_sharpen_noise_filter_sharpen_coring_index_scale
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_CORING_INDEX_SCALE);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenCoringIndexScale(&Mode, &GData.FinalCoringIndexScale));
                }
                {// Note: final_sharpen_noise_filter_sharpen_min_coring_result
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_MIN_CORING_RESULT);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenMinCoringResult(&Mode, &GData.FinalMinCoringResult));
                }
                {// Note: final_sharpen_noise_filter_sharpen_scale_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_FINAL_SCALE_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetFinalSharpenNoiseSharpenScaleCoring(&Mode, &GData.FinalScaleCoring));
                }
            } else if (Mode.AlgoMode == AMBA_DSP_IMG_ALGO_MODE_HISO) {
                {// Note: hi_anti_aliasing
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_ANTI_ALIASING_STRENGTH);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoAntiAliasing(&Mode, &GData.HisoAntiAliasingStrength));
                }
                {// Note: hi_cfa_leakage_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CFA_LEAKAGE_FILTER);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoCfaLeakageFilter(&Mode, &GData.HisoCfaLeakageFilter));
                }
                {// Note: hi_auto_bad_pixel_correction
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_DYNAMIC_BAD_PIXEL_CORRECTION);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoDynamicBadPixelCorrection(&Mode, &GData.HisoDynamicBadPixelCorrection));
                }
                {// Note: hi_cfa_noise_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CFA_NOISE_FILTER);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoCfaNoiseFilter(&Mode, &GData.HisoCfaNoiseFilter));
                }
                {// Note: hi_gb_gr_mismatch_correct
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_GB_GR_MISMATCH);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoGbGrMismatch(&Mode, &GData.HisoGbGrMismatch));
                }
                {// Note: hi_demosaic
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_DEMOSAIC_FILTER);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoDemosaic(&Mode, &GData.HisoDemosaicFilter));
                }
                {// Note: hi_chroma_median_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_MEDIAN_FILTER);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoChromaMedianFilter(&Mode, &GData.HisoChromaMedianFilter));
                }
                {// Note: hi_color_dependent_luma_noise_reduction
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CDNR);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoColorDependentNoiseReduction(&Mode, &GData.HisoCDNR));
                }
                {// Note: hi_defer_cc
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_DEFER_COLOR_CORRECTION);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoDeferColorCorrection(&Mode, &GData.HisoDeferColorCorrection));
                }
                {// Note: hi_advanced_spatial_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_ASF);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoAdvanceSpatialFilter(&Mode, &GData.HisoAsf));
                }
                {// Note: hi_high_advanced_spatial_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_ASF);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoHighAdvanceSpatialFilter(&Mode, &GData.HisoHighAsf));
                }
                {// Note: hi_low_advanced_spatial_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LOW_ASF);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLowAdvanceSpatialFilter(&Mode, &GData.HisoLowAsf));
                }
                {// Note: hi_med1_advanced_spatial_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_ASF);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoMed1AdvanceSpatialFilter(&Mode, &GData.HisoMedAsf));
                }
                {// Note: li_2nd_advanced_spatial_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LI2ND_ASF);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighisoLi2ndAdvanceSpatialFilter(&Mode, &GData.HisoLi2ndAsf));
                }
                {// Note: hi_chroma_advanced_spatial_filter
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_ASF);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoChromaAdvanceSpatialFilter(&Mode, &GData.HisoChromaAsf));
                }
                {// Note: hi_high_sharpen_noise_filter_both
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_SHARPEN_BOTH);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoHighSharpenNoiseBoth(&Mode, &GData.HisoHighSharpenBoth));
                }
                {// Note: hi_high_sharpen_noise_filter_noise
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_SHARPEN_NOISE);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoHighSharpenNoiseNoise(&Mode, &GData.HisoHighSharpenNoise));
                }
                {// Note: hi_high_sharpen_noise_filter_sharpen
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_FIR);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoHighSharpenNoiseSharpenFir(&Mode, &GData.HisoHighFir));
                }
                {// Note: hi_high_sharpen_noise_filter_sharpen_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoHighSharpenNoiseSharpenCoring(&Mode, &GData.HisoHighCoring));
                }
                {// Note: hi_high_sharpen_noise_filter_sharpen_coring_index_scale
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_CORING_INDEX_SCALE);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoHighSharpenNoiseSharpenCoringIndexScale(&Mode, &GData.HisoHighCoringIndexScale));
                }
                {// Note: hi_high_sharpen_noise_filter_sharpen_min_coring_result
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_MIN_CORING_RESULT);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoHighSharpenNoiseSharpenMinCoringResult(&Mode, &GData.HisoHighMinCoringResult));
                }
                {// Note: hi_high_sharpen_noise_filter_sharpen_scale_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_HIGH_SCALE_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoHighSharpenNoiseSharpenScaleCoring(&Mode, &GData.HisoHighScaleCoring));
                }
                {// Note: hi_med_sharpen_noise_filter_both
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_SHARPEN_BOTH);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoMedSharpenNoiseBoth(&Mode, &GData.HisoMedSharpenBoth));
                }
                {// Note: hi_high_sharpen_noise_filter_noise
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_SHARPEN_NOISE);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoMedSharpenNoiseNoise(&Mode, &GData.HisoMedSharpenNoise));
                }
                {// Note: hi_med_sharpen_noise_filter_sharpen
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_FIR);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoMedSharpenNoiseSharpenFir(&Mode, &GData.HisoMedFir));
                }
                {// Note: hi_med_sharpen_noise_filter_sharpen_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoMedSharpenNoiseSharpenCoring(&Mode, &GData.HisoMedCoring));
                }
                {// Note: hi_med_sharpen_noise_filter_sharpen_coring_index_scale
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_CORING_INDEX_SCALE);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoMedSharpenNoiseSharpenCoringIndexScale(&Mode, &GData.HisoMedCoringIndexScale));
                }
                {// Note: hi_med_sharpen_noise_filter_sharpen_min_coring_result
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_MIN_CORING_RESULT);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoMedSharpenNoiseSharpenMinCoringResult(&Mode, &GData.HisoMedMinCoringResult));
                }
                {// Note: hi_med_sharpen_noise_filter_sharpen_scale_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_MED_SCALE_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoMedSharpenNoiseSharpenScaleCoring(&Mode, &GData.HisoMedScaleCoring));
                }
                {// Note: hili_sharpen_noise_filter_both
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO1_SHARPEN_BOTH);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso1SharpenNoiseBoth(&Mode, &GData.HisoLiso1SharpenBoth));
                }
                {// Note: hili_sharpen_noise_filter_noise
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO1_SHARPEN_NOISE);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso1SharpenNoiseNoise(&Mode, &GData.HisoLiso1SharpenNoise));
                }
                {// Note: hili_sharpen_noise_filter_sharpen
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO1_FIR);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso1SharpenNoiseSharpenFir(&Mode, &GData.HisoLiso1Fir));
                }
                {// Note: hili_sharpen_noise_filter_sharpen_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO1_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso1SharpenNoiseSharpenCoring(&Mode, &GData.HisoLiso1Coring));
                }
                {// Note: hili_sharpen_noise_filter_sharpen_coring_index_scale
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO1_CORING_INDEX_SCALE);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso1SharpenNoiseSharpenCoringIndexScale(&Mode, &GData.HisoLiso1CoringIndexScale));
                }
                {// Note: hili_sharpen_noise_filter_sharpen_min_coring_result
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO1_MIN_CORING_RESULT);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso1SharpenNoiseSharpenMinCoringResult(&Mode, &GData.HisoLiso1MinCoringResult));
                }
                {// Note: hili_sharpen_noise_filter_sharpen_scale_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO1_SCALE_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso1SharpenNoiseSharpenScaleCoring(&Mode, &GData.HisoLiso1ScaleCoring));
                }
                {// Note: li_2nd_sharpen_noise_filter_both
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO2_SHARPEN_BOTH);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso2SharpenNoiseBoth(&Mode, &GData.HisoLiso2SharpenBoth));
                }
                {// Note: li_2nd_sharpen_noise_filter_noise
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO2_SHARPEN_NOISE);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso2SharpenNoiseNoise(&Mode, &GData.HisoLiso2SharpenNoise));
                }
                {// Note: li_2nd_sharpen_noise_filter_sharpen
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO2_FIR);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso2SharpenNoiseSharpenFir(&Mode, &GData.HisoLiso2Fir));
                }
                {// Note: li_2nd_sharpen_noise_filter_sharpen_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO2_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso2SharpenNoiseSharpenCoring(&Mode, &GData.HisoLiso2Coring));
                }
                {// Note: li_2nd_sharpen_noise_filter_sharpen_coring_index_scale
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO2_CORING_INDEX_SCALE);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso2SharpenNoiseSharpenCoringIndexScale(&Mode, &GData.HisoLiso2CoringIndexScale));
                }
                {// Note: li_2nd_sharpen_noise_filter_sharpen_min_coring_result
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO2_MIN_CORING_RESULT);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso2SharpenNoiseSharpenMinCoringResult(&Mode, &GData.HisoLiso2MinCoringResult));
                }
                {// Note: li_2nd_sharpen_noise_filter_sharpen_scale_coring
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LISO2_SCALE_CORING);
                    CHECK_RET(0,  AmbaDSP_ImgGetHighIsoLiso2SharpenNoiseSharpenScaleCoring(&Mode, &GData.HisoLiso2ScaleCoring));
                }
                {// Note: hi_chroma_filter_high
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_HIGH);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterHigh(&Mode, &GData.HisoChromaFilterHigh));
                }
                {// Note: hi_chroma_filter_low_and_very_low
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_LOW_VERY_LOW);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterLowVeryLow(&Mode, &GData.HisoChromaFilterLowVeryLow));
                }
                {// Note: hi_chroma_filter_pre
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_PRE);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterPre(&Mode, &GData.HisoChromaFilterPre));
                }
                {// Note: hi_chroma_filter_med
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_MED);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterMed(&Mode, &GData.HisoChromaFilterMed));
                }
                {// Note: hi_chroma_filter_low
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_LOW);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterLow(&Mode, &GData.HisoChromaFilterLow));
                }
                {// Note: hi_chroma_filter_very_low
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_VERY_LOW);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterVeryLow(&Mode, &GData.HisoChromaFilterVeryLow));
                }
                {// Note: hi_chroma_filter_med_combine
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_MED_COMBINE);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterMedCombine(&Mode, &GData.HisoChromaFilterMedCombine));
                }
                {// Note: hi_chroma_filter_low_combine
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_LOW_COMBINE);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterLowCombine(&Mode, &GData.HisoChromaFilterLowCombine));
                }
                {// Note: hi_chroma_filter_very_low_combine
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_CHROMA_FILTER_VERY_LOW_COMBINE);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetChromaFilterVeryLowCombine(&Mode, &GData.HisoChromaFilterVeryLowCombine));
                }
                {// Note: hi_luma_noise_combine
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LUMA_NOISE_COMBINE);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetLumaNoiseCombine(&Mode, &GData.HisoLumaNoiseCombine));
                }
                {// Note: hi_low_advanced_spatial_filter_combine
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LOW_ASF_COMBINE);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetLowASFCombine(&Mode, &GData.HisoLowASFCombine));
                }
                {// Note: hili_combine
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HIGH_ISO_COMBINE);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetHighIsoCombine(&Mode, &GData.HighIsoCombine));
                }
                {// Note: hili_luma_mid_high_freq_recover
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_FREQ_RECOVER);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetHighIsoFreqRecover(&Mode, &GData.HisoFreqRecover));
                }
                {// Note: hili_2nd_luma_blend
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LOW2_LUMA_BLEND);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetHighIsoLumaBlend(&Mode, &GData.HisoLow2LumaBlend));
                }
                if(GData.HisoLow2LumaBlend.Enable == 1) {
                    // Note: hili_2nd_blend
                    _AmbaItuner_Set_Filter_Valid(ITUNER_HISO_LOW2_BLEND_LUMA_LEVEL);
                    CHECK_RET(0,  AmbaDSP_ImgHighIsoGetHighIsoBlendLumaLevel(&Mode, &GData.HisoLow2BlendLumaLevel));
                }
            }
        }
#endif
    } while (0);
    return Ret;

}



/*
int Calib_Ituner_Init(void)
{

    // Note: tobe delete
    ituner_init();

    memset(&GData, 0x0, sizeof(ITUNER_DATA_s));

    memset(&GTable, 0x0, sizeof(ITUNER_TABLE_s));
    //Liso Sharp and Asf
    GData.SharpenBoth.ThreeD.pTable = GTable.SharpenBothThreeDTable;
    GData.FinalSharpenBoth.ThreeD.pTable = GTable.FinalSharpenBothThreeDTable;
    GData.AsfInfo.Adapt.ThreeD.pTable = GTable.AsfInfoThreeDTable;
    //Hiso Asf
    GData.HisoAsf.Adapt.ThreeD.pTable       = GTable.HisoAsfThreeDTable;
    GData.HisoHighAsf.Adapt.ThreeD.pTable   = GTable.HisoHighAsfThreeDTable;
    GData.HisoLowAsf.Adapt.ThreeD.pTable    = GTable.HisoLowAsfThreeDTable;
    GData.HisoMedAsf.Adapt.ThreeD.pTable   = GTable.HisoMedAsfThreeDTable;
    GData.HisoLi2ndAsf.Adapt.ThreeD.pTable  = GTable.HisoLi2ndAsfThreeDTable;
    GData.HisoChromaAsf.Adapt.ThreeD.pTable = GTable.HisoChromaAsfThreeDTable;
    //HisoHighSharpen
    GData.HisoHighSharpenBoth.ThreeD.pTable = GTable.HisoHighSharpenBothThreeDTable;
    //HisoMedSharpen
    GData.HisoMedSharpenBoth.ThreeD.pTable = GTable.HisoMedSharpenBothThreeDTable;
    //HisoLiso1Sharpen
    GData.HisoLiso1SharpenBoth.ThreeD.pTable = GTable.HisoLiso1SharpenBothThreeDTable;
    //HisoMedSharpen
    GData.HisoLiso2SharpenBoth.ThreeD.pTable = GTable.HisoLiso2SharpenBothThreeDTable;
    //Combine
    GData.HisoChromaFilterMedCombine.ThreeD.pTable = GTable.HisoChromaFilterMedCombineThreeDTable;
    GData.HisoChromaFilterLowCombine.ThreeD.pTable = GTable.HisoChromaFilterLowCombineThreeDTable;
    GData.HisoChromaFilterVeryLowCombine.ThreeD.pTable = GTable.HisoChromaFilterVeryLowCombineThreeDTable;
    GData.HisoLumaNoiseCombine.ThreeD.pTable = GTable.HisoLumaNoiseCombineThreeDTable;
    GData.HisoLowASFCombine.ThreeD.pTable = GTable.HisoLowASFCombineThreeDTable;
    GData.HighIsoCombine.ThreeD.pTable = GTable.HighIsoCombineThreeDTable;

    return 0;
}
*/
/*
int Calib_Ituner_Load(const char * FileName)
{
    return ituner_load(FileName);
}
*/

/*
static int _convert_to_exp_mode(int Mode)
{
    int Rval;
    switch(Mode) {
    case IMG_MODE_VIDEO:
        Rval = IMG_EXP_VIDEO_DIRECT_SET; break;
    case IMG_MODE_STILL:
    case IMG_MODE_LOW_ISO_STILL:
    case IMG_MODE_HIGH_ISO_STILL:
        AmbaPrint("IA2-EXP module doesn't support still parameters");
        Rval = IMG_EXP_VIDEO_DIRECT_SET; break;
    default:
        Rval = IMG_EXP_VIDEO_DIRECT_SET; break;
    }
    return Rval;
}
*/

int Calib_Ituner_Build(amba_img_dsp_mode_cfg_t Mode)
{
#if 0
    reg_t *p_reg;
    ae_info_t still_ae_info, video_ae_info;
    af_tiles_t af_tiles;
    int i, proc_mode, ext_mode;
    UINT32 fpn_mode;
    UINT8  vignette_mode;

    // A7 does not support FAST MODE, it will use LOW ISO instead
    // so if system try to dump FAST MODE config, dump LOW ISO instead
    if (mode == IMG_MODE_STILL)
        mode = IMG_MODE_LOW_ISO_STILL;

    proc_mode = ituner_get_proc_mode();
    ext_mode = ituner_get_tuning_mode_ext();
    AMP_img_algo_cmd(MW_IA_GET_AAA_FUNCTION, &GData.aaa_function, 0);
    if (mode == IMG_MODE_VIDEO) {
        //AMP_img_algo_cmd(MW_IA_GET_EXPOSURE_VALUE, _convert_to_exp_mode(mode), &GData.ae_info);
        AMP_img_algo_cmd(MW_IA_GET_AE_INFO, IMG_MODE_VIDEO, &video_ae_info);
        GData.ae_info.shutter_index = video_ae_info.shutter_index;
        GData.ae_info.agc_index =     video_ae_info.agc_index;
        GData.ae_info.iris_index =    video_ae_info.iris_index;
        GData.ae_info.dgain =         video_ae_info.dgain;
    } else {
        AMP_img_algo_cmd(MW_IA_GET_PREDICTED_AE_INFO, 0, &still_ae_info);
        GData.ae_info.shutter_index = still_ae_info.shutter_index;
        GData.ae_info.agc_index =     still_ae_info.agc_index;
        GData.ae_info.iris_index =    still_ae_info.iris_index;
        GData.ae_info.dgain =         still_ae_info.dgain;
    }

    AMP_img_sensor_cmd(MW_IMG_GET_AE_STAT_INFO, mode, &GData.ae_statistics_info);
    AMP_img_sensor_cmd(MW_IMG_GET_AWB_STAT_INFO, mode, &GData.awb_statistics_info);
    AMP_img_sensor_cmd(MW_IMG_GET_AF_STAT_INFO, mode, &af_tiles);
    GData.af_statistics_info.af_tile_num_col = af_tiles.columns;
    GData.af_statistics_info.af_tile_num_row = af_tiles.rows;
    GData.af_statistics_info.af_tile_col_start = af_tiles.column_start;
    GData.af_statistics_info.af_tile_row_start = af_tiles.row_start;
    GData.af_statistics_info.af_tile_width = af_tiles.width;
    GData.af_statistics_info.af_tile_height = af_tiles.height;
    GData.af_statistics_info.af_tile_active_width = af_tiles.active_width;
    GData.af_statistics_info.af_tile_active_height = af_tiles.active_height;
    //AMP_img_sensor_cmd(MW_IMG_GET_AF_EX);

    fpn_mode = (proc_mode == STILL_PROC ? 1:0);
    AMP_img_sensor_cmd(MW_IMG_FPNCORE_CMD_GEN, fpn_mode, &GData.fpn_correction);
    GData.static_bad_pixel_correction.enable = GData.fpn_correction.enable;
    GData.static_bad_pixel_correction.pixel_map_width = GData.fpn_correction.pixel_map_width;
    GData.static_bad_pixel_correction.pixel_map_height = GData.fpn_correction.pixel_map_height;
    GData.static_bad_pixel_correction.pixel_map_pitch = GData.fpn_correction.fpn_pitch;

    //AMP_img_sensor_cmd(MW_IMG_SET_STATIC_BAD_PIX, IMG_MODE_VIDEO, &GData.static_bad_pixel_correction);

    vignette_mode = (mode == IMG_MODE_VIDEO) ? 0 : 1;
    AMP_img_sensor_cmd(MW_IMG_VIGCORE_GET_VIG, vignette_mode, &GData.vignette_info);
    GData.vignette_compensation.enable = GData.vignette_info.enable;
    GData.vignette_compensation.gain_shift = GData.vignette_info.gain_shift;

    AMP_img_sensor_cmd(MW_IMG_GET_WARP_CONFIG, mode, &GData.warp_dzoom_info);
    GData.warp_compensation.enable = GData.warp_dzoom_info.warp_control;
    GData.warp_compensation.warp_control = GData.warp_dzoom_info.warp_control;
    GData.warp_compensation.grid_array_width = GData.warp_dzoom_info.grid_array_width;
    GData.warp_compensation.grid_array_height = GData.warp_dzoom_info.grid_array_height;
    GData.warp_compensation.horz_grid_spacing_exponent = GData.warp_dzoom_info.horz_grid_spacing_exponent;
    GData.warp_compensation.vert_grid_spacing_exponent = GData.warp_dzoom_info.vert_grid_spacing_exponent;
    GData.warp_compensation.vert_warp_enable = GData.warp_dzoom_info.vert_warp_enable;
    GData.warp_compensation.vert_warp_grid_array_width = GData.warp_dzoom_info.vert_warp_grid_array_width;
    GData.warp_compensation.vert_warp_grid_array_height = GData.warp_dzoom_info.vert_warp_grid_array_height;
    GData.warp_compensation.vert_warp_horz_grid_spacing_exponent = GData.warp_dzoom_info.vert_warp_horz_grid_spacing_exponent;
    GData.warp_compensation.vert_warp_vert_grid_spacing_exponent = GData.warp_dzoom_info.vert_warp_vert_grid_spacing_exponent;

    GData.dzoom.enable = 1;
    GData.dzoom.actual_left_top_x = GData.warp_dzoom_info.actual_left_top_x;
    GData.dzoom.actual_left_top_y = GData.warp_dzoom_info.actual_left_top_y;
    GData.dzoom.actual_right_bot_x = GData.warp_dzoom_info.actual_right_bot_x;
    GData.dzoom.actual_right_bot_y = GData.warp_dzoom_info.actual_right_bot_y;
    GData.dzoom.zoom_x = GData.warp_dzoom_info.zoom_x;
    GData.dzoom.zoom_y = GData.warp_dzoom_info.zoom_y;
    GData.dzoom.x_center_offset = GData.warp_dzoom_info.x_center_offset;
    GData.dzoom.y_center_offset = GData.warp_dzoom_info.y_center_offset;
    GData.dzoom.hor_skew_phase_inc = GData.warp_dzoom_info.hor_skew_phase_inc;
    GData.dzoom.force_v4tap_disable = GData.warp_dzoom_info.force_v4tap_disable;
    GData.dzoom.dummy_window_x_left = GData.warp_dzoom_info.dummy_window_x_left;
    GData.dzoom.dummy_window_y_top = GData.warp_dzoom_info.dummy_window_y_top;
    GData.dzoom.dummy_window_width = GData.warp_dzoom_info.dummy_window_width;
    GData.dzoom.dummy_window_height = GData.warp_dzoom_info.dummy_window_height;
    GData.dzoom.cfa_output_width = GData.warp_dzoom_info.cfa_output_width;
    GData.dzoom.cfa_output_height = GData.warp_dzoom_info.cfa_output_height;

    AMP_img_sensor_cmd(MW_IMG_GET_VIN_SENSOR_INFO, &GData.sensor_info, 0);
    GData.sensor_input_info.sensor_id = GData.sensor_info.sensor_id;
    GData.sensor_input_info.bayer_pattern = GData.sensor_info.sensor_pattern;
    GData.sensor_input_info.sensor_resolution = GData.sensor_info.sensor_resolution;
    GData.sensor_input_info.readout_mode = GData.sensor_info.sensor_readout_mode;

    AMP_img_sensor_cmd(MW_IMG_GET_BLK_LVL, mode, &GData.static_black_level);
    AMP_img_sensor_cmd(MW_IMG_GET_DYNAMIC_BAD_PIX, mode, &GData.dynamic_bad_pixel_correction);
    AMP_img_sensor_cmd(MW_IMG_GET_CFA_LEAK_FLT, mode, &GData.cfa_leakage_filter);
    AMP_img_sensor_cmd(MW_IMG_GET_CFA_NS_FLT, mode, &GData.cfa_noise_filter);
    AMP_img_sensor_cmd(MW_IMG_GET_ANTI_ALIAS, mode, &GData.anti_aliasing_strength);
    AMP_img_algo_cmd(MW_IA_GET_GLOBAL_DGAIN, 0, &GData.global_dgain); //API to be added
    AMP_img_algo_cmd(MW_IA_GET_WB_GAIN, mode, &GData.wb_gain);
    AMP_img_sensor_cmd(MW_IMG_GET_DGAIN_SAT_LVL, mode, &GData.dgain_saturation_level);
    AMP_img_sensor_cmd(MW_IMG_GET_LOCAL_EXPOSURE, mode, &GData.local_exposure);
    AMP_img_sensor_cmd(MW_IMG_GET_CLR_CORR_REG, mode, &GData.cc_reg);
    AMP_img_sensor_cmd(MW_IMG_GET_CLR_CORR, mode, &GData.cc_3d);
    AMP_img_sensor_cmd(MW_IMG_GET_TONE_CURVE, mode, &GData.tone_curve);
    AMP_img_sensor_cmd(MW_IMG_GET_R2Y_MTX, mode, &GData.rgb_to_yuv_matrix);
    AMP_img_sensor_cmd(MW_IMG_GET_CRMA_SCL, mode, &GData.chroma_scale);
    AMP_img_sensor_cmd(MW_IMG_GET_CRMA_MED_FLT, mode, &GData.chroma_median_filter);
    AMP_img_sensor_cmd(MW_IMG_GET_LUMA_HF_NS_RDC, mode, &GData.luma_high_freq_noise_reduction);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_A_MAXCH, mode, &GData.sharp_a_max_change);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_B_MAXCH, mode, &GData.sharp_b_max_change);

    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_A_FIR, mode, &GData.sharp_a_fir);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_B_FIR, mode, &GData.sharp_b_fir);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_A_CORING, mode, &GData.sharp_a_coring);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_B_CORING, mode, &GData.sharp_b_coring);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_A_SRL, mode, &GData.sharp_a_sig_retain_lvl);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_B_SRL, mode, &GData.sharp_b_sig_retain_lvl);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_A_LVL_MIN, mode, &GData.sharp_a_level_min);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_B_LVL_MIN, mode, &GData.sharp_b_level_min);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_A_LVL_OVRAL, mode, &GData.sharp_a_level_overall);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_B_LVL_OVRAL, mode, &GData.sharp_b_level_overall);
    AMP_img_sensor_cmd(MW_IMG_GET_ADV_SPATIAL_FLT, mode, &GData.asf_info);
    AMP_img_sensor_cmd(MW_IMG_GET_VIDEO_SHRP_A_OR_SPATIAL_FLT, mode, &GData.shpA_or_spatial_filter_select);
    if (GData.shpA_or_spatial_filter_select == 0) {
        char *filt_to_be_invalid[] = {
            "a_sharpening_fir",
            "a_sharpening_coring",
            "a_sharpening_signal_retain_level",
            "a_sharpening_level_minimum",
            "a_sharpening_level_overall",
            "a_sharpening_max_change",
            "advanced_spatial_filter",
            NULL
        };
        i = 0;
        while (filt_to_be_invalid[i] != NULL) {
            p_reg = ituner_lookup_reg(filt_to_be_invalid[i]);
            p_reg->valid = 0;
            i++;
        }
    } else if (GData.shpA_or_spatial_filter_select == 1) {
        char *filt_to_be_invalid[] = {
            "advanced_spatial_filter",
            NULL
        };
        i = 0;
        while (filt_to_be_invalid[i] != NULL) {
            p_reg = ituner_lookup_reg(filt_to_be_invalid[i]);
            p_reg->valid = 0;
            i++;
        }
    } else if (GData.shpA_or_spatial_filter_select == 2) {
        char *filt_to_be_invalid[] = {
            "a_sharpening_fir",
            "a_sharpening_coring",
            "a_sharpening_signal_retain_level",
            "a_sharpening_level_minimum",
            "a_sharpening_level_overall",
            "a_sharpening_max_change",
            NULL
        };
        i = 0;
        while (filt_to_be_invalid[i] != NULL) {
            p_reg = ituner_lookup_reg(filt_to_be_invalid[i]);
            p_reg->valid = 0;
            i++;
        }
    }
    AMP_img_sensor_cmd(MW_IMG_GET_CLR_DEP_NS_RDC, mode, &GData.cdnr);
    AMP_img_sensor_cmd(MW_IMG_GET_CLR_CORR_DESAT, mode, &GData.cc_desatutation);
    AMP_img_sensor_cmd(MW_IMG_GET_SHRP_B_LINEAR, mode, &GData.sharp_b_linearization_strength);
    AMP_img_sensor_cmd(MW_IMG_GET_CA_CONFIG, mode, &GData.chroma_aberration);
    GData.chroma_aberration_info.enable = GData.chroma_aberration.enable;
    GData.chroma_aberration_info.horz_warp_enable = GData.chroma_aberration.horz_warp_enable;
    GData.chroma_aberration_info.vert_warp_enable = GData.chroma_aberration.vert_warp_enable;
    GData.chroma_aberration_info.horz_pass_grid_array_width = GData.chroma_aberration.horz_pass_grid_array_width;
    GData.chroma_aberration_info.horz_pass_grid_array_height = GData.chroma_aberration.horz_pass_grid_array_height;
    GData.chroma_aberration_info.horz_pass_horz_grid_spacing_exponent = GData.chroma_aberration.horz_pass_horz_grid_spacing_exponent;
    GData.chroma_aberration_info.horz_pass_vert_grid_spacing_exponent = GData.chroma_aberration.horz_pass_vert_grid_spacing_exponent;
    GData.chroma_aberration_info.vert_pass_grid_array_width = GData.chroma_aberration.vert_pass_grid_array_width;
    GData.chroma_aberration_info.vert_pass_grid_array_height = GData.chroma_aberration.vert_pass_grid_array_height;
    GData.chroma_aberration_info.vert_pass_horz_grid_spacing_exponent = GData.chroma_aberration.vert_pass_horz_grid_spacing_exponent;
    GData.chroma_aberration_info.vert_pass_vert_grid_spacing_exponent = GData.chroma_aberration.vert_pass_vert_grid_spacing_exponent;
    GData.chroma_aberration_info.red_scale_factor = GData.chroma_aberration.red_scale_factor;
    GData.chroma_aberration_info.blue_scale_factor = GData.chroma_aberration.blue_scale_factor;

    if (mode == IMG_MODE_VIDEO) {
        /* invalid LISO/HISO REGS */
        char *filt_to_be_invalid[] = {
            "chroma_filt",
            "luma_level_based_noise_reduction",
            "luma_freq_separation",
            "luma_very_low_freq_filter",
            "luma_detail_preservation",
            "luma_filt_spatial_dependent",
            "high_iso_chroma_filt",
            "high_iso_color_correction",
            "high_iso_chroma_filter_spat_dep",
            "high_iso_chroma_filter_pre",
            "high_iso_chroma_filter_high",
            "high_iso_chroma_filter_med",
            "high_iso_chroma_filter_low",
            "high_iso_chroma_filter_very_low",
            "high_iso_chroma_filter_very_very_low",
            "night_portrait",
            NULL
        };
        i = 0;
        while (filt_to_be_invalid[i] != NULL) {
            p_reg = ituner_lookup_reg(filt_to_be_invalid[i]);
            p_reg->valid = 0;
            i++;
        }
        AMP_img_sensor_cmd(MW_IMG_GET_VIDEO_MCTF_INFO, 0, &GData.video_mctf);

    } else if (mode == IMG_MODE_STILL) {
        char *filt_to_be_invalid[] = {
            "video_mctf",
            "chroma_filt",
            "luma_level_based_noise_reduction",
            "luma_freq_separation",
            "luma_very_low_freq_filter",
            "luma_detail_preservation",
            "luma_filt_spatial_dependent",
            "high_iso_chroma_filt",
            "high_iso_color_correction",
            "high_iso_chroma_filter_spat_dep",
            "high_iso_chroma_filter_pre",
            "high_iso_chroma_filter_high",
            "high_iso_chroma_filter_med",
            "high_iso_chroma_filter_low",
            "high_iso_chroma_filter_very_low",
            "high_iso_chroma_filter_very_very_low",
            "night_portrait",
            NULL
        };
        i = 0;
        while (filt_to_be_invalid[i] != NULL) {
            p_reg = ituner_lookup_reg(filt_to_be_invalid[i]);
            p_reg->valid = 0;
            i++;
        }
    } else if (mode == IMG_MODE_LOW_ISO_STILL) {
        char *filt_to_be_invalid[] = {
            "video_mctf",
            "luma_level_based_noise_reduction",
            "luma_freq_separation",
            "luma_very_low_freq_filter",
            "luma_detail_preservation",
            "luma_filt_spatial_dependent",
            "high_iso_chroma_filt",
            "high_iso_color_correction",
            "high_iso_chroma_filter_spat_dep",
            "high_iso_chroma_filter_pre",
            "high_iso_chroma_filter_high",
            "high_iso_chroma_filter_med",
            "high_iso_chroma_filter_low",
            "high_iso_chroma_filter_very_low",
            "high_iso_chroma_filter_very_very_low",
            "night_portrait",
            NULL
        };
        i = 0;
        while (filt_to_be_invalid[i] != NULL) {
            p_reg = ituner_lookup_reg(filt_to_be_invalid[i]);
            p_reg->valid = 0;
            i++;
        }
        AMP_img_sensor_cmd(MW_IMG_LISO_GET_CRMA_FILT, 0, &GData.chroma_filter);
        if (ext_mode == MULTI_SHOT_MAHDR) {
            idsp_hdr_proc_info_t hdr_proc_info;
            char *filt_to_be_invalid[] = {
                "mf_hiso_mctf",
                "mf_hiso_gmv",
                NULL
            };
            i = 0;

            while (filt_to_be_invalid[i] != NULL) {
                p_reg = ituner_lookup_ext_reg(filt_to_be_invalid[i]);
                p_reg->valid = 0;
                i++;
            }
            hdr_proc_info.le_info    = GData.hdr_local_exposure;
            hdr_proc_info.cnf_info   = GData.hdr_cfa_noise_filter;
            hdr_proc_info.mixer_info = GData.hdr_mixer;
            AMP_img_sensor_cmd(MW_IMG_HDR_GET_PARAM, mode, &hdr_proc_info);
            // temporal store number frames to normal_frame_idx, raw capture always use idx 0 as normal frame
            GData.hdr_control_info.normal_frame_idx  = hdr_proc_info.num_of_frames;
            AMP_img_algo_cmd(MW_IA_HDR_GET_MCTF_STR, &GData.hdr_control_info.mctf_strength, 0);
        }
    } else if (mode == IMG_MODE_HIGH_ISO_STILL) {
        char *filt_to_be_invalid[] = {
            "video_mctf",
            "chroma_filt",
            "a_sharpening_fir",
            "b_sharpening_fir",
            "a_sharpening_coring",
            "b_sharpening_coring",
            "a_sharpening_signal_retain_level",
            "b_sharpening_signal_retain_level",
            "a_sharpening_level_minimum",
            "b_sharpening_level_minimum",
            "a_sharpening_level_overall",
            "b_sharpening_level_overall",
            "a_sharpening_max_change",
            "b_sharpening_max_change",
            "b_sharpening_linearization",
            "night_portrait",
            NULL
        };
        i = 0;
        while (filt_to_be_invalid[i] != NULL) {
            p_reg = ituner_lookup_reg(filt_to_be_invalid[i]);
            p_reg->valid = 0;
            i++;
        }
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_LUMA_LBNR, 0, &GData.luma_level_based_noise_reduction);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_LUMA_FREQ_SEP, 0, &GData.luma_freq_separation);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_LUMA_VL_FREQ, 0, &GData.luma_very_low_freq_filter);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_LUMA_DETAIL_PRE, 0, &GData.luma_detail_preservation);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_LUMA_SPAT_DEP, 0, &GData.luma_filt_spatial_dependent);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_HISO_CRMA_FILT, 0, &GData.high_iso_chroma_filt);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_HISO_CC, 0, &GData.high_iso_color_correction);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_CRMA_SPAT_DEP, 0, &GData.chroma_filter_spatial_dependent);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_CRMA_FILT_PRE, 0, &GData.chroma_filter_pre);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_CRMA_FILT_HIGH, 0, &GData.chroma_filter_high);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_CRMA_FILT_MED, 0, &GData.chroma_filter_med);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_CRMA_FILT_LOW, 0, &GData.chroma_filter_low);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_CRMA_FILT_VL, 0, &GData.chroma_filter_very_low);
        AMP_img_sensor_cmd(MW_IMG_HISO_GET_CRMA_FILT_VVL, 0, &GData.chroma_filter_very_very_low);
        GData.ituner_luma_spa_dep.width = GData.luma_filt_spatial_dependent.width;
        GData.ituner_luma_spa_dep.height = GData.luma_filt_spatial_dependent.height;
        GData.ituner_luma_spa_dep.adaptation = GData.luma_filt_spatial_dependent.adaptation;
        GData.ituner_luma_spa_dep.maxchange = GData.luma_filt_spatial_dependent.maxchange;
        GData.ituner_luma_spa_dep.strength = GData.luma_filt_spatial_dependent.strength;
        GData.ituner_chroma_spa_dep.radius = GData.chroma_filter_spatial_dependent.radius;
        GData.ituner_chroma_spa_dep.width = GData.chroma_filter_spatial_dependent.width;
        GData.ituner_chroma_spa_dep.height = GData.chroma_filter_spatial_dependent.height;
        GData.ituner_chroma_spa_dep.noise_level_cb = GData.chroma_filter_spatial_dependent.noise_level_cb;
        GData.ituner_chroma_spa_dep.noise_level_cr = GData.chroma_filter_spatial_dependent.noise_level_cr;

        if (ext_mode == MULTI_SHOT_MF_HISO) {
            char *filt_to_be_invalid[] = {
                "local_exposure",
                "cfa_noise_filter",
                "hdr_mixer",
                "hdr_control_info",
                NULL
            };
            i = 0;

            while (filt_to_be_invalid[i] != NULL) {
                p_reg = ituner_lookup_ext_reg(filt_to_be_invalid[i]);
                p_reg->valid = 0;
                i++;
            }
            AMP_img_sensor_cmd(MW_IMG_HISO_GET_MF_MCTF, 0, &GData.mf_hiso_mctf_info);
            for (i = 0; i < GData.mf_hiso_mctf_info.num_of_frames; i++)
                AMP_img_sensor_cmd(MW_IMG_HISO_GET_MF_GMV, 0, &GData.mf_hiso_gmv_info[i]);
        }
    } else if (mode == 4) { // night portrait mode
        char *filt_to_be_invalid[] = {
            "aaa_function",
            "ae_info",
            "ae_statistics_info",
            "awb_statistics_info",
            "af_statistics_info",
            "af_statistics_ex_t",
            "static_bad_pixel_correction",
            "vignette_compensation",
            "warp_compensation",
            "static_black_level",
            "auto_bad_pixel_correction",
            "cfa_leakage_filter",
            "cfa_noise_filter",
            "anti_aliasing",
            "global_dgain",
            "wb_gains",
            "dgain_saturation_level",
            "local_exposure",
            "color_correction",
            "tone_curve",
            "rgb_to_yuv_matrix",
            "chroma_scale",
            "chroma_median_filter",
            "dzoom",
            "luma_high_freq_noise_reduction",
            "a_sharpening_fir",
            "b_sharpening_fir",
            "a_sharpening_coring",
            "b_sharpening_coring",
            "a_sharpening_signal_retain_level",
            "b_sharpening_signal_retain_level",
            "a_sharpening_level_minimum",
            "b_sharpening_level_minimum",
            "a_sharpening_level_overall",
            "b_sharpening_level_overall",
            "a_sharpening_max_change",
            "b_sharpening_max_change",
            "video_mctf",
            "vin_sensor_info",
            "color_dependent_noise_reduction",
            "li_use_1st_sharpen_not_asf",
            "b_sharpening_linearization",
            "desaturate_cc",
            "advanced_spatial_filter",
            "chroma_filt",
            "luma_level_based_noise_reduction",
            "luma_freq_separation",
            "luma_very_low_freq_filter",
            "luma_detail_preservation",
            "luma_filt_spatial_dependent",
            "high_iso_chroma_filt",
            "high_iso_color_correction",
            "high_iso_chroma_filter_spat_dep",
            "high_iso_chroma_filter_pre",
            "high_iso_chroma_filter_high",
            "high_iso_chroma_filter_med",
            "high_iso_chroma_filter_low",
            "high_iso_chroma_filter_very_low",
            "high_iso_chroma_filter_very_very_low",
            "chromatic_aberration_correction",
            NULL
        };
        extern int  img_night_portrait_get_flash_noflash_table(UINT16 *table_addr);
        i = 0;
        while (filt_to_be_invalid[i] != NULL) {
            p_reg = ituner_lookup_reg(filt_to_be_invalid[i]);
            p_reg->valid = 0;
            i++;
        }
        AMP_img_sensor_cmd(MW_IMG_NP_GET_FLASH_2ND, mode, &GData.night_portrait.flash_on_2nd_pic);
        img_night_portrait_get_flash_noflash_table(GData.night_portrait.table);
    }
#endif
    return 0;
}
#if 0
void AmbaItuner_RawSrcLoad(UINT32 InputAddr, UINT32 BufSize)
{
    char UniRawPath[256];
    char Mode[] = {'r','\0'};
    AMBA_FS_FILE *pFile;
    int InputPitch;//, TuningModeExt;
    int i;//, f;

    //TuningModeExt = ituner_get_tuning_mode_ext();
    if (_System.InputPicCnt > 1) {
        /*if (tuning_mode_ext == MULTI_SHOT_MAHDR) {
            for (f = _System.input_pic_cnt - 1; f >= 0; f--) {
                asc_to_uni((char *)GData.hdr_raw_info[f].raw_path, uni_rawpath);
                AmbaPrint("_raw_src_load[%d] %s to %X",f,GData.hdr_raw_info[f].raw_path,input_addr);
                pfile = AmbaFS_fopen(uni_rawpath, mode);
                if (pfile != NULL) {
                    input_pitch = ((_System.raw_pitch + 31) >> 5) << 5;
                    for (i = 0; i < _System.raw_height; i++) {
                //        AmbaFS_fread(input_addr, _System.raw_pitch, 1, pfile);
                        input_addr += input_pitch;
                    }
                    AmbaFS_fclose(pfile);
                } else {
                    AmbaPrint("Error: Multi shot raw file %d %s open fail", f, GData.hdr_raw_info[f].raw_path);
                }
            }
        }else {
            //The MF_HISO buffer for ucode computation is in front of raw image
            if (tuning_mode_ext == MULTI_SHOT_MF_HISO) {
                int mf_hiso_extra_buf_size;
                mf_hiso_extra_buf_size = _System.raw_width * _System.raw_height;
                if ((_System.main_width * _System.main_height) > mf_hiso_extra_buf_size)
                    mf_hiso_extra_buf_size = _System.main_width * _System.main_height;
                mf_hiso_extra_buf_size *=3;
                input_addr += mf_hiso_extra_buf_size;
            }
            for (f=0; f<_System.input_pic_cnt; f++) {
                asc_to_uni((char *)GData.hdr_raw_info[f].raw_path, uni_rawpath);
                pfile = AmbaFS_fopen(uni_rawpath, mode);
                if (pfile != NULL) {
                    input_pitch = ((_System.raw_pitch + 31) >> 5) << 5;
                    for (i = 0; i < _System.raw_height; i++) {
                        AmbaFS_fread(input_addr, _System.raw_pitch, 1, pfile);
                        input_addr += input_pitch;
                    }
                    AmbaFS_fclose(pfile);
                } else {
                    AmbaPrint("Error: Multi shot raw file %d %s open fail", f, GData.hdr_raw_info[f].raw_path);
                }
            }
        }*/
    } else {
        asc_to_uni(_System.RawPath, UniRawPath);
        pFile = AmbaFS_fopen(UniRawPath, Mode);
        if (pFile != NULL) {
            InputPitch = ((_System.RawPitch + 31) >> 5) << 5;
            for (i = 0; i < _System.RawHeight; i++) {
                AmbaFS_fread((void *)InputAddr, _System.RawPitch, 1, pFile);
                InputAddr += InputPitch;
            }
            AmbaFS_fclose(pFile);
        }
    }
}
#endif
/*
ITUNER_s G_ituner = {
    Calib_Ituner_Init,
    Calib_Ituner_Load,
    Calib_Ituner_Save,
    Calib_Ituner_Execute,
    Calib_Ituner_Build,
    0
};
*/
