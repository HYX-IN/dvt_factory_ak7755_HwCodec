diff --git a/bin/create_board_mkcfg b/bin/create_board_mkcfg
index f90586c..9570956 100755
--- a/bin/create_board_mkcfg
+++ b/bin/create_board_mkcfg
@@ -1,80 +1,100 @@
-#!/bin/sh
-
-### $1: the board directory path
-
-if [ -d $1 ]
-then
-
-BOARDS=`find $1 -maxdepth 1 -mindepth 1 -type d | sort`
+##
+## Script: create_board_mkcfg
+##
+## History:
+##    2013/03/27 - [Jian Tang] Create
+##
+## Copyright (c) 2016 Ambarella, Inc.
+##
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
+##
 
-### Create Board AmbaConfig
+#!/bin/sh
 
-	file=$1/AmbaConfig
-	rm -rf $file
-	touch $file
+func_create_board_cfg()
+{
+	local file=$1/AmbaConfig
 
-	echo "##" >> $file
-	echo "## boards/AmbaConfig" >> $file
-	echo "##" >> $file
-	echo "## Following content is generated automatically by" >> $file
-	echo "##  create_board_mkcfg: DO NOT EDIT!!" >> $file
-	echo "##" >> $file
-	echo "" >> $file
+	### Create Board AmbaConfig
+	rm -rf "$file"
+	touch "$file"
 
-	echo "choice" >> $file
-	echo "	prompt \"Board\"" >> $file
-	echo "	help" >> $file
-	echo "		Select the board type of the target." >> $file
+	{
+		echo "##"
+		echo "## boards/AmbaConfig"
+		echo "##"
+		echo "## Following content is generated automatically by"
+		echo "##  create_board_mkcfg: DO NOT EDIT!!"
+		echo "##"
+		echo ""
 
-	echo "" >> $file
+		echo "choice"
+		echo "	prompt \"Board\""
+		echo "	help"
+		echo "		Select the board type of the target."
+		echo ""
+	} >> "$file"
 
-	for board in $BOARDS; do
-		if [ -f $board/AmbaConfig ]; then
-			cat $board/AmbaConfig | grep -v '^\#' | grep '^config CONFIG_BSP_BOARD' -A 2 >> $file
-			echo "" >> $file
+	boards_list=$(find "$1" -maxdepth 1 -mindepth 1 -type d | sort)
+	for board in $boards_list; do
+		if [ -f "$board"/AmbaConfig ]; then
+			{
+				grep -v '^\#'  "$board"/AmbaConfig | grep '^config CONFIG_BSP_BOARD' -A 2
+				echo ""
+			} >> "$file"
 		fi
 	done
 
-	echo "endchoice" >> $file
-	echo "" >> $file
+	{
+		echo "endchoice"
+		echo ""
+	} >> "$file"
 
-	for board in $BOARDS; do
-		if [ -f $board/AmbaConfig ]; then
-			echo "" >> $file
-			echo "##### `basename $board`" >> $file
-			echo "" >> $file
-			cat $board/AmbaConfig | grep -v '^\#' | grep '^choice$' -A 9999 >> $file
+	for board in $boards_list; do
+		if [ -f "$board"/AmbaConfig ]; then
+			{
+				echo ""
+				echo "##### $(basename "$board")"
+				echo ""
+				grep -v '^\#' "$board"/AmbaConfig | grep '^choice$' -A 9999
+			} >> "$file"
 		fi
 	done
 
-	echo "" >> $file
+	echo "" >> "$file"
+}
+
+func_main()
+{
+	if [ -d "$1" ]
+	then
+		func_create_board_cfg  "$1"
+	else
+		echo "The board directory ($1) does NOT exist!"
+	fi
+}
+
+### $1: the board directory path
 
-### Create Board Makefile
-#
-#	rm -rf $1/Makefile
-#	touch $1/Makefile
-#
-#	echo "##" >> $1/Makefile
-#	echo "## boards/Makefile" >> $1/Makefile
-#	echo "##" >> $1/Makefile
-#	echo "## Automatically generated by create_board_mkcfg: don't edit" >> $1/Makefile
-#	echo "##" >> $1/Makefile
-#
-#	for board in $BOARDS; do
-#		if [ -f $board/Makefile ]; then
-#			echo "" >> $1/Makefile
-#			echo "##### `basename $board`" >> $1/Makefile
-#			echo "" >> $1/Makefile
-#			cat $board/Makefile | grep -v '^\#' >> $1/Makefile
-#		fi
-#	done
-#
-#	echo "" >> $1/Makefile
-#	echo "#####" >> $1/Makefile
-#	echo "" >> $1/Makefile
-#	echo "export TARGET_PRODUCT" >> $1/Makefile
-#	echo "" >> $1/Makefile
-else
-	echo "The board directory ($1) isn't exist!"
-fi
+func_main  "$1"
 
diff --git a/bin/create_mkcfg b/bin/create_mkcfg
index 6ef3f42..c12c83a 100755
--- a/bin/create_mkcfg
+++ b/bin/create_mkcfg
@@ -4,70 +4,99 @@
 ## History:
 ##    2013/03/27 - [Jian Tang] Create
 ##
-## Copyright (C) 2008-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
 ##
-## Parameter:
-##	$1: the config files directory
-##	$2: the root directory
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 #!/bin/sh
 
+func_create_mkcfg()
+{
+	local cfg="$1"/"$3"
+	local dir=$(basename "$3" .cfg)
+	local path="$2"/"$dir"
 
-if [ -d $1 ]
-then
-	CFGS=`eval ls $1`
+	if [ -d "$path" ]; then
+		local file="$path"/AmbaConfig
+		rm -rf "$file"
+		touch "$file"
 
-	for cfg in $CFGS; do
-		dir=`basename $cfg .cfg`
-		path=$2/$dir
-		cfg=$1/$cfg
+		### The base AmbaConfig file
+		if [ -f "$cfg" ]; then
+			grep -v '^endmenu' "$cfg" >> "$file"
+		fi
 
-		if [ -d $path ]; then
-			file=$path/AmbaConfig
-			rm -rf $file
-			touch $file
+		### Create full AmbaConfig from sub dir
+		{
+			echo "##"
+			echo "## $dir/AmbaConfig"
+			echo "##"
+			echo "## Following content are generated automatically by"
+			echo "##  create_mkcfg: DO NOT EDIT!!"
+			echo "##"
+		} >> "$file"
 
-			### The base AmbaConfig file
-			if [ -f $cfg ]; then
-				cat $cfg | grep -v '^endmenu' >> $file
+		sub_dir_list=$(find "$path" -maxdepth 1 -mindepth 1 -type d | sort)
+		for sub_dir in $sub_dir_list; do
+			if [ -f "$sub_dir"/AmbaConfig ]; then
+				sub_dir_name=$(basename "$sub_dir")
+				if [ "$sub_dir_name" != "third-party" ]; then
+					{
+						echo ""
+						echo "##### $(basename "$sub_dir")"
+						grep  -v  '^\#'   "$sub_dir"/AmbaConfig
+						echo ""
+					}  >> "$file"
+				else
+					## Do nothing to skip "third-party" folder in prebuild
+					echo "" >> "$file"
+				fi
 			fi
+		done
 
-			### Create full AmbaConfig from sub dir
-			echo "##" >> $file
-			echo "## $dir/AmbaConfig" >> $file
-			echo "##" >> $file
-			echo "## Following content are generated automatically by" >> $file
-			echo "##  create_mkcfg: DO NOT EDIT!!" >> $file
-			echo "##" >> $file
+		{
+			echo "## The end of AmbaConfig file"
+			echo "endif"
+			echo ""
+		} >> "$file"
+	fi
+}
 
-			SUB_DIRS=`find $path -maxdepth 1 -mindepth 1 -type d | sort`
-			for sub_dir in $SUB_DIRS; do
-				if [ -f $sub_dir/AmbaConfig ]; then
-					if [ `basename $sub_dir` != "third-party" ]; then
-						echo "" >> $file
-						echo "##### `basename $sub_dir`" >> $file
-						cat $sub_dir/AmbaConfig | grep -v '^\#' >> $file
-						echo "" >> $file
-					else
-						## Do nothing to skip "third-party" folder in prebuild
-						echo "" >> $file
-					fi
-				fi
-			done
+func_main()
+{
+	if [ -d "$1" ]
+	then
+		cfg_list=$(eval ls "$1")
 
-			echo "## The end of AmbaConfig file" >> $file
-			echo "endif" >> $file
-			echo "" >> $file
-		fi
-	done
+		for cfg in $cfg_list; do
+			func_create_mkcfg  "$1"  "$2"  "$cfg"
+		done
+
+	else
+		echo "The board directory ($1) does NOT exist!"
+	fi
+}
 
-else
-	echo "The board directory ($1) isn't exist!"
-fi
+func_main  "$1"  "$2"
 
diff --git a/bin/create_root_mkcfg b/bin/create_root_mkcfg
index f756bdc..3b2938d 100755
--- a/bin/create_root_mkcfg
+++ b/bin/create_root_mkcfg
@@ -1,3 +1,34 @@
+##
+## Script: create_root_mkcfg
+##
+## History:
+##    2013/03/27 - [Jian Tang] Create
+##
+## Copyright (c) 2016 Ambarella, Inc.
+##
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH iDAMAGE.
+##
+
 #!/bin/sh
 
 
@@ -34,6 +65,6 @@ then
 	echo "" >> $file
 
 else
-	echo "The board directory ($1) isn't exist!"
+	echo "The board directory ($1) does NOT exist!"
 fi
 
diff --git a/cfg/app.cfg b/cfg/app.cfg
index 892c4c7..8e2a5be 100644
--- a/cfg/app.cfg
+++ b/cfg/app.cfg
@@ -4,56 +4,103 @@
 ## History:
 ##    2008/01/16 - [Anthony Ginger] Create
 ##
-## Copyright (C) 2008-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 menuconfig BUILD_AMBARELLA_APPLICATION
-	bool "Ambarella Application Configuration"
-	default n
-	help
-		Build Ambarella Application.
+  bool "Ambarella Application Configuration"
+  default n
+  help
+    Build Ambarella Application.
 
 if BUILD_AMBARELLA_APPLICATION
 
 config CONFIG_APP_INSTALL_DIR
-	string "Install Application"
-	default "$(FAKEROOT_DIR)/usr/local/bin"
-	help
-		Install Application to the defined DIR.
+  string "Install Application"
+  default "$(FAKEROOT_DIR)/usr/local/bin"
+  help
+    Install Application to the defined DIR.
 
 config CONFIG_APP_IPCAM_CONFIG_DIR
-	string "Install IPCam Configuration"
-	default "$(FAKEROOT_DIR)/etc/ambaipcam"
-	help
-		Install IPCam Configuration files to the defined DIR.
-
-config BUILD_AMBARELLA_APP_DEBUG
-	bool "Build Ambarella Application with debug info"
-	default n
-	help
-		Build Ambarella Application with debug info
-
-config BUIDL_AMBARELLA_APP_DEBUG_SANITIZE_ADDRESS
-	depends on BUILD_AMBARELLA_APP_DEBUG
-	bool "Build Ambarella Application with debug and sanitize address"
-	default n
-	help
-		Build Ambarella application with debug info and sanitize address
+  string "Install IPCam Configuration"
+  default "$(FAKEROOT_DIR)/etc/ambaipcam"
+  help
+    Install IPCam Configuration files to the defined DIR.
+
+config BUILD_AMBARELLA_SDK_ENABLE_LTO
+  bool "Build Ambarella SDK with LTO (Link Time Optimization) enabled"
+  select CONFIG_IMGPROC_PACKAGE_DYNAMIC_LIB
+  default n
+  help
+    Build Ambarella SDK with LTO enabled
+
+menuconfig BUILD_AMBARELLA_APP_DEBUG
+  bool "Build Ambarella Application with debug info"
+  default n
+  help
+    Build Ambarella Application with debug info
+
+choice
+  bool "Sanitize Type"
+  depends on BUILD_AMBARELLA_APP_DEBUG
+  default BUILD_AMBARELLA_APP_DEBUG_SANITIZE_NONE
+
+config BUILD_AMBARELLA_APP_DEBUG_SANITIZE_NONE
+  bool "Do not enable sanitize debuger"
+  help
+    Do not enable sanitize debuger
+
+config BUILD_AMBARELLA_APP_DEBUG_SANITIZE_ADDRESS
+  bool "Build Ambarella Application with sanitize address"
+  help
+    Build Ambarella application with sanitize address
+
+config BUILD_AMBARELLA_APP_DEBUG_SANITIZE_LEAK
+  bool "Build Ambarella Application with sanitize leak"
+  depends on CONFIG_ARCH_S5 || CONFIG_ARCH_S5L
+  help
+    Build Ambarella application with sanitize leak
+
+config BUILD_AMBARELLA_APP_DEBUG_SANITIZE_THREAD
+  bool "Build Ambarella Application with sanitize thread"
+  depends on CONFIG_ARCH_S5 || CONFIG_ARCH_S5L
+  help
+    Build Ambarella application with sanitize thread
+
+endchoice
 
 config BUILD_AMBAREALLA_CLOUD_LIB
-	bool "Build Ambarella Cloud Library"
-	default y
-	---help---
-		Build Ambarella Cloud Library
+  bool "Build Ambarella Cloud Library"
+  default y
+  ---help---
+    Build Ambarella Cloud Library
 
 config BUILD_AMBAREALLA_CLOUD_AGENT
-	depends on BUILD_AMBAREALLA_CLOUD_LIB
-	bool "Build Ambarella Cloud Agent"
-	default n
-	---help---
-		Build Ambarella Cloud Agent
+  depends on BUILD_AMBAREALLA_CLOUD_LIB
+  bool "Build Ambarella Cloud Agent"
+  default n
+  ---help---
+    Build Ambarella Cloud Agent
+
diff --git a/cfg/kernel.cfg b/cfg/kernel.cfg
index 7a3537a..8625b95 100644
--- a/cfg/kernel.cfg
+++ b/cfg/kernel.cfg
@@ -4,12 +4,29 @@
 ## History:
 ##    2008/05/04 - [Anthony Ginger] Create
 ##
-## Copyright (C) 2004-2008, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 menuconfig BUILD_AMBARELLA_LINUX_KERNEL
diff --git a/cfg/packages.cfg b/cfg/packages.cfg
index a7cb1b4..3f16794 100644
--- a/cfg/packages.cfg
+++ b/cfg/packages.cfg
@@ -4,12 +4,29 @@
 ## History:
 ##    2012/01/16 - [Anthony Ginger] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 menuconfig BUILD_AMBARELLA_PACKAGE
diff --git a/cfg/prebuild.cfg b/cfg/prebuild.cfg
index 945d454..0eb1812 100644
--- a/cfg/prebuild.cfg
+++ b/cfg/prebuild.cfg
@@ -4,12 +4,29 @@
 ## History:
 ##    2012/01/16 - [Anthony Ginger] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 menuconfig CONFIG_AMBARELLA_PREBUILD
diff --git a/cfg/private_drivers.cfg b/cfg/private_drivers.cfg
new file mode 100644
index 0000000..1e9e3b7
--- /dev/null
+++ b/cfg/private_drivers.cfg
@@ -0,0 +1,64 @@
+##
+## kernel/private/drivers/AmbaConfig
+##
+## History:
+##    2017/01/06 - [Jian Tang] Create
+##
+## Copyright (c) 2017 Ambarella, Inc.
+##
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
+##
+
+menuconfig AMBARELLA_COMMON_MACROS
+	depends on BUILD_AMBARELLA_PRIVATE_MODULES
+	bool "Define Common Macros"
+	default y
+	help
+		Define Common Macros.
+
+if AMBARELLA_COMMON_MACROS
+
+config CONFIG_AMBARELLA_MAX_CHANNEL_NUM
+	int "Max VIN Channel Number"
+	depends on (CONFIG_ARCH_S3L || CONFIG_ARCH_S5L)
+	range  1   4
+	default 1
+	help
+		Set Max VIN Channel Number.
+
+config CONFIG_AMBA_MAX_CHAN_NUM
+	int "Max total channel num for all VINs"
+	depends on (CONFIG_ARCH_S5 || CONFIG_ARCH_CV1)
+	range  1   16
+	default 1
+	help
+		Set max total channel num for all VINs.
+
+endif
+
+config AMBARELLA_BUILD_IAV_SYMBOL
+	depends on BUILD_AMBARELLA_PRIVATE_MODULES
+	bool "Build IAV symbol"
+	default n
+	help
+		Build iav symbol for platform drivers.
diff --git a/cfg/private_platform.cfg b/cfg/private_platform.cfg
new file mode 100644
index 0000000..8b2dfc5
--- /dev/null
+++ b/cfg/private_platform.cfg
@@ -0,0 +1,32 @@
+##
+## kernel/private/platform/AmbaConfig
+##
+## History:
+##    2017/01/06 - [Jian Tang] Create
+##
+## Copyright (c) 2017 Ambarella, Inc.
+##
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
+##
+
+
diff --git a/cfg/unit_test.cfg b/cfg/unit_test.cfg
index 3d2773d..54719b2 100644
--- a/cfg/unit_test.cfg
+++ b/cfg/unit_test.cfg
@@ -4,12 +4,29 @@
 ## History:
 ##    2008/05/04 - [Anthony Ginger] Create
 ##
-## Copyright (C) 2004-2008, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 menuconfig BUILD_AMBARELLA_UNIT_TESTS
@@ -26,12 +43,6 @@ config CONFIG_UNIT_TEST_INSTALL_DIR
 	help
 		Install Unit Tests to the defined DIR.
 
-config CONFIG_UNIT_TEST_IMGPROC_PARAM_DIR
-	string "Install Imgproc Library Param"
-	default "$(FAKEROOT_DIR)/etc/idsp"
-	help
-		Install Imgproc Library parameters to the defined DIR.
-
 config BUILD_AMBARELLA_UNIT_TESTS_STATIC
 	bool "Build static version Ambarella Unit tests"
 	default n
diff --git a/cfg/vendors.cfg b/cfg/vendors.cfg
index 5957d4a..4200aba 100644
--- a/cfg/vendors.cfg
+++ b/cfg/vendors.cfg
@@ -4,12 +4,29 @@
 ## History:
 ##    2013/03/22 - [Hanbo Xiao] Create
 ##
-## Copyright (C) 2008-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 menuconfig BUILD_AMBARELLA_VENDORS
diff --git a/core/build_app.mk b/core/build_app.mk
index 7216ebd..2d316e7 100644
--- a/core/build_app.mk
+++ b/core/build_app.mk
@@ -4,12 +4,29 @@
 ## History:
 ##    2012/05/31 - [Cao Rongrong] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 $(if $(LOCAL_TARGET),,$(error $(LOCAL_PATH): LOCAL_TARGET is not defined))
@@ -32,8 +49,6 @@ LOCAL_OBJS	:= $(patsubst $(AMB_TOPDIR)/%.asm, $(AMB_BOARD_OUT)/%.o,$(LOCAL_OBJS)
 LOCAL_OBJS	:= $(filter-out %.a, $(LOCAL_OBJS))
 # final targets
 LOCAL_MODULE	:= $(patsubst $(AMB_TOPDIR)/%, $(AMB_BOARD_OUT)/%, $(LOCAL_PATH))/$(LOCAL_TARGET)
-# define shared library name
-LOCAL_SO_NAME ?= $(LOCAL_TARGET)
 
 # define variables owned by specific $(LOCAL_MODULE)
 __AMB_LIBS__	:= $(patsubst lib%.so, -l%, $(filter %.so,$(LOCAL_LIBS)))
@@ -43,6 +58,7 @@ $(LOCAL_MODULE): PRIVATE_CFLAGS := $(LOCAL_CFLAGS)
 $(LOCAL_MODULE): PRIVATE_AFLAGS := $(LOCAL_AFLAGS)
 $(LOCAL_MODULE): PRIVATE_LDFLAGS := $(__AMB_LIBS__) $(LOCAL_LDFLAGS)
 $(LOCAL_MODULE): PRIVATE_SO_FLAGS := -Wl,-soname,$(LOCAL_SO_NAME)
+$(LOCAL_MODULE): PRIVATE_SO_NAME := $(LOCAL_SO_NAME)
 
 # include dependency files
 -include $(LOCAL_OBJS:%.o=%.P)
@@ -83,11 +99,12 @@ $(LOCAL_MODULE): $(LOCAL_OBJS) $(filter %.a, $(LOCAL_SRCS)) $(LOCAL_LIBS) $(LOCA
 	@mkdir -p $(dir $@)
 	$(if $(findstring static_library, $(PRIVATE_MODULE_TYPE)), $(build-static-library))
 	$(if $(findstring shared_library, $(PRIVATE_MODULE_TYPE)), \
-		$(AMBA_MAKEFILE_V)$(PRIVATE_CXX) $(AMBARELLA_APP_LDFLAGS) $(PRIVATE_SO_FLAGS) -shared -o $@ $(filter-out %.a %.so %make.inc, $^) \
-		$(foreach p, $(PRIVATE_AMB_LIBS), -L$(subst $(AMB_TOPDIR)/,$(AMB_BOARD_OUT)/,$($(p).PATH))) $(PRIVATE_LDFLAGS) && \
-		$(strip-library))
+		$(if $(PRIVATE_SO_NAME), \
+			$(AMBA_MAKEFILE_V)$(PRIVATE_CXX) $(AMBARELLA_APP_LDFLAGS) $(PRIVATE_SO_FLAGS) -fPIC -shared -o $@ $(filter-out %.a %.so %make.inc, $^) \
+			$(foreach p, $(PRIVATE_AMB_LIBS), -L$(subst $(AMB_TOPDIR)/,$(AMB_BOARD_OUT)/,$($(p).PATH))) $(PRIVATE_LDFLAGS) && \
+			$(strip-library), $(error "SONAME is empty, please set LOCAL_SO_NAME for target '$(notdir $@)'...")))
 	$(if $(findstring exectutable, $(PRIVATE_MODULE_TYPE)), \
-		$(AMBA_MAKEFILE_V)$(PRIVATE_CXX) $(AMBARELLA_APP_LDFLAGS) \
+		$(AMBA_MAKEFILE_V)$(PRIVATE_CXX) $(AMBARELLA_APP_LDFLAGS) -fPIE \
 		$(foreach p, $(PRIVATE_AMB_LIBS), -L$(subst $(AMB_TOPDIR)/,$(AMB_BOARD_OUT)/,$($(p).PATH))) \
-		-o $@ $(filter-out %.a %.so %make.inc, $^)  $(PRIVATE_LDFLAGS) &&\
+		-o $@ $(filter-out %.a %.so %.lds %make.inc, $^)  $(PRIVATE_LDFLAGS) &&\
 		$(strip-binary))
diff --git a/core/build_driver.mk b/core/build_driver.mk
index 0ad20cd..a642541 100644
--- a/core/build_driver.mk
+++ b/core/build_driver.mk
@@ -1,12 +1,29 @@
 ## History:
 ##    2011/12/15 - [Cao Rongrong] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 $(if $(filter %Kbuild, $(LOCAL_SRCS)),,$(error $(LOCAL_PATH): No Kbuild))
diff --git a/core/build_ext_driver.mk b/core/build_ext_driver.mk
index ef3d1fd..4d8551f 100644
--- a/core/build_ext_driver.mk
+++ b/core/build_ext_driver.mk
@@ -1,12 +1,29 @@
 ## History:
 ##    2012/09/02 - [Cao Rongrong] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 $(if $(filter %Kbuild, $(LOCAL_SRCS)),,$(error $(LOCAL_PATH): No Kbuild))
diff --git a/core/build_platform_driver.mk b/core/build_platform_driver.mk
new file mode 100644
index 0000000..a75f0c7
--- /dev/null
+++ b/core/build_platform_driver.mk
@@ -0,0 +1,44 @@
+## History:
+##    2012/09/02 - [Cao Rongrong] Create
+##
+## Copyright (c) 2016 Ambarella, Inc.
+##
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
+##
+
+$(if $(filter %Kbuild, $(LOCAL_SRCS)),,$(error $(LOCAL_PATH): No Kbuild))
+
+KBUILD_DIR	:= $(shell cd $(dir $(filter %Kbuild, $(LOCAL_SRCS))) && pwd)
+LOCAL_TARGET	:= $(KBUILD_DIR:$(PLATFORM_DRIVERS_SRCS_DIR)/%=%)
+
+LOCAL_OBJS	:= $(patsubst $(PLATFORM_DRIVERS_SRCS_DIR)/%, $(PLATFORM_DRIVERS_OUT_DIR)/%,$(LOCAL_SRCS))
+
+
+$(PLATFORM_DRIVERS_OUT_DIR)/%: $(PLATFORM_DRIVERS_SRCS_DIR)/%
+	@mkdir -p $(dir $@)
+	@cp -dpRf $< $@
+
+prepare_platform_drivers: $(LOCAL_OBJS)
+
+PLATFORM_DRIVER_MODULES += $(LOCAL_TARGET)/
+
diff --git a/core/build_prebuild.mk b/core/build_prebuild.mk
index fde3287..d94aef6 100644
--- a/core/build_prebuild.mk
+++ b/core/build_prebuild.mk
@@ -4,12 +4,29 @@
 ## History:
 ##    2012/06/03 - [Cao Rongrong] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 $(if $(LOCAL_TARGET),,$(error $(LOCAL_PATH): LOCAL_TARGET is not defined))
diff --git a/core/clear_vars.mk b/core/clear_vars.mk
index 296dc80..40fa6d4 100644
--- a/core/clear_vars.mk
+++ b/core/clear_vars.mk
@@ -4,12 +4,29 @@
 ## History:
 ##    2012/05/31 - [Cao Rongrong] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 LOCAL_SRCS :=
diff --git a/core/configure.mk b/core/configure.mk
index d8e78b2..8a2cc92 100644
--- a/core/configure.mk
+++ b/core/configure.mk
@@ -1,12 +1,29 @@
 ## History:
 ##    2011/12/09 - [Cao Rongrong] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 AMB_BOARD_DIR		:= $(shell pwd)
@@ -27,14 +44,8 @@ export AMB_TOPDIR
 
 ######################## TOOLCHAIN #####################################
 
-ifndef ARM_ELF_TOOLCHAIN_DIR
-$(error Can not find arm-elf toolchain, please source ENV, eg. CodeSourcery.env)
-endif
-ifndef ARM_LINUX_TOOLCHAIN_DIR
-$(error Can not find arm-linux toolchain, please source ENV, eg. CodeSourcery.env)
-endif
 ifndef TOOLCHAIN_PATH
-$(error Can not find arm-linux path, please source ENV, eg. CodeSourcery.env)
+$(error Can not find arm-linux toolchain, please source ENV, eg. Linaro-xxx.env)
 endif
 
 export PATH:=$(TOOLCHAIN_PATH):$(PATH)
@@ -47,6 +58,7 @@ BUILD_APP		:= $(AMB_TOPDIR)/build/core/build_app.mk
 BUILD_DRIVER		:= $(AMB_TOPDIR)/build/core/build_driver.mk
 BUILD_EXT_DRIVER	:= $(AMB_TOPDIR)/build/core/build_ext_driver.mk
 BUILD_PREBUILD		:= $(AMB_TOPDIR)/build/core/build_prebuild.mk
+BUILD_PLATFORM_DRIVER		:= $(AMB_TOPDIR)/build/core/build_platform_driver.mk
 
 
 ########################## BUILD IMAGE TOOLS ###########################
@@ -72,10 +84,13 @@ MKJFFS2 		:= $(AMB_TOPDIR)/rootfs/bin/mkfs.jffs2
 ########################## BOARD #####################################
 
 ifeq ($(DOT_CONFIG), $(wildcard $(DOT_CONFIG)))
-AMBARELLA_ARCH		:= $(shell grep ^CONFIG_ARCH $(DOT_CONFIG) | \
+AMBARELLA_ARCH_HI	:= $(shell grep ^CONFIG_ARCH $(DOT_CONFIG) | \
 				sed -e s/^CONFIG_ARCH_// | \
-				sed -e s/=y// | \
-				tr [:upper:] [:lower:])
+				sed -e s/=y//)
+$(if $(filter $(AMBARELLA_ARCH_HI), $(notdir $(ALL_TOPDIR))), \
+		$(error Don't use $(AMBARELLA_ARCH_HI) as project directory))
+
+AMBARELLA_ARCH		:= $(shell echo $(AMBARELLA_ARCH_HI) | tr [:upper:] [:lower:])
 ifeq ($(AMBARELLA_ARCH), s2e)
 AMBARELLA_ARCH		:= s2
 endif
@@ -103,14 +118,14 @@ endif
 ########################## OUT DIRECTORY ################################
 
 AMB_BOARD_OUT		:= $(AMB_TOPDIR)/out/$(AMB_BOARD)
-# export for building images
-export AMB_BOARD_OUT
-
 KERNEL_OUT_DIR		:= $(AMB_BOARD_OUT)/kernel
 ROOTFS_OUT_DIR		:= $(AMB_BOARD_OUT)/rootfs
 FAKEROOT_DIR		:= $(AMB_BOARD_OUT)/fakeroot
 IMAGES_OUT_DIR		:= $(AMB_BOARD_OUT)/images
 
+export AMB_BOARD_OUT
+export FAKEROOT_DIR
+
 
 ########################## GLOBAL FLAGS ################################
 
@@ -121,25 +136,41 @@ AMBARELLA_AFLAGS	:=
 AMBARELLA_LDFLAGS	:=
 AMBARELLA_CPU_ARCH	:=
 
-ifeq ($(CONFIG_CPU_CORTEXA9_HF), y)
-AMBARELLA_CPU_ARCH = armv7-a-hf
+ifeq ($(CONFIG_CPU_CORTEXA53), y)
+ifeq ($(CONFIG_ARMV8_AARCH32), y)
+AMBARELLA_CPU_ARCH	:= armv8l
+CPU_ARCH		:= arm
+else
+AMBARELLA_CPU_ARCH	:= armv8-a
+CPU_ARCH		:= arm64
+endif
+else ifeq ($(CONFIG_CPU_CORTEXA9_HF), y)
+AMBARELLA_CPU_ARCH	:= armv7-a-hf
+CPU_ARCH		:= arm
 else ifeq ($(CONFIG_CPU_CORTEXA9), y)
-AMBARELLA_CPU_ARCH = armv7-a
+AMBARELLA_CPU_ARCH	:= armv7-a
+CPU_ARCH		:= arm
 else ifeq ($(CONFIG_CPU_ARM1136JS), y)
-AMBARELLA_CPU_ARCH = armv6k
+AMBARELLA_CPU_ARCH	:= armv6k
+CPU_ARCH		:= arm
 else ifeq ($(CONFIG_CPU_ARM926EJS), y)
-AMBARELLA_CPU_ARCH = armv5te
+AMBARELLA_CPU_ARCH	:= armv5te
+CPU_ARCH		:= arm
 endif
 
 ########################## APP FLAGS ###################################
 
 PREBUILD_3RD_PARTY_DIR	:= $(AMB_TOPDIR)/prebuild/third-party/$(AMBARELLA_CPU_ARCH)
+ifneq ($(wildcard $(PREBUILD_3RD_PARTY_DIR)),$(PREBUILD_3RD_PARTY_DIR))
+PREBUILD_3RD_PARTY_DIR	:= $(AMB_TOPDIR)/rootfs/packages/$(AMBARELLA_CPU_ARCH)
+endif
 PREBUILD_3RD_PARTY_NOARCH := $(AMB_TOPDIR)/prebuild/third-party/noarch
 UNIT_TEST_PATH		:= $(shell echo $(CONFIG_UNIT_TEST_INSTALL_DIR))
-UNIT_TEST_IMGPROC_PATH	:= $(shell echo $(CONFIG_UNIT_TEST_IMGPROC_PARAM_DIR))
+UNIT_TEST_IMGPROC_PATH	:= $(shell echo $(CONFIG_IMAGE_DATA_INSTALL_PATH))
 IMGPROC_INSTALL_PATH	:= $(shell echo $(CONFIG_IMGPROC_INSTALL_DIR))
 APP_INSTALL_PATH	:= $(shell echo $(CONFIG_APP_INSTALL_DIR))
 APP_IPCAM_CONFIG_PATH	:= $(shell echo $(CONFIG_APP_IPCAM_CONFIG_DIR))
+export PREBUILD_3RD_PARTY_DIR
 
 ###################### CAMERA MIDDLE-WARE FLAGS ########################
 
@@ -161,6 +192,7 @@ ORYX_CODEC_DIR   := $(FAKEROOT_DIR)/$(shell echo $(BUILD_AMBARELLA_ORYX_CODEC_DI
 ORYX_MUXER_DIR   := $(FAKEROOT_DIR)/$(shell echo $(BUILD_AMBARELLA_ORYX_MUXER_DIR))
 ORYX_DEMUXER_DIR := $(FAKEROOT_DIR)/$(shell echo $(BUILD_AMBARELLA_ORYX_DEMUXER_DIR))
 ORYX_EVENT_PLUGIN_DIR := $(FAKEROOT_DIR)/$(shell echo $(BUILD_AMBARELLA_ORYX_EVENT_PLUGIN_DIR))
+ORYX_VIDEO_PLUGIN_DIR := $(FAKEROOT_DIR)/$(shell echo $(BUILD_AMBARELLA_ORYX_VIDEO_PLUGIN_DIR))
 
 ###################### VENDOR FLAGS ########################
 
@@ -169,7 +201,7 @@ VENDORS_LIB_DIR     := $(FAKEROOT_DIR)/$(shell echo $(BUILD_AMBARELLA_VENDORS_LI
 
 #
 ###################### VENDOR FLAGS ########################
-IMAGE_DATA_DIR		:= $(FAKEROOT_DIR)/etc/idsp
+IMAGE_DATA_DIR		:= $(shell echo $(CONFIG_IMAGE_DATA_INSTALL_PATH))
 
 #
 AMBARELLA_APP_AFLAGS	:= $(AMBARELLA_AFLAGS)
@@ -178,42 +210,60 @@ AMBARELLA_APP_AFLAGS	:= $(AMBARELLA_AFLAGS)
 AMBARELLA_APP_LDFLAGS	:= $(AMBARELLA_LDFLAGS)
 
 #
+AMBARELLA_APP_CFLAGS	:= $(AMBARELLA_CFLAGS) -Wall -fPIC -D_REENTRENT -D_GNU_SOURCE
+
+#
 ifeq ($(BUILD_AMBARELLA_APP_DEBUG), y)
-AMBARELLA_APP_CFLAGS	:= $(AMBARELLA_CFLAGS) -g -O0 -Wall -fPIC -D_REENTRENT -D_GNU_SOURCE
-ifeq ($(BUIDL_AMBARELLA_APP_DEBUG_SANITIZE_ADDRESS), y)
+AMBARELLA_APP_CFLAGS	+= -g -O0 -funwind-tables
+AMBARELLA_APP_LDFLAGS	+= -rdynamic
+ifeq ($(BUILD_AMBARELLA_APP_DEBUG_SANITIZE_ADDRESS), y)
 AMBARELLA_APP_CFLAGS	+= $(call cc-option,-fsanitize=address,)
 AMBARELLA_APP_CFLAGS	+= $(call cc-option,-fno-omit-frame-pointer,)
 AMBARELLA_APP_LDFLAGS	+= $(call cc-option,-fsanitize=address,)
+else
+ifeq ($(BUILD_AMBARELLA_APP_DEBUG_SANITIZE_LEAK), y)
+AMBARELLA_APP_CFLAGS	+= $(call cc-option,-fsanitize=leak,)
+AMBARELLA_APP_CFLAGS	+= $(call cc-option,-fno-omit-frame-pointer,)
+AMBARELLA_APP_LDFLAGS	+= $(call cc-option,-fsanitize=leak,)
+endif
 endif
 else
-AMBARELLA_APP_CFLAGS	:= $(AMBARELLA_CFLAGS) -O3 -Wall -fPIC -D_REENTRENT -D_GNU_SOURCE
+AMBARELLA_APP_CFLAGS	+= -O3
 endif
 
 AMBARELLA_APP_CFLAGS	+= $(call cc-option,-mno-unaligned-access,)
 AMBARELLA_APP_CFLAGS	+= $(call cc-option,-fdiagnostics-color=auto,)
 
-#Disable lto for all gcc 4.x, no prove to be good.
-#Impact 3A & algo, let's test in gcc 5.x.
-AMBARELLA_APP_CFLAGS	+= $(call cc-ifversion, -ge, 0500, -flto,)
-AMBARELLA_APP_LDFLAGS	+= $(call cc-ifversion, -ge, 0500, -flto,)
+ifeq ($(BUILD_AMBARELLA_SDK_ENABLE_LTO), y)
+AMBARELLA_APP_CFLAGS	+= $(call cc-ifversion, -ge, 0500, -flto=4,)
+AMBARELLA_APP_LDFLAGS	+= $(call cc-ifversion, -ge, 0500, -flto=4,)
+endif
 
 ifeq ($(BUILD_AMBARELLA_UNIT_TESTS_STATIC), y)
 AMBARELLA_APP_LDFLAGS	+= -static
 endif
 
-ifeq ($(CONFIG_CPU_CORTEXA9_HF), y)
+ifeq ($(AMBARELLA_CPU_ARCH), armv8-a)
+AMBARELLA_APP_CFLAGS	+= -march=armv8-a -mcpu=cortex-a53+crypto -mlittle-endian
+AMBARELLA_APP_AFLAGS	+= -march=armv8-a -mcpu=cortex-a53+crypto -mlittle-endian
+AMBARELLA_APP_LDFLAGS	+= -march=armv8-a -mcpu=cortex-a53+crypto -mlittle-endian
+else ifeq ($(AMBARELLA_CPU_ARCH), armv8l)
+AMBARELLA_APP_CFLAGS	+= -mthumb -march=armv8-a -mtune=cortex-a53 -mlittle-endian -mfloat-abi=hard -mfpu=crypto-neon-fp-armv8 -Wa,-mimplicit-it=thumb
+AMBARELLA_APP_AFLAGS	+= -mthumb -march=armv8-a -mfloat-abi=hard -mfpu=crypto-neon-fp-armv8 -mimplicit-it=thumb
+AMBARELLA_APP_LDFLAGS	+= -mthumb -march=armv8-a -mtune=cortex-a53 -mlittle-endian -mfloat-abi=hard -mfpu=crypto-neon-fp-armv8 -Wa,-mimplicit-it=thumb
+else ifeq ($(AMBARELLA_CPU_ARCH), armv7-a-hf)
 AMBARELLA_APP_CFLAGS	+= -mthumb -march=armv7-a -mtune=cortex-a9 -mlittle-endian -mfloat-abi=hard -mfpu=neon -Wa,-mimplicit-it=thumb
 AMBARELLA_APP_AFLAGS	+= -mthumb -march=armv7-a -mfloat-abi=hard -mfpu=neon -mimplicit-it=thumb
 AMBARELLA_APP_LDFLAGS	+= -mthumb -march=armv7-a -mtune=cortex-a9 -mlittle-endian -mfloat-abi=hard -mfpu=neon -Wa,-mimplicit-it=thumb
-else ifeq ($(CONFIG_CPU_CORTEXA9), y)
+else ifeq ($(AMBARELLA_CPU_ARCH), armv7-a)
 AMBARELLA_APP_CFLAGS	+= -marm -march=armv7-a -mtune=cortex-a9 -mlittle-endian -mfloat-abi=softfp -mfpu=neon
 AMBARELLA_APP_AFLAGS	+= -march=armv7-a -mfloat-abi=softfp -mfpu=neon
 AMBARELLA_APP_LDFLAGS	+= -marm -march=armv7-a -mtune=cortex-a9 -mlittle-endian -mfloat-abi=softfp -mfpu=neon
-else ifeq ($(CONFIG_CPU_ARM1136JS), y)
+else ifeq ($(AMBARELLA_CPU_ARCH), armv6k)
 AMBARELLA_APP_CFLAGS	+= -marm -march=armv6k -mtune=arm1136j-s -mlittle-endian -msoft-float -Wa,-mfpu=softvfp
 AMBARELLA_APP_AFLAGS	+= -march=armv6k -mfloat-abi=soft -mfpu=softvfp
 AMBARELLA_APP_LDFLAGS	+= -marm -march=armv6k -mtune=arm1136j-s -mlittle-endian -msoft-float -Wa,-mfpu=softvfp
-else ifeq ($(CONFIG_CPU_ARM926EJS), y)
+else ifeq ($(AMBARELLA_CPU_ARCH), armv5te)
 AMBARELLA_APP_CFLAGS	+= -marm -march=armv5te -mtune=arm9tdmi -msoft-float -Wa,-mfpu=softvfp
 AMBARELLA_APP_AFLAGS	+= -march=armv5te -mfloat-abi=soft -mfpu=softvfp
 AMBARELLA_APP_LDFLAGS	+= -marm -march=armv5te -mtune=arm9tdmi -msoft-float -Wa,-mfpu=softvfp
@@ -241,6 +291,9 @@ AMB_DRIVERS_OUT_DIR	:= $(KERNEL_OUT_DIR)/private/drivers
 EXT_DRIVERS_SRCS_DIR	:= $(AMB_TOPDIR)/kernel/external
 EXT_DRIVERS_OUT_DIR	:= $(KERNEL_OUT_DIR)/external
 
+PLATFORM_DRIVERS_SRCS_DIR	:= $(AMB_TOPDIR)/kernel/private/platform
+PLATFORM_DRIVERS_OUT_DIR	:= $(KERNEL_OUT_DIR)/private/platform
+
 AMBARELLA_DRV_CFLAGS	:= $(AMBARELLA_CFLAGS) \
 				-I$(AMB_TOPDIR)/kernel/private/include \
 				-I$(AMB_TOPDIR)/kernel/private/include/arch_$(AMBARELLA_ARCH) \
diff --git a/core/definition.mk b/core/definition.mk
index 39e636b..2c640c9 100644
--- a/core/definition.mk
+++ b/core/definition.mk
@@ -6,15 +6,34 @@
 ## History:
 ##    2011/12/09 - [Cao Rongrong] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
-ALL_TARGETS :=
+ALL_TARGETS	:=
+ALL_IMAGES	:=
+export ALL_IMAGES
 
 ###########################################################
 ## Retrieve the directory of the current makefile
@@ -62,6 +81,15 @@ endef
 #endef
 
 
+###########################################################
+## Add image into ALL_IMAGES
+###########################################################
+
+define add-image-into-build
+$(eval ALL_IMAGES += $(strip $(1)))
+endef
+
+
 
 ###########################################################
 ## Commands for post-processing the dependency files
@@ -85,10 +113,10 @@ define build-static-library
 		@echo CREATE $@ > $(dir $@)/ar.mac
 		@echo SAVE >> $(dir $@)/ar.mac
 		@echo END >> $(dir $@)/ar.mac
-		@ar -M < $(dir $@)/ar.mac
+		@$(CROSS_COMPILE)ar -M < $(dir $@)/ar.mac
 	)
 
-	$(if $(filter %.o,$^),@ar -c -q $@ $(filter %.o, $^))
+	$(if $(filter %.o,$^),@$(CROSS_COMPILE)ar -c -q $@ $(filter %.o, $^))
 	$(if $(filter %.a, $^),
 		@echo OPEN $@ > $(dir $@)/ar.mac
 		$(foreach LIB, $(filter %.a, $^),
@@ -96,7 +124,7 @@ define build-static-library
 		)
 		@echo SAVE >> $(dir $@)/ar.mac
 		@echo END >> $(dir $@)/ar.mac
-		@ar -M < $(dir $@)/ar.mac
+		@$(CROSS_COMPILE)ar -M < $(dir $@)/ar.mac
 		@rm -rf $(dir $@)/ar.mac
 	)
 endef
diff --git a/core/dependency.mk b/core/dependency.mk
index 0961f23..f17d280 100644
--- a/core/dependency.mk
+++ b/core/dependency.mk
@@ -1,12 +1,29 @@
 ## History:
 ##    2012/06/09 - [Cao Rongrong] Create
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 $(ALL_TARGETS): $(DOT_CONFIG)
diff --git a/core/menuconfig.mk b/core/menuconfig.mk
index 4e9ac10..88cc2d9 100644
--- a/core/menuconfig.mk
+++ b/core/menuconfig.mk
@@ -3,12 +3,29 @@
 ##    2011/12/13 - [Cao Rongrong] Create
 ##    2013/03/26 - [Jian Tang] Modified
 ##
-## Copyright (C) 2012-2016, Ambarella, Inc.
+## Copyright (c) 2016 Ambarella, Inc.
 ##
-## All rights reserved. No Part of this file may be reproduced, stored
-## in a retrieval system, or transmitted, in any form, or by any means,
-## electronic, mechanical, photocopying, recording, or otherwise,
-## without the prior consent of Ambarella, Inc.
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
 ##
 
 $(DOT_CONFIG):
@@ -44,8 +61,14 @@ ifeq ($(shell [ -d $(AMB_TOPDIR)/boards ] && echo y), y)
 	@$(AMB_TOPDIR)/build/bin/create_board_mkcfg $(AMB_TOPDIR)/boards;
 endif
 
+.PHONY: create_private_mkcfg
+create_private_mkcfg: $(AMB_TOPDIR)/build/bin/create_private_mkcfg
+	@$(AMB_TOPDIR)/build/bin/create_private_mkcfg  $(AMB_TOPDIR)  platform
+	@$(AMB_TOPDIR)/build/bin/create_private_mkcfg  $(AMB_TOPDIR)  drivers
+
 .PHONY: sync_build_mkcfg
-sync_build_mkcfg: create_boards $(AMB_TOPDIR)/build/bin/create_root_mkcfg
+sync_build_mkcfg: create_boards  create_private_mkcfg
+sync_build_mkcfg: $(AMB_TOPDIR)/build/bin/create_root_mkcfg
 	@$(AMB_TOPDIR)/build/bin/create_mkcfg $(AMB_TOPDIR)/build/cfg $(AMB_TOPDIR)
 	@$(AMB_TOPDIR)/build/bin/create_root_mkcfg $(AMB_TOPDIR)
 
diff --git a/kconfig/Makefile b/kconfig/Makefile
index 27f8b7c..197e8b0 100644
--- a/kconfig/Makefile
+++ b/kconfig/Makefile
@@ -92,7 +92,7 @@ mconf: $(MCONF_OBJS) zconf.tab.o
 	@$(HOSTCC) $^ -o $@ -lncurses
 
 ncurses:
-	@echo "main() {}" > lxtemp.c
+	@echo "int main() { return 0; }" > lxtemp.c
 	@if $(HOSTCC) lxtemp.c $(LIBS) ; then \
 		rm -f lxtemp.c a.out a.exe; \
 	else \
diff --git a/env/env.mk b/env/env.mk
new file mode 100644
index 0000000..a20e5a9
--- /dev/null
+++ b/env/env.mk
@@ -0,0 +1,41 @@
+##
+## env/check_env.mk
+##
+## History:
+##    2008/02/18 - [Anthony Ginger] Create
+##
+## Copyright (c) 2016 Ambarella, Inc.
+##
+## This file and its contents ("Software") are protected by intellectual
+## property rights including, without limitation, U.S. and/or foreign
+## copyrights. This Software is also the confidential and proprietary
+## information of Ambarella, Inc. and its licensors. You may not use, reproduce,
+## disclose, distribute, modify, or otherwise prepare derivative works of this
+## Software or any portion thereof except pursuant to a signed license agreement
+## or nondisclosure agreement with Ambarella, Inc. or its authorized affiliates.
+## In the absence of such an agreement, you agree to promptly notify and return
+## this Software to Ambarella, Inc.
+##
+## THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
+## INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF NON-INFRINGEMENT,
+## MERCHANTABILITY, AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+## IN NO EVENT SHALL AMBARELLA, INC. OR ITS AFFILIATES BE LIABLE FOR ANY DIRECT,
+## INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+## LOSS OF USE, DATA, OR PROFITS; COMPUTER FAILURE OR MALFUNCTION; OR BUSINESS
+## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+## POSSIBILITY OF SUCH DAMAGE.
+##
+
+.PHONY: check_env
+
+check_env:
+ifndef ARM_ELF_TOOLCHAIN_DIR
+	$(error Can not find arm-elf toolchain, please set ARM_ELF_TOOLCHAIN_DIR)
+endif
+ifndef ARM_LINUX_TOOLCHAIN_DIR
+	$(error Can not find arm-linux toolchain, please set ARM_LINUX_TOOLCHAIN_DIR)
+endif
+
